-- Database: "%DBNAME%" 
--
-- PostgreSQL database schema dump
--

-- Dumped from database version 9.3.25
-- Dumped by pg_dump version 9.3.25

SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET client_min_messages = warning;

--
-- TOC entry 1 (class 3079 OID 11750)
-- Name: plpgsql; Type: EXTENSION; Schema: -; Owner: 
--

CREATE EXTENSION IF NOT EXISTS plpgsql WITH SCHEMA pg_catalog;


--
-- TOC entry 2954 (class 0 OID 0)
-- Dependencies: 1
-- Name: EXTENSION plpgsql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION plpgsql IS 'PL/pgSQL procedural language';


--
-- TOC entry 209 (class 1255 OID 17388)
-- Name: update_cash_cache(); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_cash_cache() RETURNS void
    LANGUAGE plpgsql
    AS $$

DECLARE
  dbsetting integer;
  playerdata cash_cache%ROWTYPE;

BEGIN
  <<getCashPlayersDataToCache>>
  FOR playerdata IN 
    SELECT chps.id_player, chps.id_gametype, chps.id_limit, chs.cnt_players,((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)), (chps.flg_f_has_position), (chps.flg_t_has_position), (chps.flg_r_has_position), (CAST ( ((date_part('year',  timezone('UTC',  chps.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  chps.date_played  + INTERVAL '0 HOURS')))) AS integer )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN ((chps.amt_won * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN (((case when(chps.amt_payout > 0) then (chps.amt_payout - chps.amt_bet_ttl) else  chps.amt_won end) * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum(chps.amt_blind)), (sum(CAST( (chps.val_curr_conv * chps.amt_blind) as numeric) )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN ((chps.amt_expected_won * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum(chps.amt_expected_won)), (sum(CAST( (chps.val_curr_conv * chps.amt_expected_won) as numeric ))), (sum(chs.amt_jackpot_fee)), (sum(CAST( (chps.val_curr_conv * chs.amt_jackpot_fee) as numeric ))), (sum(chps.amt_payout)), (sum(CAST( (chps.val_curr_conv * (chps.amt_payout)) AS numeric ))), (sum(chps.amt_payout_fee)), (sum(CAST( (chps.val_curr_conv * (chps.amt_payout_fee)) AS numeric ))), (sum( (case when( chps.cnt_r_call > 0 AND (chps.amt_r_bet_made + chps.amt_r_raise_made) = 0) then  chps.amt_bet_r else  0  end))), (sum( (case when( chps.cnt_r_call > 0 AND (chps.amt_r_bet_made + chps.amt_r_raise_made) = 0 AND chps.flg_won_hand) then  chps.amt_won + chps.amt_bet_ttl else  0  end))), (sum(chs.amt_rake * ( (CASE WHEN ( (chs.amt_pot - chs.amt_rake - chs.amt_jackpot_fee)) <> 0 THEN (( (chps.amt_won +  chps.amt_bet_ttl)  * 1.0 )/( (chs.amt_pot - chs.amt_rake - chs.amt_jackpot_fee))) ELSE 0 END) ))), (sum(CAST( ((case when(chps.flg_won_hand) then  chps.val_curr_conv * chs.amt_rake * ( (CASE WHEN ( (chs.amt_pot - chs.amt_rake - chs.amt_jackpot_fee)) <> 0 THEN (( (chps.amt_won + chps.amt_bet_ttl)  * 1.0 )/( (chs.amt_pot - chs.amt_rake - chs.amt_jackpot_fee))) ELSE 0 END) ) else  0 end)) as numeric))), (sum(chs.amt_mgr)), (sum(CAST( (chps.val_curr_conv * chs.amt_mgr) AS numeric ))), (sum(chs.amt_rake)), (sum(CAST( (chps.val_curr_conv * chs.amt_rake) as numeric ))), (sum(( (CASE WHEN ( chs.amt_pot) <> 0 THEN ((chps.amt_bet_ttl * 1.0 )/( chs.amt_pot)) ELSE 0 END) ) * chs.amt_rake)), (sum(CAST( ((case when(chps.amt_bet_ttl > 0) then  chps.val_curr_conv * ( (CASE WHEN ( chs.amt_pot) <> 0 THEN ((chps.amt_bet_ttl * 1.0 )/( chs.amt_pot)) ELSE 0 END) ) * chs.amt_rake else  0 end)) AS numeric ))), (sum(chps.amt_straddle)), (sum(CAST( (chps.val_curr_conv * (chps.amt_straddle)) AS numeric ))), (sum(chps.amt_won)), (sum(CAST( (chps.val_curr_conv * chps.amt_won) AS numeric ))), (sum((case when(chps.amt_payout > 0) then  chps.amt_payout - chps.amt_bet_ttl else  chps.amt_won end))), (sum(CAST( (chps.val_curr_conv * ((case when(chps.amt_payout > 0) then  chps.amt_payout - chps.amt_bet_ttl else  chps.amt_won end))) AS numeric ))), (sum((case when(chps.flg_blind_b OR chps.flg_blind_s OR chps.flg_blind_db OR chps.flg_blind_ds) then  1 else  0 end))), (sum((case when(chps.flg_f_3bet_opp AND ((chps.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(C|XC|BC)%') OR (chps.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(chps.flg_f_3bet_opp AND ((chps.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(F|XF|BF)%') OR (chps.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(chps.flg_f_3bet) then  1 else  0 end))), (sum((case when(chps.enum_f_3bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_f_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_f_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_4bet) then  1 else  0 end))), (sum((case when(chps.enum_f_4bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_f_4bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_f_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_4bet_opp) then  1 else  0 end))), (sum( (case when(chps.enum_allin='F' OR ((chps.enum_face_allin='F' OR chps.enum_face_allin='f') AND chps.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(chps.val_equity>0 AND (chps.enum_allin='F' OR ((chps.enum_face_allin='F' OR chps.enum_face_allin='f') AND chps.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(chps.flg_f_bet) then  1 else  0 end))), (sum((case when(chps.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(chps.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(F|XF)')) then  1 else  0 end))), (sum((case when(chps.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(chps.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when(chps.flg_f_bet and NOT(chps.flg_p_face_raise) and chps.cnt_p_raise = 0) then  1 else  0 end))), (sum(chps.cnt_f_call )), (sum((case when(chps.flg_f_cbet) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.enum_f_cbet_action='C') then 1 else 0 end))), (sum((case when( not(chps.flg_f_check) AND chps.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(chps.flg_f_check AND chps.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(not(chps.flg_f_check) AND chps.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_f_check AND chps.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(chps.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(not(chps.flg_f_check) AND chps.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(chps.flg_f_check AND chps.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(chps.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND chps.flg_f_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND chps.flg_f_face_raise and (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND (chps.flg_p_3bet OR chps.flg_p_4bet) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_f_cbet_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet_opp AND (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND NOT (chps.flg_t_saw) AND NOT (chps.flg_f_face_raise)) then  1 else  0 end))), (sum((case when(chps.flg_f_check) then  1 else  0 end))), (sum((case when(chps.flg_f_check_raise) then  1 else  0 end))), (sum((case when(chps.flg_f_check AND (chps.cnt_f_raise > 0 OR chps.cnt_f_call > 0 OR chps.flg_f_fold)) then  1 else  0 end))), (sum((case when(chps.flg_p_face_raise AND NOT (chps.flg_p_3bet OR chps.flg_p_4bet) AND chps.flg_f_bet AND NOT (chps.flg_f_cbet_opp) AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) or (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND NOT (chps.flg_p_3bet OR chps.flg_p_4bet) AND chps.flg_f_bet AND NOT (chps.flg_f_cbet_opp) AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) or (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and (chps.flg_p_3bet or chps.flg_p_4bet) and chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'C') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (chps.flg_p_3bet OR chps.flg_p_4bet) and chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (chps.flg_p_3bet OR chps.flg_p_4bet) and chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(chps.flg_p_face_raise AND NOT(chps.flg_p_3bet OR chps.flg_p_4bet) AND lookup_actions_f.action SIMILAR TO 'B_%' AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b))) then 1 else 0 end))), (sum((case when(chps.flg_p_face_raise AND NOT(chps.flg_p_3bet OR chps.flg_p_4bet) AND lookup_actions_f.action = 'BF' AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b))) then 1 else 0 end))), (sum((case when(chps.flg_p_face_raise AND NOT (chps.flg_p_3bet OR chps.flg_p_4bet) AND (chps.flg_f_open_opp) AND NOT (chps.flg_f_cbet_opp) AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) or (chs.cnt_players = 2 AND chps.flg_blind_b))) then  1 else  0  end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND NOT (chps.flg_p_3bet OR chps.flg_p_4bet) AND (chps.flg_f_open_opp) AND NOT (chps.flg_f_cbet_opp) AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) or (chs.cnt_players = 2 AND chps.flg_blind_b))) then  1 else  0  end))), (sum((case when(chps.flg_f_bet AND chps.flg_f_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_f) < 2) then '-1' else (substring(chs.str_aggressors_f from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'C' AND chps.flg_f_bet AND chps.flg_f_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_f) < 2) then '-1' else (substring(chs.str_aggressors_f from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'F' AND chps.flg_f_bet AND chps.flg_f_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_f) < 2) then '-1' else (substring(chs.str_aggressors_f from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'R' AND chps.flg_f_bet AND chps.flg_f_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_f) < 2) then '-1' else (substring(chs.str_aggressors_f from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND chps.flg_p_face_raise AND chps.flg_f_bet AND char_length(chs.str_aggressors_p) = 2 AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_f_has_position))) then  1 else  0 end))), (sum((case when( chps.flg_p_first_raise and lookup_actions_p.action = 'RC' and chps.flg_f_has_position and chps.flg_f_bet) then  1 else  0 end))), (sum((case when( not(chps.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' AND chps.flg_f_open_opp AND chps.flg_f_check AND chps.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when( not(chps.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and chps.flg_f_open_opp AND chps.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XC') then  1 else  0 end))), (sum((case when( not(chps.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and chps.flg_f_open_opp AND chps.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XF') then  1 else  0 end))), (sum((case when( not(chps.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and chps.flg_f_open_opp AND chps.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XR') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND chps.flg_p_face_raise AND chps.flg_f_bet AND char_length(chs.str_aggressors_p) = 2 AND ((case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int > chps.position OR chps.flg_f_has_position) and lookup_actions_f.action LIKE 'B_%') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND chps.flg_p_face_raise AND chps.flg_f_bet AND char_length(chs.str_aggressors_p) = 2 AND ((case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int > chps.position OR chps.flg_f_has_position) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND chps.flg_p_face_raise AND chps.flg_f_open_opp AND char_length(chs.str_aggressors_p) = 2 AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_f_has_position))) then  1 else  0 end))), (sum((case when( chps.flg_p_first_raise and lookup_actions_p.action = 'RC' and chps.flg_f_has_position and chps.flg_f_open_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_fold) then  1 else  0 end))), (sum((case when(chps.flg_f_open_opp and not(chps.flg_p_face_raise) and chps.cnt_p_raise = 0) then  1 else  0 end))), (sum(chps.cnt_f_raise)), (sum((case when(chps.flg_f_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_f_saw) then  1 else  0 end))), (sum((case when(chps.flg_won_hand AND chps.flg_f_saw) then  1 else  0 end))), (sum((case when(chps.id_hand > 0) then  1 else  0 end))), (sum((case when(chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 AND ((NOT(chps.flg_p_limp) AND lookup_actions_p.action LIKE 'C%') OR lookup_actions_p.action SIMILAR TO '(C|X)C%')) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 AND ((NOT(chps.flg_p_limp) AND lookup_actions_p.action LIKE 'F') OR lookup_actions_p.action SIMILAR TO '(C|X)F')) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet) then  1 else  0 end))), (sum((case when(chps.enum_p_3bet_action='C') then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise and chps.enum_p_3bet_action = 'C') then  1 else  0 end))), (sum((case when(chps.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.enum_p_3bet_action='F' AND chps.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 3 and chps.enum_p_3bet_action='F' AND chps.flg_p_first_raise AND (case when(char_length(chs.str_aggressors_p) < 3) then '-1' else (substring(chs.str_aggressors_p from 3 for 1)) end)::int > chps.position) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 3 and chps.enum_p_3bet_action='F' AND chps.flg_p_first_raise AND (case when(char_length(chs.str_aggressors_p) < 3) then '-1' else (substring(chs.str_aggressors_p from 3 for 1)) end)::int < chps.position) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise and chps.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_def_opp AND chps.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 3 and chps.flg_p_3bet_def_opp AND chps.flg_p_first_raise AND (case when(char_length(chs.str_aggressors_p) < 3) then '-1' else (substring(chs.str_aggressors_p from 3 for 1)) end)::int > chps.position) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 3 and chps.flg_p_3bet_def_opp AND chps.flg_p_first_raise AND (case when(char_length(chs.str_aggressors_p) < 3) then '-1' else (substring(chs.str_aggressors_p from 3 for 1)) end)::int < chps.position) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 2 and chps.flg_p_3bet_opp AND ((chs.cnt_players BETWEEN 4 and 6 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (chs.cnt_players BETWEEN 7 and 8 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (chs.cnt_players BETWEEN 9 and 10 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 2 and chps.flg_p_3bet_opp AND ((chs.cnt_players BETWEEN 3 and 6 and (case when(char_length(chs.str_aggressors_p) < 2) then '' else (substring(chs.str_aggressors_p from 2 for 1)) end) = '2') OR (chs.cnt_players BETWEEN 7 and 8 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (chs.cnt_players BETWEEN 9 and 10 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_r_cbet_action='C') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chps.flg_won_hand and not(chps.flg_f_saw) and not(chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_t_cbet_action='C') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 2 and chps.flg_p_3bet AND ((chs.cnt_players BETWEEN 4 and 6 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (chs.cnt_players BETWEEN 7 and 8 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (chs.cnt_players BETWEEN 9 and 10 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 2 and chps.flg_p_3bet AND ((chs.cnt_players BETWEEN 3 and 6 and (case when(char_length(chs.str_aggressors_p) < 2) then '' else (substring(chs.str_aggressors_p from 2 for 1)) end) = '2') OR (chs.cnt_players BETWEEN 7 and 8 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (chs.cnt_players BETWEEN 9 and 10 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_p_4bet) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise and chps.flg_p_4bet) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet and lookup_actions_p.action LIKE 'R%' and not(chps.flg_p_first_raise) and not(chps.flg_p_3bet)) then  1 else  0 end))), (sum((case when(not(chps.flg_p_limp) and not(chps.flg_p_open_opp) and not(chps.flg_p_first_raise) and chps.amt_p_2bet_facing = 0 and (chps.amt_p_3bet_facing > 0 or chps.amt_p_4bet_facing > 0) and chps.flg_p_4bet_opp ) then  1 else  0 end))), (sum((case when(chps.enum_p_4bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_p_4bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet AND chps.enum_p_4bet_action = 'F') then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet AND chps.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_def_opp AND chps.flg_p_first_raise) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_opp AND chps.flg_p_first_raise) then  1 else  0 end))), (sum((case when( char_length(chs.str_aggressors_p) >= 4 AND (case when(char_length(chs.str_aggressors_p) < 4) then '-1' else (substring(chs.str_aggressors_p from 4 for 1)) end)::int != chps.position AND chps.flg_p_4bet) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 5 AND chps.flg_p_4bet_def_opp AND chps.enum_folded = 'P' AND (chps.flg_p_4bet OR  NOT(((10 + chps.position -  substring(chs.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(chs.str_aggressors_p) < 4) then '-1' else (substring(chs.str_aggressors_p from 4 for 1)) end)::int -  substring(chs.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))  ), (sum((case when(char_length(chs.str_aggressors_p) >= 5 AND chps.flg_p_4bet_def_opp AND (chps.flg_p_4bet OR   NOT(((10 + chps.position -  substring(chs.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(chs.str_aggressors_p) < 4) then '-1' else (substring(chs.str_aggressors_p from 4 for 1)) end)::int -  substring(chs.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_opp and ((not chps.flg_p_3bet_def_opp) OR (chps.enum_p_3bet_action SIMILAR TO '(C|R)' AND chps.flg_p_4bet_def_opp))) then  1 else  0 end))), (sum( (case when(chps.enum_allin='P' OR ((chps.enum_face_allin='P' OR chps.enum_face_allin='p') AND chps.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(chps.val_equity>0 AND (chps.enum_allin='P' OR ((chps.enum_face_allin='P' OR chps.enum_face_allin='p') AND chps.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(chps.position=8 AND chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND chps.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(chps.position=8 AND chps.flg_blind_def_opp AND chps.val_p_raise_aggressor_pos=9 AND chps.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(chps.position=8 AND chps.flg_blind_def_opp AND lookup_actions_p.action='C' AND chps.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(chps.position=8 AND chps.flg_blind_def_opp AND lookup_actions_p.action='F' AND chps.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum(chps.cnt_p_call )), (sum((case when(lookup_actions_p.action LIKE 'C%' and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%' AND chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE 'C%' and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%' AND chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(chps.flg_p_ccall and chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when( (chps.enum_p_3bet_action = 'C' and not(chps.flg_p_first_raise) and chps.amt_p_2bet_facing = 0) OR (chps.amt_p_3bet_facing = 0 and chps.enum_p_4bet_action = 'C' and not(chps.flg_p_3bet or chps.flg_p_4bet))) then  1 else  0 end))), (sum((case when( (chps.flg_p_3bet_def_opp and not(chps.flg_p_first_raise) and chps.amt_p_2bet_facing = 0) or (chps.amt_p_3bet_facing = 0 and chps.flg_p_4bet_def_opp and not(chps.flg_p_3bet or chps.flg_p_4bet))) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 and chps.amt_blind = 0 and not(chps.flg_p_limp)) then  1 else  0 end))), (sum((case when( chps.cnt_p_face_limpers > 0) then  1 else  0 end))), (sum((case when(chps.flg_p_fold) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%' and chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%' and chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(chps.flg_p_limp) then  1 else  0 end))), (sum((case when(chps.flg_p_limp AND lookup_actions_p.action LIKE 'CC%') then  1 else  0 end))), (sum((case when(chps.flg_p_limp AND chps.flg_p_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_p_limp AND lookup_actions_p.action = 'CF') then  1 else  0 end))), (sum((case when(((NOT chps.flg_p_face_raise) OR (chps.flg_p_limp) OR (chps.flg_p_first_raise)) AND NOT (chps.flg_blind_b OR chps.flg_blind_db)) then 1 else 0 end))), (sum((case when( chps.cnt_p_face_limpers > 0 AND NOT (chps.flg_blind_b OR chps.flg_blind_db)) then  1 else  0 end))), (sum((case when(chps.flg_p_limp AND lookup_actions_p.action LIKE 'CR%') then  1 else  0 end))), (sum((case when(chps.flg_p_open_opp) then  1 else  0 end))), (sum((case when( chps.position = 0 and chps.flg_p_open_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_open_opp AND ((chs.cnt_players between 4 and 6 and chps.position between 3 and 5) OR (chs.cnt_players between 7 and 8 and chps.position between 4 and 7) OR (chs.cnt_players between 9 and 10 and chps.position between 5 and 7))) then  1 else  0 end))), (sum(chps.cnt_p_raise )), (sum((case when(chps.enum_p_3bet_action = 'R' AND chps.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise AND chps.flg_p_open_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise AND NOT chps.flg_p_open_opp) then  1 else  0 end))), (sum((case when( chps.flg_p_first_raise and chps.flg_p_open_opp and chps.position = 0) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise AND chps.flg_p_open_opp and ((chs.cnt_players between 4 and 6 and chps.position between 3 and 5) OR (chs.cnt_players between 7 and 8 and chps.position between 4 and 7) OR (chs.cnt_players between 9 and 10 and chps.position between 5 and 7))) then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze) then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_def_opp AND chps.enum_p_squeeze_action='C') then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_def_opp AND chps.enum_p_squeeze_action='F') then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_def_opp AND chps.enum_p_squeeze_action='R') then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_opp) then  1 else  0 end))), (sum((case when(chps.cnt_p_raise > 0) then  1 else  0 end))), (sum((case when( lookup_actions_p.action LIKE '__%' OR (lookup_actions_p.action LIKE '_' AND (chps.amt_before > (cash_limit.amt_bb + chps.amt_ante)) AND (chps.amt_p_raise_facing < (chps.amt_before - (chps.amt_blind + chps.amt_ante))) AND (chps.flg_p_open_opp OR chps.cnt_p_face_limpers > 0 OR chps.flg_p_3bet_opp OR chps.flg_p_4bet_opp) )) then  1 else  0 end))), (sum(chs.cnt_players)), (sum((case when(chps.flg_p_open = false AND chps.flg_p_limp) then  1 else  0 end))), (sum((case when(chps.flg_r_3bet_opp AND ((chps.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(C|XC|BC)%') OR (chps.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(chps.flg_r_3bet_opp AND ((chps.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(F|XF|BF)%') OR (chps.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(chps.flg_r_3bet) then  1 else  0 end))), (sum((case when(chps.enum_r_3bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_r_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_r_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_4bet) then  1 else  0 end))), (sum((case when(chps.enum_r_4bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_r_4bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_r_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_4bet_opp) then  1 else  0 end))), (sum( (case when(chps.enum_allin='R' OR ((chps.enum_face_allin='R' OR chps.enum_face_allin='r') AND chps.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(chps.val_equity>0 AND (chps.enum_allin='R' OR ((chps.enum_face_allin='R' OR chps.enum_face_allin='r') AND chps.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(chps.flg_r_bet) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0) then  1 else  0 end))), (sum(chps.cnt_r_call )), (sum((case when(chps.cnt_r_call > 0 AND chps.flg_showdown) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND (chps.flg_p_3bet OR chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.enum_r_cbet_action='C') then 1 else 0 end))), (sum((case when(chps.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when(chps.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when(chps.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND chps.flg_r_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND chps.flg_r_face_raise and (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND lookup_actions_r.action LIKE 'BF') then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND (chps.flg_p_3bet or chps.flg_p_4bet) and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_r_cbet_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet_opp AND (chps.flg_p_3bet OR chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND NOT(chps.flg_r_face_raise) AND NOT(chps.flg_showdown)) then  1 else  0 end))), (sum((case when(chps.flg_r_check) then  1 else  0 end))), (sum((case when(chps.flg_r_check_raise) then  1 else  0 end))), (sum((case when(chps.flg_r_check AND (chps.cnt_r_raise > 0 OR chps.cnt_r_call > 0 OR chps.flg_r_fold)) then  1 else  0 end))), (sum((case when(chps.flg_r_donk) then  1 else  0 end))), (sum((case when(chps.flg_r_donk and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.enum_r_donk_action='C') then  1 else  0 end))), (sum((case when(chps.enum_r_donk_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp or chps.flg_p_4bet_def_opp) and chps.enum_r_donk_action = 'F') then  1 else  0 end))), (sum((case when(chps.enum_r_donk_action='R') then  1 else  0 end))), (sum((case when(chps.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) and chps.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_donk and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_r_donk and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_r_donk_opp) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_r_donk_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND chps.flg_r_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_r) < 2) then '-1' else (substring(chs.str_aggressors_r from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'C' AND chps.flg_r_bet AND chps.flg_r_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_r) < 2) then '-1' else (substring(chs.str_aggressors_r from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'F' AND chps.flg_r_bet AND chps.flg_r_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_r) < 2) then '-1' else (substring(chs.str_aggressors_r from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'R' AND chps.flg_r_bet AND chps.flg_r_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_r) < 2) then '-1' else (substring(chs.str_aggressors_r from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when(chps.flg_r_float) then  1 else  0 end))), (sum((case when(chps.flg_r_float and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.enum_r_float_action='C') then 1 else 0 end))), (sum((case when(chps.enum_r_float_action='F') then 1 else 0 end))), (sum((case when(chps.enum_r_float_action='R') then 1 else 0 end))), (sum((case when(chps.flg_r_float_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_float and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_r_float and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_r_float_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_float_opp and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.flg_r_fold) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND chps.enum_f_cbet_action = 'C' AND ((chs.cnt_players >= 3 and chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND chps.flg_f_check AND chps.enum_f_cbet_action = 'C' AND NOT (chps.flg_f_face_raise) AND ((chs.cnt_players >= 3 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b)) AND (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 and chps.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(chps.flg_r_open_opp) and lookup_actions_r.action LIKE 'C%') then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 and chps.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(chps.flg_r_open_opp) and lookup_actions_r.action = 'F') then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 and chps.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(chps.flg_r_open_opp) and lookup_actions_r.action LIKE 'R%') then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 and chps.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(chps.flg_r_open_opp)) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND chps.enum_f_cbet_action = 'C' AND NOT (chps.flg_f_face_raise) AND lookup_actions_r.action LIKE 'B_%' AND ((chs.cnt_players >= 3 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND chps.enum_f_cbet_action = 'C' AND NOT (chps.flg_f_face_raise) and lookup_actions_r.action = 'BF' AND ((chs.cnt_players >= 3 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND chps.enum_f_cbet_action = 'C' AND ((chs.cnt_players >= 3 and chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND chps.flg_f_check AND chps.enum_f_cbet_action = 'C' AND NOT (chps.flg_f_face_raise) AND ((chs.cnt_players >= 3 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b)) AND (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(chps.cnt_r_raise)), (sum((case when(chps.cnt_r_raise > 0 AND chps.flg_showdown) then  1 else  0 end))), (sum((case when(chps.cnt_r_raise > 0 AND chps.flg_showdown AND chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.flg_r_saw) then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND chps.flg_p_3bet_def_opp AND chps.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND chps.flg_p_3bet_def_opp ) then  1 else  0 end))), (sum((case when(chps.flg_steal_att) then  1 else  0 end))), (sum((case when(chps.flg_steal_att and chps.position <= 1) then  1 else  0 end))), (sum((case when(chps.flg_p_open_opp and chps.flg_p_first_raise and chps.position = 9) then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND chps.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp and chs.str_aggressors_p NOT LIKE '89%' AND chps.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%' and chs.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action = 'F') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action = 'F' AND chs.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND chs.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp and chs.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_steal_opp) then  1 else  0 end))), (sum((case when(chps.flg_steal_opp and chps.position <= 1) then  1 else  0 end))), (sum((case when(chps.flg_p_open_opp and chps.position = 9) then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND chps.flg_p_3bet_def_opp AND chps.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND chps.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND NOT (chps.flg_f_saw) AND NOT (chps.flg_p_face_raise)) then  1 else  0 end))), (sum((case when(chps.flg_t_3bet_opp AND ((chps.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(C|XC|BC)%') OR (chps.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(chps.flg_t_3bet_opp AND ((chps.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(F|XF|BF)%') OR (chps.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(chps.flg_t_3bet) then  1 else  0 end))), (sum((case when(chps.enum_t_3bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_t_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_t_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_4bet) then  1 else  0 end))), (sum((case when(chps.enum_t_4bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_t_4bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_t_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_4bet_opp) then  1 else  0 end))), (sum( (case when(chps.enum_allin='T' OR ((chps.enum_face_allin='T' OR chps.enum_face_allin='t') AND chps.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(chps.val_equity>0 AND (chps.enum_allin='T' OR ((chps.enum_face_allin='T' OR chps.enum_face_allin='t') AND chps.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(chps.flg_t_bet) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0) then  1 else  0 end))), (sum(chps.cnt_t_call )), (sum((case when(chps.flg_t_cbet) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.enum_t_cbet_action='C') then 1 else 0 end))), (sum((case when(chps.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when(chps.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when(chps.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND chps.flg_t_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND chps.flg_t_face_raise and (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND lookup_actions_t.action LIKE 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND (chps.flg_p_3bet or chps.flg_p_4bet) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_cbet_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet_opp AND (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND NOT (chps.flg_r_saw) AND NOT (chps.flg_t_face_raise)) then  1 else  0 end))), (sum((case when(chps.flg_t_check) then  1 else  0 end))), (sum((case when(chps.flg_t_check_raise) then  1 else  0 end))), (sum((case when(chps.flg_t_check AND (chps.cnt_t_raise > 0 OR chps.cnt_t_call > 0 OR chps.flg_t_fold)) then  1 else  0 end))), (sum((case when(chps.flg_t_donk) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) and chps.flg_t_donk) then  1 else  0 end))), (sum((case when(chps.enum_t_donk_action='C') then  1 else  0 end))), (sum((case when(chps.enum_t_donk_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp or chps.flg_p_4bet_def_opp) and chps.enum_t_donk_action = 'F') then  1 else  0 end))), (sum((case when(chps.enum_t_donk_action='R') then  1 else  0 end))), (sum((case when(chps.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) and chps.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_donk and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_t_donk and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_donk_opp) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_t_donk_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND chps.flg_t_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_t) < 2) then '-1' else (substring(chs.str_aggressors_t from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'C' AND chps.flg_t_bet AND chps.flg_t_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_t) < 2) then '-1' else (substring(chs.str_aggressors_t from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'F' AND chps.flg_t_bet AND chps.flg_t_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_t) < 2) then '-1' else (substring(chs.str_aggressors_t from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'R' AND chps.flg_t_bet AND chps.flg_t_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_t) < 2) then '-1' else (substring(chs.str_aggressors_t from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when(chps.flg_t_float) then  1 else  0 end))), (sum((case when(chps.flg_t_float and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.enum_t_float_action='C') then  1 else  0 end))), (sum((case when(chps.enum_t_float_action='F') then  1 else  0 end))), (sum((case when(chps.enum_t_float_action='R') then  1 else  0 end))), (sum((case when(chps.flg_t_float_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_float and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_t_float and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_float_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_float_opp and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.flg_t_fold) then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chs.cnt_players >= 3 and chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chps.val_p_raise_aggressor_pos < chps.position AND chs.cnt_players >= 3) OR (chs.cnt_players = 2 and chps.flg_blind_b)) and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 and chps.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(chps.flg_t_open_opp) and lookup_actions_t.action LIKE 'C%') then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 and chps.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(chps.flg_t_open_opp) and lookup_actions_t.action = 'F') then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 and chps.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(chps.flg_t_open_opp) and lookup_actions_t.action LIKE 'R%') then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 and chps.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(chps.flg_t_open_opp)) then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chps.val_p_raise_aggressor_pos < chps.position AND chs.cnt_players >= 3) OR (chs.cnt_players = 2 and chps.flg_blind_b)) and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chps.val_p_raise_aggressor_pos < chps.position AND chs.cnt_players >= 3) OR (chs.cnt_players = 2 and chps.flg_blind_b)) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chs.cnt_players >= 3 and chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chps.val_p_raise_aggressor_pos < chps.position AND chs.cnt_players >= 3) OR (chs.cnt_players = 2 and chps.flg_blind_b)) and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(chps.cnt_t_raise)), (sum((case when(chps.cnt_t_raise > 0 AND chps.flg_showdown) then  1 else  0 end))), (sum((case when(chps.cnt_t_raise > 0 AND chps.flg_showdown AND chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.flg_t_saw) then  1 else  0 end))), (sum((case when(chps.flg_vpip) then  1 else  0 end))), (sum((case when(chps.flg_blind_b = false AND chps.flg_blind_s AND chps.flg_vpip) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = '') then  1 else  0 end))), (sum((case when(chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.flg_showdown) then  1 else  0 end))), (sum((case when(chps.flg_showdown AND chps.enum_allin<>'N') then  1 else  0 end))), (sum((case when(chps.flg_showdown and chps.amt_bet_ttl > 5 * cash_limit.amt_bb) then  1 else  0 end))), (sum((case when(chps.flg_showdown AND chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.flg_showdown and chps.flg_won_hand and chps.amt_bet_ttl > 5 * cash_limit.amt_bb) then  1 else  0 end))), (sum((case when(chps.cnt_r_call > 0 AND chps.flg_won_hand AND chps.flg_showdown) then  1 else  0 end))), (cash_limit.limit_currency), (sum((case when( chps.enum_allin='P' OR chps.enum_face_allin='P' OR chps.enum_face_allin='p' OR  chps.enum_allin='F' OR chps.enum_face_allin='F' OR chps.enum_face_allin='f' OR  chps.enum_allin='T' OR chps.enum_face_allin='T' OR chps.enum_face_allin='t' OR  chps.enum_allin='R' OR chps.enum_face_allin='R' OR chps.enum_face_allin='r' ) then    ( (case when(chps.enum_allin='P' OR ((chps.enum_face_allin='P' OR chps.enum_face_allin='p') AND  chps.enum_face_allin_action<>'F')) then  chps.val_equity else  0 end) ) +  ( (case when(chps.enum_allin='F' OR ((chps.enum_face_allin='F' OR chps.enum_face_allin='f') AND chps.enum_face_allin_action<>'F')) then  chps.val_equity else  0 end) ) +  ( (case when(chps.enum_allin='T' OR ((chps.enum_face_allin='T' OR chps.enum_face_allin='t') AND  chps.enum_face_allin_action<>'F')) then  chps.val_equity else  0 end) ) +  ( (case when(chps.enum_allin='R' OR ((chps.enum_face_allin='R' OR chps.enum_face_allin='r') AND chps.enum_face_allin_action<>'F')) then  chps.val_equity else  0 end) )   else  0 end))), (sum( (case when(chps.val_equity>0 AND (chps.enum_allin='F' OR ((chps.enum_face_allin='F' OR chps.enum_face_allin='f') AND chps.enum_face_allin_action<>'F'))) then  chps.val_equity else  0 end) )), (sum( (case when(chps.val_equity>0 AND (chps.enum_allin='P' OR ((chps.enum_face_allin='P' OR chps.enum_face_allin='p') AND chps.enum_face_allin_action<>'F'))) then  chps.val_equity else  0 end) )), (sum( (case when(chps.val_equity>0 AND (chps.enum_allin='R' OR ((chps.enum_face_allin='R' OR chps.enum_face_allin='r') AND chps.enum_face_allin_action<>'F'))) then  chps.val_equity else  0 end) )), (sum( (case when(chps.val_equity>0 AND (chps.enum_allin='T' OR ((chps.enum_face_allin='T' OR chps.enum_face_allin='t') AND chps.enum_face_allin_action<>'F'))) then  chps.val_equity else  0 end) )) FROM	 (SELECT * FROM cash_hand_player_statistics WHERE id_hand > (SELECT CASE WHEN setting_value IS NULL THEN 0 ELSE setting_value::integer END FROM settings WHERE setting_name = 'cache_update:cash')) as chps , (SELECT * FROM cash_hand_summary WHERE id_hand > (SELECT CASE WHEN setting_value IS NULL THEN 0 ELSE setting_value::integer END FROM settings WHERE setting_name = 'cache_update:cash')) as chs, cash_limit, lookup_actions lookup_actions_f, lookup_actions lookup_actions_p, lookup_actions lookup_actions_r, lookup_actions lookup_actions_t, lookup_positions WHERE (chs.id_hand = chps.id_hand AND chs.id_limit = chps.id_limit)  AND (cash_limit.id_limit = chps.id_limit)  AND (lookup_actions_f.id_action=chps.id_action_f)  AND (lookup_actions_p.id_action=chps.id_action_p)  AND (lookup_actions_r.id_action=chps.id_action_r)  AND (lookup_actions_t.id_action=chps.id_action_t)  AND (lookup_positions."position"=chps."position" AND lookup_positions.cnt_players=chps.cnt_players_lookup_position)  AND (cash_limit.id_limit = chs.id_limit)   GROUP BY chps.id_player, chps.id_gametype, chps.id_limit, chs.cnt_players,  ((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)),  (chps.flg_f_has_position),  (chps.flg_t_has_position),  (chps.flg_r_has_position),  (CAST ( ((date_part('year',  timezone('UTC',  chps.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  chps.date_played  + INTERVAL '0 HOURS')))) AS integer )),  (cash_limit.limit_currency) 

  LOOP  
    <<updateCashPlayersDataInCache>>
    BEGIN
      UPDATE cash_cache SET amt_bb_won=amt_bb_won+playerdata.amt_bb_won::numeric(14,2),amt_bb_won_inc_payout=amt_bb_won_inc_payout+playerdata.amt_bb_won_inc_payout::numeric(14,2),amt_blind=amt_blind+playerdata.amt_blind::numeric(14,2),amt_blind_curr_conv=amt_blind_curr_conv+playerdata.amt_blind_curr_conv::numeric(14,2),amt_expected_bb_won=amt_expected_bb_won+playerdata.amt_expected_bb_won::numeric(14,2),amt_expected_won=amt_expected_won+playerdata.amt_expected_won::numeric(14,2),amt_expected_won_curr_conv=amt_expected_won_curr_conv+playerdata.amt_expected_won_curr_conv::numeric(14,2),amt_jackpot_taken=amt_jackpot_taken+playerdata.amt_jackpot_taken::numeric(14,2),amt_jackpot_taken_curr_conv=amt_jackpot_taken_curr_conv+playerdata.amt_jackpot_taken_curr_conv::numeric(14,2),amt_payout=amt_payout+playerdata.amt_payout::numeric(14,2),amt_payout_curr_conv=amt_payout_curr_conv+playerdata.amt_payout_curr_conv::numeric(14,2),amt_payout_fee=amt_payout_fee+playerdata.amt_payout_fee::numeric(14,2),amt_payout_fee_curr_conv=amt_payout_fee_curr_conv+playerdata.amt_payout_fee_curr_conv::numeric(14,2),amt_r_call=amt_r_call+playerdata.amt_r_call::numeric(14,2),amt_r_call_won=amt_r_call_won+playerdata.amt_r_call_won::numeric(14,2),amt_rake_attributed=amt_rake_attributed+playerdata.amt_rake_attributed::numeric(14,2),amt_rake_attributed_curr_conv=amt_rake_attributed_curr_conv+playerdata.amt_rake_attributed_curr_conv::numeric(14,2),amt_rake_share=amt_rake_share+playerdata.amt_rake_share::numeric(14,2),amt_rake_share_curr_conv=amt_rake_share_curr_conv+playerdata.amt_rake_share_curr_conv::numeric(14,2),amt_rake_taken=amt_rake_taken+playerdata.amt_rake_taken::numeric(14,2),amt_rake_taken_curr_conv=amt_rake_taken_curr_conv+playerdata.amt_rake_taken_curr_conv::numeric(14,2),amt_rake_weighted_contributed=amt_rake_weighted_contributed+playerdata.amt_rake_weighted_contributed::numeric(14,2),amt_rake_weighted_contributed_curr_conv=amt_rake_weighted_contributed_curr_conv+playerdata.amt_rake_weighted_contributed_curr_conv::numeric(14,2),amt_straddle=amt_straddle+playerdata.amt_straddle::numeric(14,2),amt_straddle_curr_conv=amt_straddle_curr_conv+playerdata.amt_straddle_curr_conv::numeric(14,2),amt_won=amt_won+playerdata.amt_won::numeric(14,2),amt_won_curr_conv=amt_won_curr_conv+playerdata.amt_won_curr_conv::numeric(14,2),amt_won_inc_payout=amt_won_inc_payout+playerdata.amt_won_inc_payout::numeric(14,2),amt_won_inc_payout_curr_conv=amt_won_inc_payout_curr_conv+playerdata.amt_won_inc_payout_curr_conv::numeric(14,2),cnt_blind=cnt_blind+playerdata.cnt_blind::integer,cnt_f_2bet_def_action_call=cnt_f_2bet_def_action_call+playerdata.cnt_f_2bet_def_action_call::integer,cnt_f_2bet_def_action_fold=cnt_f_2bet_def_action_fold+playerdata.cnt_f_2bet_def_action_fold::integer,cnt_f_3bet=cnt_f_3bet+playerdata.cnt_f_3bet::integer,cnt_f_3bet_def_action_call=cnt_f_3bet_def_action_call+playerdata.cnt_f_3bet_def_action_call::integer,cnt_f_3bet_def_action_fold=cnt_f_3bet_def_action_fold+playerdata.cnt_f_3bet_def_action_fold::integer,cnt_f_3bet_def_opp=cnt_f_3bet_def_opp+playerdata.cnt_f_3bet_def_opp::integer,cnt_f_3bet_opp=cnt_f_3bet_opp+playerdata.cnt_f_3bet_opp::integer,cnt_f_4bet=cnt_f_4bet+playerdata.cnt_f_4bet::integer,cnt_f_4bet_def_action_call=cnt_f_4bet_def_action_call+playerdata.cnt_f_4bet_def_action_call::integer,cnt_f_4bet_def_action_fold=cnt_f_4bet_def_action_fold+playerdata.cnt_f_4bet_def_action_fold::integer,cnt_f_4bet_def_opp=cnt_f_4bet_def_opp+playerdata.cnt_f_4bet_def_opp::integer,cnt_f_4bet_opp=cnt_f_4bet_opp+playerdata.cnt_f_4bet_opp::integer,cnt_f_allin=cnt_f_allin+playerdata.cnt_f_allin::integer,cnt_f_allin_valid=cnt_f_allin_valid+playerdata.cnt_f_allin_valid::integer,cnt_f_bet=cnt_f_bet+playerdata.cnt_f_bet::integer,cnt_f_bet_def_action_call=cnt_f_bet_def_action_call+playerdata.cnt_f_bet_def_action_call::integer,cnt_f_bet_def_action_fold=cnt_f_bet_def_action_fold+playerdata.cnt_f_bet_def_action_fold::integer,cnt_f_bet_def_action_raise=cnt_f_bet_def_action_raise+playerdata.cnt_f_bet_def_action_raise::integer,cnt_f_bet_def_opp=cnt_f_bet_def_opp+playerdata.cnt_f_bet_def_opp::integer,cnt_f_bet_limp_pot=cnt_f_bet_limp_pot+playerdata.cnt_f_bet_limp_pot::integer,cnt_f_call=cnt_f_call+playerdata.cnt_f_call::integer,cnt_f_cbet=cnt_f_cbet+playerdata.cnt_f_cbet::integer,cnt_f_cbet_3bet_pot=cnt_f_cbet_3bet_pot+playerdata.cnt_f_cbet_3bet_pot::integer,cnt_f_cbet_def_action_call=cnt_f_cbet_def_action_call+playerdata.cnt_f_cbet_def_action_call::integer,cnt_f_cbet_def_action_call_in_pos=cnt_f_cbet_def_action_call_in_pos+playerdata.cnt_f_cbet_def_action_call_in_pos::integer,cnt_f_cbet_def_action_call_out_of_pos=cnt_f_cbet_def_action_call_out_of_pos+playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,cnt_f_cbet_def_action_fold=cnt_f_cbet_def_action_fold+playerdata.cnt_f_cbet_def_action_fold::integer,cnt_f_cbet_def_action_fold_in_pos=cnt_f_cbet_def_action_fold_in_pos+playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,cnt_f_cbet_def_action_fold_out_of_pos=cnt_f_cbet_def_action_fold_out_of_pos+playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,cnt_f_cbet_def_action_raise=cnt_f_cbet_def_action_raise+playerdata.cnt_f_cbet_def_action_raise::integer,cnt_f_cbet_def_action_raise_in_pos=cnt_f_cbet_def_action_raise_in_pos+playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,cnt_f_cbet_def_action_raise_out_of_pos=cnt_f_cbet_def_action_raise_out_of_pos+playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,cnt_f_cbet_def_opp=cnt_f_cbet_def_opp+playerdata.cnt_f_cbet_def_opp::integer,cnt_f_cbet_face_raise=cnt_f_cbet_face_raise+playerdata.cnt_f_cbet_face_raise::integer,cnt_f_cbet_face_raise_3bet_pot=cnt_f_cbet_face_raise_3bet_pot+playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,cnt_f_cbet_fold_to_raise=cnt_f_cbet_fold_to_raise+playerdata.cnt_f_cbet_fold_to_raise::integer,cnt_f_cbet_fold_to_raise_3bet_pot=cnt_f_cbet_fold_to_raise_3bet_pot+playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,cnt_f_cbet_opp=cnt_f_cbet_opp+playerdata.cnt_f_cbet_opp::integer,cnt_f_cbet_opp_3bet_pot=cnt_f_cbet_opp_3bet_pot+playerdata.cnt_f_cbet_opp_3bet_pot::integer,cnt_f_cbet_success=cnt_f_cbet_success+playerdata.cnt_f_cbet_success::integer,cnt_f_check=cnt_f_check+playerdata.cnt_f_check::integer,cnt_f_check_raise=cnt_f_check_raise+playerdata.cnt_f_check_raise::integer,cnt_f_check_raise_opp=cnt_f_check_raise_opp+playerdata.cnt_f_check_raise_opp::integer,cnt_f_donk=cnt_f_donk+playerdata.cnt_f_donk::integer,cnt_f_donk_3bet_pot=cnt_f_donk_3bet_pot+playerdata.cnt_f_donk_3bet_pot::integer,cnt_f_donk_def_opp=cnt_f_donk_def_opp+playerdata.cnt_f_donk_def_opp::integer,cnt_f_donk_def_opp_3bet_pot=cnt_f_donk_def_opp_3bet_pot+playerdata.cnt_f_donk_def_opp_3bet_pot::integer,cnt_f_donk_def_opp_action_call=cnt_f_donk_def_opp_action_call+playerdata.cnt_f_donk_def_opp_action_call::integer,cnt_f_donk_def_opp_action_fold=cnt_f_donk_def_opp_action_fold+playerdata.cnt_f_donk_def_opp_action_fold::integer,cnt_f_donk_def_opp_action_fold_3bet_pot=cnt_f_donk_def_opp_action_fold_3bet_pot+playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,cnt_f_donk_def_opp_action_raise=cnt_f_donk_def_opp_action_raise+playerdata.cnt_f_donk_def_opp_action_raise::integer,cnt_f_donk_def_opp_action_raise_3bet_pot=cnt_f_donk_def_opp_action_raise_3bet_pot+playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,cnt_f_donk_face_raise=cnt_f_donk_face_raise+playerdata.cnt_f_donk_face_raise::integer,cnt_f_donk_fold=cnt_f_donk_fold+playerdata.cnt_f_donk_fold::integer,cnt_f_donk_opp=cnt_f_donk_opp+playerdata.cnt_f_donk_opp::integer,cnt_f_donk_opp_3bet_pot=cnt_f_donk_opp_3bet_pot+playerdata.cnt_f_donk_opp_3bet_pot::integer,cnt_f_face_xr=cnt_f_face_xr+playerdata.cnt_f_face_xr::integer,cnt_f_face_xr_call=cnt_f_face_xr_call+playerdata.cnt_f_face_xr_call::integer,cnt_f_face_xr_fold=cnt_f_face_xr_fold+playerdata.cnt_f_face_xr_fold::integer,cnt_f_face_xr_raise=cnt_f_face_xr_raise+playerdata.cnt_f_face_xr_raise::integer,cnt_f_float=cnt_f_float+playerdata.cnt_f_float::integer,cnt_f_float_3bet_pot=cnt_f_float_3bet_pot+playerdata.cnt_f_float_3bet_pot::integer,cnt_f_float_def_opp=cnt_f_float_def_opp+playerdata.cnt_f_float_def_opp::integer,cnt_f_float_def_opp_action_call=cnt_f_float_def_opp_action_call+playerdata.cnt_f_float_def_opp_action_call::integer,cnt_f_float_def_opp_action_fold=cnt_f_float_def_opp_action_fold+playerdata.cnt_f_float_def_opp_action_fold::integer,cnt_f_float_def_opp_action_raise=cnt_f_float_def_opp_action_raise+playerdata.cnt_f_float_def_opp_action_raise::integer,cnt_f_float_face_raise=cnt_f_float_face_raise+playerdata.cnt_f_float_face_raise::integer,cnt_f_float_fold=cnt_f_float_fold+playerdata.cnt_f_float_fold::integer,cnt_f_float_opp=cnt_f_float_opp+playerdata.cnt_f_float_opp::integer,cnt_f_float_opp_3bet_pot=cnt_f_float_opp_3bet_pot+playerdata.cnt_f_float_opp_3bet_pot::integer,cnt_f_fold=cnt_f_fold+playerdata.cnt_f_fold::integer,cnt_f_open_opp_limp_pot=cnt_f_open_opp_limp_pot+playerdata.cnt_f_open_opp_limp_pot::integer,cnt_f_raise=cnt_f_raise+playerdata.cnt_f_raise::integer,cnt_f_raise_def_opp=cnt_f_raise_def_opp+playerdata.cnt_f_raise_def_opp::integer,cnt_f_saw=cnt_f_saw+playerdata.cnt_f_saw::integer,cnt_f_saw_won=cnt_f_saw_won+playerdata.cnt_f_saw_won::integer,cnt_hands=cnt_hands+playerdata.cnt_hands::integer,cnt_hands_won=cnt_hands_won+playerdata.cnt_hands_won::integer,cnt_p_2bet_def_action_call=cnt_p_2bet_def_action_call+playerdata.cnt_p_2bet_def_action_call::integer,cnt_p_2bet_def_action_fold=cnt_p_2bet_def_action_fold+playerdata.cnt_p_2bet_def_action_fold::integer,cnt_p_2bet_def_opp=cnt_p_2bet_def_opp+playerdata.cnt_p_2bet_def_opp::integer,cnt_p_2bet_def_opp_vs_btn_open=cnt_p_2bet_def_opp_vs_btn_open+playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,cnt_p_2bet_def_opp_vs_co_open=cnt_p_2bet_def_opp_vs_co_open+playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,cnt_p_3bet=cnt_p_3bet+playerdata.cnt_p_3bet::integer,cnt_p_3bet_def_action_call=cnt_p_3bet_def_action_call+playerdata.cnt_p_3bet_def_action_call::integer,cnt_p_3bet_def_action_call_after_2b=cnt_p_3bet_def_action_call_after_2b+playerdata.cnt_p_3bet_def_action_call_after_2b::integer,cnt_p_3bet_def_action_fold=cnt_p_3bet_def_action_fold+playerdata.cnt_p_3bet_def_action_fold::integer,cnt_p_3bet_def_action_fold_when_open_raised=cnt_p_3bet_def_action_fold_when_open_raised+playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,cnt_p_3bet_def_action_fold_when_open_raised_ip=cnt_p_3bet_def_action_fold_when_open_raised_ip+playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,cnt_p_3bet_def_action_fold_when_open_raised_oop=cnt_p_3bet_def_action_fold_when_open_raised_oop+playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,cnt_p_3bet_def_opp=cnt_p_3bet_def_opp+playerdata.cnt_p_3bet_def_opp::integer,cnt_p_3bet_def_opp_after_2b=cnt_p_3bet_def_opp_after_2b+playerdata.cnt_p_3bet_def_opp_after_2b::integer,cnt_p_3bet_def_opp_when_open_raised=cnt_p_3bet_def_opp_when_open_raised+playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,cnt_p_3bet_def_opp_when_open_raised_ip=cnt_p_3bet_def_opp_when_open_raised_ip+playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,cnt_p_3bet_def_opp_when_open_raised_oop=cnt_p_3bet_def_opp_when_open_raised_oop+playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,cnt_p_3bet_f_cbet_def_action_call=cnt_p_3bet_f_cbet_def_action_call+playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,cnt_p_3bet_f_cbet_def_action_fold=cnt_p_3bet_f_cbet_def_action_fold+playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,cnt_p_3bet_f_cbet_def_action_raise=cnt_p_3bet_f_cbet_def_action_raise+playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,cnt_p_3bet_f_cbet_def_opp=cnt_p_3bet_f_cbet_def_opp+playerdata.cnt_p_3bet_f_cbet_def_opp::integer,cnt_p_3bet_opp=cnt_p_3bet_opp+playerdata.cnt_p_3bet_opp::integer,cnt_p_3bet_opp_vs_bb_2bet=cnt_p_3bet_opp_vs_bb_2bet+playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,cnt_p_3bet_opp_vs_btn_2bet=cnt_p_3bet_opp_vs_btn_2bet+playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,cnt_p_3bet_opp_vs_btn_open=cnt_p_3bet_opp_vs_btn_open+playerdata.cnt_p_3bet_opp_vs_btn_open::integer,cnt_p_3bet_opp_vs_co_2bet=cnt_p_3bet_opp_vs_co_2bet+playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,cnt_p_3bet_opp_vs_co_open=cnt_p_3bet_opp_vs_co_open+playerdata.cnt_p_3bet_opp_vs_co_open::integer,cnt_p_3bet_opp_vs_ep_2bet=cnt_p_3bet_opp_vs_ep_2bet+playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,cnt_p_3bet_opp_vs_mp_2bet=cnt_p_3bet_opp_vs_mp_2bet+playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,cnt_p_3bet_opp_vs_sb_2bet=cnt_p_3bet_opp_vs_sb_2bet+playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,cnt_p_3bet_r_cbet_def_action_call=cnt_p_3bet_r_cbet_def_action_call+playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,cnt_p_3bet_r_cbet_def_action_fold=cnt_p_3bet_r_cbet_def_action_fold+playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,cnt_p_3bet_r_cbet_def_action_raise=cnt_p_3bet_r_cbet_def_action_raise+playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,cnt_p_3bet_r_cbet_def_opp=cnt_p_3bet_r_cbet_def_opp+playerdata.cnt_p_3bet_r_cbet_def_opp::integer,cnt_p_3bet_success=cnt_p_3bet_success+playerdata.cnt_p_3bet_success::integer,cnt_p_3bet_t_cbet_def_action_call=cnt_p_3bet_t_cbet_def_action_call+playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,cnt_p_3bet_t_cbet_def_action_fold=cnt_p_3bet_t_cbet_def_action_fold+playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,cnt_p_3bet_t_cbet_def_action_raise=cnt_p_3bet_t_cbet_def_action_raise+playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,cnt_p_3bet_t_cbet_def_opp=cnt_p_3bet_t_cbet_def_opp+playerdata.cnt_p_3bet_t_cbet_def_opp::integer,cnt_p_3bet_vs_bb_2bet=cnt_p_3bet_vs_bb_2bet+playerdata.cnt_p_3bet_vs_bb_2bet::integer,cnt_p_3bet_vs_btn_2bet=cnt_p_3bet_vs_btn_2bet+playerdata.cnt_p_3bet_vs_btn_2bet::integer,cnt_p_3bet_vs_btn_open=cnt_p_3bet_vs_btn_open+playerdata.cnt_p_3bet_vs_btn_open::integer,cnt_p_3bet_vs_co_2bet=cnt_p_3bet_vs_co_2bet+playerdata.cnt_p_3bet_vs_co_2bet::integer,cnt_p_3bet_vs_co_open=cnt_p_3bet_vs_co_open+playerdata.cnt_p_3bet_vs_co_open::integer,cnt_p_3bet_vs_ep_2bet=cnt_p_3bet_vs_ep_2bet+playerdata.cnt_p_3bet_vs_ep_2bet::integer,cnt_p_3bet_vs_mp_2bet=cnt_p_3bet_vs_mp_2bet+playerdata.cnt_p_3bet_vs_mp_2bet::integer,cnt_p_3bet_vs_sb_2bet=cnt_p_3bet_vs_sb_2bet+playerdata.cnt_p_3bet_vs_sb_2bet::integer,cnt_p_4bet=cnt_p_4bet+playerdata.cnt_p_4bet::integer,cnt_p_4bet_after_raising=cnt_p_4bet_after_raising+playerdata.cnt_p_4bet_after_raising::integer,cnt_p_4bet_cold=cnt_p_4bet_cold+playerdata.cnt_p_4bet_cold::integer,cnt_p_4bet_cold_opp=cnt_p_4bet_cold_opp+playerdata.cnt_p_4bet_cold_opp::integer,cnt_p_4bet_def_action_call=cnt_p_4bet_def_action_call+playerdata.cnt_p_4bet_def_action_call::integer,cnt_p_4bet_def_action_fold=cnt_p_4bet_def_action_fold+playerdata.cnt_p_4bet_def_action_fold::integer,cnt_p_4bet_def_action_fold_after_3b=cnt_p_4bet_def_action_fold_after_3b+playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,cnt_p_4bet_def_opp=cnt_p_4bet_def_opp+playerdata.cnt_p_4bet_def_opp::integer,cnt_p_4bet_def_opp_after_3b=cnt_p_4bet_def_opp_after_3b+playerdata.cnt_p_4bet_def_opp_after_3b::integer,cnt_p_4bet_def_opp_when_open_raised=cnt_p_4bet_def_opp_when_open_raised+playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,cnt_p_4bet_opp=cnt_p_4bet_opp+playerdata.cnt_p_4bet_opp::integer,cnt_p_4bet_opp_when_open_raised=cnt_p_4bet_opp_when_open_raised+playerdata.cnt_p_4bet_opp_when_open_raised::integer,cnt_p_5bet=cnt_p_5bet+playerdata.cnt_p_5bet::integer,cnt_p_5bet_def_action_fold=cnt_p_5bet_def_action_fold+playerdata.cnt_p_5bet_def_action_fold::integer,cnt_p_5bet_def_opp=cnt_p_5bet_def_opp+playerdata.cnt_p_5bet_def_opp::integer,cnt_p_5bet_opp=cnt_p_5bet_opp+playerdata.cnt_p_5bet_opp::integer,cnt_p_allin=cnt_p_allin+playerdata.cnt_p_allin::integer,cnt_p_allin_valid=cnt_p_allin_valid+playerdata.cnt_p_allin_valid::integer,cnt_p_bb_v_sb_3bet=cnt_p_bb_v_sb_3bet+playerdata.cnt_p_bb_v_sb_3bet::integer,cnt_p_bb_v_sb_3bet_opp=cnt_p_bb_v_sb_3bet_opp+playerdata.cnt_p_bb_v_sb_3bet_opp::integer,cnt_p_bb_v_sb_call=cnt_p_bb_v_sb_call+playerdata.cnt_p_bb_v_sb_call::integer,cnt_p_bb_v_sb_fold=cnt_p_bb_v_sb_fold+playerdata.cnt_p_bb_v_sb_fold::integer,cnt_p_call=cnt_p_call+playerdata.cnt_p_call::integer,cnt_p_call_vs_btn_open=cnt_p_call_vs_btn_open+playerdata.cnt_p_call_vs_btn_open::integer,cnt_p_call_vs_co_open=cnt_p_call_vs_co_open+playerdata.cnt_p_call_vs_co_open::integer,cnt_p_ccall=cnt_p_ccall+playerdata.cnt_p_ccall::integer,cnt_p_ccall_3bet=cnt_p_ccall_3bet+playerdata.cnt_p_ccall_3bet::integer,cnt_p_ccall_3bet_opp=cnt_p_ccall_3bet_opp+playerdata.cnt_p_ccall_3bet_opp::integer,cnt_p_ccall_opp=cnt_p_ccall_opp+playerdata.cnt_p_ccall_opp::integer,cnt_p_facing_limpers=cnt_p_facing_limpers+playerdata.cnt_p_facing_limpers::integer,cnt_p_fold=cnt_p_fold+playerdata.cnt_p_fold::integer,cnt_p_fold_vs_btn_open=cnt_p_fold_vs_btn_open+playerdata.cnt_p_fold_vs_btn_open::integer,cnt_p_fold_vs_co_open=cnt_p_fold_vs_co_open+playerdata.cnt_p_fold_vs_co_open::integer,cnt_p_limp=cnt_p_limp+playerdata.cnt_p_limp::integer,cnt_p_limp_call=cnt_p_limp_call+playerdata.cnt_p_limp_call::integer,cnt_p_limp_faceraise=cnt_p_limp_faceraise+playerdata.cnt_p_limp_faceraise::integer,cnt_p_limp_fold=cnt_p_limp_fold+playerdata.cnt_p_limp_fold::integer,cnt_p_limp_opp=cnt_p_limp_opp+playerdata.cnt_p_limp_opp::integer,cnt_p_limp_opp_facing_limpers=cnt_p_limp_opp_facing_limpers+playerdata.cnt_p_limp_opp_facing_limpers::integer,cnt_p_limp_raise=cnt_p_limp_raise+playerdata.cnt_p_limp_raise::integer,cnt_p_open_opp=cnt_p_open_opp+playerdata.cnt_p_open_opp::integer,cnt_p_open_opp_btn=cnt_p_open_opp_btn+playerdata.cnt_p_open_opp_btn::integer,cnt_p_open_opp_ep=cnt_p_open_opp_ep+playerdata.cnt_p_open_opp_ep::integer,cnt_p_raise=cnt_p_raise+playerdata.cnt_p_raise::integer,cnt_p_raise_3bet=cnt_p_raise_3bet+playerdata.cnt_p_raise_3bet::integer,cnt_p_raise_first_in=cnt_p_raise_first_in+playerdata.cnt_p_raise_first_in::integer,cnt_p_raise_limpers=cnt_p_raise_limpers+playerdata.cnt_p_raise_limpers::integer,cnt_p_rfi_btn=cnt_p_rfi_btn+playerdata.cnt_p_rfi_btn::integer,cnt_p_rfi_ep=cnt_p_rfi_ep+playerdata.cnt_p_rfi_ep::integer,cnt_p_squeeze=cnt_p_squeeze+playerdata.cnt_p_squeeze::integer,cnt_p_squeeze_def_call=cnt_p_squeeze_def_call+playerdata.cnt_p_squeeze_def_call::integer,cnt_p_squeeze_def_fold=cnt_p_squeeze_def_fold+playerdata.cnt_p_squeeze_def_fold::integer,cnt_p_squeeze_def_opp=cnt_p_squeeze_def_opp+playerdata.cnt_p_squeeze_def_opp::integer,cnt_p_squeeze_def_raise=cnt_p_squeeze_def_raise+playerdata.cnt_p_squeeze_def_raise::integer,cnt_p_squeeze_opp=cnt_p_squeeze_opp+playerdata.cnt_p_squeeze_opp::integer,cnt_pfr=cnt_pfr+playerdata.cnt_pfr::integer,cnt_pfr_opp=cnt_pfr_opp+playerdata.cnt_pfr_opp::integer,cnt_players_ttl=cnt_players_ttl+playerdata.cnt_players_ttl::integer,cnt_prev_callers_limp=cnt_prev_callers_limp+playerdata.cnt_prev_callers_limp::integer,cnt_r_2bet_def_action_call=cnt_r_2bet_def_action_call+playerdata.cnt_r_2bet_def_action_call::integer,cnt_r_2bet_def_action_fold=cnt_r_2bet_def_action_fold+playerdata.cnt_r_2bet_def_action_fold::integer,cnt_r_3bet=cnt_r_3bet+playerdata.cnt_r_3bet::integer,cnt_r_3bet_def_action_call=cnt_r_3bet_def_action_call+playerdata.cnt_r_3bet_def_action_call::integer,cnt_r_3bet_def_action_fold=cnt_r_3bet_def_action_fold+playerdata.cnt_r_3bet_def_action_fold::integer,cnt_r_3bet_def_opp=cnt_r_3bet_def_opp+playerdata.cnt_r_3bet_def_opp::integer,cnt_r_3bet_opp=cnt_r_3bet_opp+playerdata.cnt_r_3bet_opp::integer,cnt_r_4bet=cnt_r_4bet+playerdata.cnt_r_4bet::integer,cnt_r_4bet_def_action_call=cnt_r_4bet_def_action_call+playerdata.cnt_r_4bet_def_action_call::integer,cnt_r_4bet_def_action_fold=cnt_r_4bet_def_action_fold+playerdata.cnt_r_4bet_def_action_fold::integer,cnt_r_4bet_def_opp=cnt_r_4bet_def_opp+playerdata.cnt_r_4bet_def_opp::integer,cnt_r_4bet_opp=cnt_r_4bet_opp+playerdata.cnt_r_4bet_opp::integer,cnt_r_allin=cnt_r_allin+playerdata.cnt_r_allin::integer,cnt_r_allin_valid=cnt_r_allin_valid+playerdata.cnt_r_allin_valid::integer,cnt_r_bet=cnt_r_bet+playerdata.cnt_r_bet::integer,cnt_r_bet_def_action_call=cnt_r_bet_def_action_call+playerdata.cnt_r_bet_def_action_call::integer,cnt_r_bet_def_action_fold=cnt_r_bet_def_action_fold+playerdata.cnt_r_bet_def_action_fold::integer,cnt_r_bet_def_action_raise=cnt_r_bet_def_action_raise+playerdata.cnt_r_bet_def_action_raise::integer,cnt_r_bet_def_opp=cnt_r_bet_def_opp+playerdata.cnt_r_bet_def_opp::integer,cnt_r_call=cnt_r_call+playerdata.cnt_r_call::integer,cnt_r_call_hands=cnt_r_call_hands+playerdata.cnt_r_call_hands::integer,cnt_r_cbet=cnt_r_cbet+playerdata.cnt_r_cbet::integer,cnt_r_cbet_3bet_pot=cnt_r_cbet_3bet_pot+playerdata.cnt_r_cbet_3bet_pot::integer,cnt_r_cbet_def_action_call=cnt_r_cbet_def_action_call+playerdata.cnt_r_cbet_def_action_call::integer,cnt_r_cbet_def_action_fold=cnt_r_cbet_def_action_fold+playerdata.cnt_r_cbet_def_action_fold::integer,cnt_r_cbet_def_action_raise=cnt_r_cbet_def_action_raise+playerdata.cnt_r_cbet_def_action_raise::integer,cnt_r_cbet_def_opp=cnt_r_cbet_def_opp+playerdata.cnt_r_cbet_def_opp::integer,cnt_r_cbet_face_raise=cnt_r_cbet_face_raise+playerdata.cnt_r_cbet_face_raise::integer,cnt_r_cbet_face_raise_3bet_pot=cnt_r_cbet_face_raise_3bet_pot+playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,cnt_r_cbet_fold_to_raise=cnt_r_cbet_fold_to_raise+playerdata.cnt_r_cbet_fold_to_raise::integer,cnt_r_cbet_fold_to_raise_3bet_pot=cnt_r_cbet_fold_to_raise_3bet_pot+playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,cnt_r_cbet_opp=cnt_r_cbet_opp+playerdata.cnt_r_cbet_opp::integer,cnt_r_cbet_opp_3bet_pot=cnt_r_cbet_opp_3bet_pot+playerdata.cnt_r_cbet_opp_3bet_pot::integer,cnt_r_cbet_success=cnt_r_cbet_success+playerdata.cnt_r_cbet_success::integer,cnt_r_check=cnt_r_check+playerdata.cnt_r_check::integer,cnt_r_check_raise=cnt_r_check_raise+playerdata.cnt_r_check_raise::integer,cnt_r_check_raise_opp=cnt_r_check_raise_opp+playerdata.cnt_r_check_raise_opp::integer,cnt_r_donk=cnt_r_donk+playerdata.cnt_r_donk::integer,cnt_r_donk_3bet_pot=cnt_r_donk_3bet_pot+playerdata.cnt_r_donk_3bet_pot::integer,cnt_r_donk_def_action_call=cnt_r_donk_def_action_call+playerdata.cnt_r_donk_def_action_call::integer,cnt_r_donk_def_action_fold=cnt_r_donk_def_action_fold+playerdata.cnt_r_donk_def_action_fold::integer,cnt_r_donk_def_action_fold_3bet_pot=cnt_r_donk_def_action_fold_3bet_pot+playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,cnt_r_donk_def_action_raise=cnt_r_donk_def_action_raise+playerdata.cnt_r_donk_def_action_raise::integer,cnt_r_donk_def_opp=cnt_r_donk_def_opp+playerdata.cnt_r_donk_def_opp::integer,cnt_r_donk_def_opp_3bet_pot=cnt_r_donk_def_opp_3bet_pot+playerdata.cnt_r_donk_def_opp_3bet_pot::integer,cnt_r_donk_face_raise=cnt_r_donk_face_raise+playerdata.cnt_r_donk_face_raise::integer,cnt_r_donk_fold=cnt_r_donk_fold+playerdata.cnt_r_donk_fold::integer,cnt_r_donk_opp=cnt_r_donk_opp+playerdata.cnt_r_donk_opp::integer,cnt_r_donk_opp_3bet_pot=cnt_r_donk_opp_3bet_pot+playerdata.cnt_r_donk_opp_3bet_pot::integer,cnt_r_face_xr=cnt_r_face_xr+playerdata.cnt_r_face_xr::integer,cnt_r_face_xr_call=cnt_r_face_xr_call+playerdata.cnt_r_face_xr_call::integer,cnt_r_face_xr_fold=cnt_r_face_xr_fold+playerdata.cnt_r_face_xr_fold::integer,cnt_r_face_xr_raise=cnt_r_face_xr_raise+playerdata.cnt_r_face_xr_raise::integer,cnt_r_float=cnt_r_float+playerdata.cnt_r_float::integer,cnt_r_float_3bet_pot=cnt_r_float_3bet_pot+playerdata.cnt_r_float_3bet_pot::integer,cnt_r_float_def_action_call=cnt_r_float_def_action_call+playerdata.cnt_r_float_def_action_call::integer,cnt_r_float_def_action_fold=cnt_r_float_def_action_fold+playerdata.cnt_r_float_def_action_fold::integer,cnt_r_float_def_action_raise=cnt_r_float_def_action_raise+playerdata.cnt_r_float_def_action_raise::integer,cnt_r_float_def_opp=cnt_r_float_def_opp+playerdata.cnt_r_float_def_opp::integer,cnt_r_float_face_raise=cnt_r_float_face_raise+playerdata.cnt_r_float_face_raise::integer,cnt_r_float_fold=cnt_r_float_fold+playerdata.cnt_r_float_fold::integer,cnt_r_float_opp=cnt_r_float_opp+playerdata.cnt_r_float_opp::integer,cnt_r_float_opp_3bet_pot=cnt_r_float_opp_3bet_pot+playerdata.cnt_r_float_opp_3bet_pot::integer,cnt_r_fold=cnt_r_fold+playerdata.cnt_r_fold::integer,cnt_r_probe=cnt_r_probe+playerdata.cnt_r_probe::integer,cnt_r_probe_3bet_pot=cnt_r_probe_3bet_pot+playerdata.cnt_r_probe_3bet_pot::integer,cnt_r_probe_def_action_call=cnt_r_probe_def_action_call+playerdata.cnt_r_probe_def_action_call::integer,cnt_r_probe_def_action_fold=cnt_r_probe_def_action_fold+playerdata.cnt_r_probe_def_action_fold::integer,cnt_r_probe_def_action_raise=cnt_r_probe_def_action_raise+playerdata.cnt_r_probe_def_action_raise::integer,cnt_r_probe_def_opp=cnt_r_probe_def_opp+playerdata.cnt_r_probe_def_opp::integer,cnt_r_probe_face_raise=cnt_r_probe_face_raise+playerdata.cnt_r_probe_face_raise::integer,cnt_r_probe_fold=cnt_r_probe_fold+playerdata.cnt_r_probe_fold::integer,cnt_r_probe_opp=cnt_r_probe_opp+playerdata.cnt_r_probe_opp::integer,cnt_r_probe_opp_3bet_pot=cnt_r_probe_opp_3bet_pot+playerdata.cnt_r_probe_opp_3bet_pot::integer,cnt_r_raise=cnt_r_raise+playerdata.cnt_r_raise::integer,cnt_r_raise_wtsd=cnt_r_raise_wtsd+playerdata.cnt_r_raise_wtsd::integer,cnt_r_raise_wtsd_won=cnt_r_raise_wtsd_won+playerdata.cnt_r_raise_wtsd_won::integer,cnt_r_saw=cnt_r_saw+playerdata.cnt_r_saw::integer,cnt_steal_3bet_def_action_fold=cnt_steal_3bet_def_action_fold+playerdata.cnt_steal_3bet_def_action_fold::integer,cnt_steal_3bet_def_opp=cnt_steal_3bet_def_opp+playerdata.cnt_steal_3bet_def_opp::integer,cnt_steal_att=cnt_steal_att+playerdata.cnt_steal_att::integer,cnt_steal_att_lp=cnt_steal_att_lp+playerdata.cnt_steal_att_lp::integer,cnt_steal_att_sb=cnt_steal_att_sb+playerdata.cnt_steal_att_sb::integer,cnt_steal_def_3bet_opp=cnt_steal_def_3bet_opp+playerdata.cnt_steal_def_3bet_opp::integer,cnt_steal_def_3bet_opp_vs_lp=cnt_steal_def_3bet_opp_vs_lp+playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,cnt_steal_def_action_call=cnt_steal_def_action_call+playerdata.cnt_steal_def_action_call::integer,cnt_steal_def_action_call_vs_lp=cnt_steal_def_action_call_vs_lp+playerdata.cnt_steal_def_action_call_vs_lp::integer,cnt_steal_def_action_fold=cnt_steal_def_action_fold+playerdata.cnt_steal_def_action_fold::integer,cnt_steal_def_action_fold_vs_lp=cnt_steal_def_action_fold_vs_lp+playerdata.cnt_steal_def_action_fold_vs_lp::integer,cnt_steal_def_action_raise=cnt_steal_def_action_raise+playerdata.cnt_steal_def_action_raise::integer,cnt_steal_def_action_raise_vs_lp=cnt_steal_def_action_raise_vs_lp+playerdata.cnt_steal_def_action_raise_vs_lp::integer,cnt_steal_def_opp=cnt_steal_def_opp+playerdata.cnt_steal_def_opp::integer,cnt_steal_def_opp_vs_lp=cnt_steal_def_opp_vs_lp+playerdata.cnt_steal_def_opp_vs_lp::integer,cnt_steal_opp=cnt_steal_opp+playerdata.cnt_steal_opp::integer,cnt_steal_opp_lp=cnt_steal_opp_lp+playerdata.cnt_steal_opp_lp::integer,cnt_steal_opp_sb=cnt_steal_opp_sb+playerdata.cnt_steal_opp_sb::integer,cnt_steal_reraise_def_action_fold=cnt_steal_reraise_def_action_fold+playerdata.cnt_steal_reraise_def_action_fold::integer,cnt_steal_reraise_def_opp=cnt_steal_reraise_def_opp+playerdata.cnt_steal_reraise_def_opp::integer,cnt_steal_success=cnt_steal_success+playerdata.cnt_steal_success::integer,cnt_t_2bet_def_action_call=cnt_t_2bet_def_action_call+playerdata.cnt_t_2bet_def_action_call::integer,cnt_t_2bet_def_action_fold=cnt_t_2bet_def_action_fold+playerdata.cnt_t_2bet_def_action_fold::integer,cnt_t_3bet=cnt_t_3bet+playerdata.cnt_t_3bet::integer,cnt_t_3bet_def_action_call=cnt_t_3bet_def_action_call+playerdata.cnt_t_3bet_def_action_call::integer,cnt_t_3bet_def_action_fold=cnt_t_3bet_def_action_fold+playerdata.cnt_t_3bet_def_action_fold::integer,cnt_t_3bet_def_opp=cnt_t_3bet_def_opp+playerdata.cnt_t_3bet_def_opp::integer,cnt_t_3bet_opp=cnt_t_3bet_opp+playerdata.cnt_t_3bet_opp::integer,cnt_t_4bet=cnt_t_4bet+playerdata.cnt_t_4bet::integer,cnt_t_4bet_def_action_call=cnt_t_4bet_def_action_call+playerdata.cnt_t_4bet_def_action_call::integer,cnt_t_4bet_def_action_fold=cnt_t_4bet_def_action_fold+playerdata.cnt_t_4bet_def_action_fold::integer,cnt_t_4bet_def_opp=cnt_t_4bet_def_opp+playerdata.cnt_t_4bet_def_opp::integer,cnt_t_4bet_opp=cnt_t_4bet_opp+playerdata.cnt_t_4bet_opp::integer,cnt_t_allin=cnt_t_allin+playerdata.cnt_t_allin::integer,cnt_t_allin_valid=cnt_t_allin_valid+playerdata.cnt_t_allin_valid::integer,cnt_t_bet=cnt_t_bet+playerdata.cnt_t_bet::integer,cnt_t_bet_def_action_call=cnt_t_bet_def_action_call+playerdata.cnt_t_bet_def_action_call::integer,cnt_t_bet_def_action_fold=cnt_t_bet_def_action_fold+playerdata.cnt_t_bet_def_action_fold::integer,cnt_t_bet_def_action_raise=cnt_t_bet_def_action_raise+playerdata.cnt_t_bet_def_action_raise::integer,cnt_t_bet_def_opp=cnt_t_bet_def_opp+playerdata.cnt_t_bet_def_opp::integer,cnt_t_call=cnt_t_call+playerdata.cnt_t_call::integer,cnt_t_cbet=cnt_t_cbet+playerdata.cnt_t_cbet::integer,cnt_t_cbet_3bet_pot=cnt_t_cbet_3bet_pot+playerdata.cnt_t_cbet_3bet_pot::integer,cnt_t_cbet_def_action_call=cnt_t_cbet_def_action_call+playerdata.cnt_t_cbet_def_action_call::integer,cnt_t_cbet_def_action_fold=cnt_t_cbet_def_action_fold+playerdata.cnt_t_cbet_def_action_fold::integer,cnt_t_cbet_def_action_raise=cnt_t_cbet_def_action_raise+playerdata.cnt_t_cbet_def_action_raise::integer,cnt_t_cbet_def_opp=cnt_t_cbet_def_opp+playerdata.cnt_t_cbet_def_opp::integer,cnt_t_cbet_face_raise=cnt_t_cbet_face_raise+playerdata.cnt_t_cbet_face_raise::integer,cnt_t_cbet_face_raise_3bet_pot=cnt_t_cbet_face_raise_3bet_pot+playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,cnt_t_cbet_fold_to_raise=cnt_t_cbet_fold_to_raise+playerdata.cnt_t_cbet_fold_to_raise::integer,cnt_t_cbet_fold_to_raise_3bet_pot=cnt_t_cbet_fold_to_raise_3bet_pot+playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,cnt_t_cbet_opp=cnt_t_cbet_opp+playerdata.cnt_t_cbet_opp::integer,cnt_t_cbet_opp_3bet_pot=cnt_t_cbet_opp_3bet_pot+playerdata.cnt_t_cbet_opp_3bet_pot::integer,cnt_t_cbet_success=cnt_t_cbet_success+playerdata.cnt_t_cbet_success::integer,cnt_t_check=cnt_t_check+playerdata.cnt_t_check::integer,cnt_t_check_raise=cnt_t_check_raise+playerdata.cnt_t_check_raise::integer,cnt_t_check_raise_opp=cnt_t_check_raise_opp+playerdata.cnt_t_check_raise_opp::integer,cnt_t_donk=cnt_t_donk+playerdata.cnt_t_donk::integer,cnt_t_donk_3bet_pot=cnt_t_donk_3bet_pot+playerdata.cnt_t_donk_3bet_pot::integer,cnt_t_donk_def_action_call=cnt_t_donk_def_action_call+playerdata.cnt_t_donk_def_action_call::integer,cnt_t_donk_def_action_fold=cnt_t_donk_def_action_fold+playerdata.cnt_t_donk_def_action_fold::integer,cnt_t_donk_def_action_fold_3bet_pot=cnt_t_donk_def_action_fold_3bet_pot+playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,cnt_t_donk_def_action_raise=cnt_t_donk_def_action_raise+playerdata.cnt_t_donk_def_action_raise::integer,cnt_t_donk_def_opp=cnt_t_donk_def_opp+playerdata.cnt_t_donk_def_opp::integer,cnt_t_donk_def_opp_3bet_pot=cnt_t_donk_def_opp_3bet_pot+playerdata.cnt_t_donk_def_opp_3bet_pot::integer,cnt_t_donk_face_raise=cnt_t_donk_face_raise+playerdata.cnt_t_donk_face_raise::integer,cnt_t_donk_fold=cnt_t_donk_fold+playerdata.cnt_t_donk_fold::integer,cnt_t_donk_opp=cnt_t_donk_opp+playerdata.cnt_t_donk_opp::integer,cnt_t_donk_opp_3bet_pot=cnt_t_donk_opp_3bet_pot+playerdata.cnt_t_donk_opp_3bet_pot::integer,cnt_t_face_xr=cnt_t_face_xr+playerdata.cnt_t_face_xr::integer,cnt_t_face_xr_call=cnt_t_face_xr_call+playerdata.cnt_t_face_xr_call::integer,cnt_t_face_xr_fold=cnt_t_face_xr_fold+playerdata.cnt_t_face_xr_fold::integer,cnt_t_face_xr_raise=cnt_t_face_xr_raise+playerdata.cnt_t_face_xr_raise::integer,cnt_t_float=cnt_t_float+playerdata.cnt_t_float::integer,cnt_t_float_3bet_pot=cnt_t_float_3bet_pot+playerdata.cnt_t_float_3bet_pot::integer,cnt_t_float_def_action_call=cnt_t_float_def_action_call+playerdata.cnt_t_float_def_action_call::integer,cnt_t_float_def_action_fold=cnt_t_float_def_action_fold+playerdata.cnt_t_float_def_action_fold::integer,cnt_t_float_def_action_raise=cnt_t_float_def_action_raise+playerdata.cnt_t_float_def_action_raise::integer,cnt_t_float_def_opp=cnt_t_float_def_opp+playerdata.cnt_t_float_def_opp::integer,cnt_t_float_face_raise=cnt_t_float_face_raise+playerdata.cnt_t_float_face_raise::integer,cnt_t_float_fold=cnt_t_float_fold+playerdata.cnt_t_float_fold::integer,cnt_t_float_opp=cnt_t_float_opp+playerdata.cnt_t_float_opp::integer,cnt_t_float_opp_3bet_pot=cnt_t_float_opp_3bet_pot+playerdata.cnt_t_float_opp_3bet_pot::integer,cnt_t_fold=cnt_t_fold+playerdata.cnt_t_fold::integer,cnt_t_probe=cnt_t_probe+playerdata.cnt_t_probe::integer,cnt_t_probe_3bet_pot=cnt_t_probe_3bet_pot+playerdata.cnt_t_probe_3bet_pot::integer,cnt_t_probe_def_action_call=cnt_t_probe_def_action_call+playerdata.cnt_t_probe_def_action_call::integer,cnt_t_probe_def_action_fold=cnt_t_probe_def_action_fold+playerdata.cnt_t_probe_def_action_fold::integer,cnt_t_probe_def_action_raise=cnt_t_probe_def_action_raise+playerdata.cnt_t_probe_def_action_raise::integer,cnt_t_probe_def_opp=cnt_t_probe_def_opp+playerdata.cnt_t_probe_def_opp::integer,cnt_t_probe_face_raise=cnt_t_probe_face_raise+playerdata.cnt_t_probe_face_raise::integer,cnt_t_probe_fold=cnt_t_probe_fold+playerdata.cnt_t_probe_fold::integer,cnt_t_probe_opp=cnt_t_probe_opp+playerdata.cnt_t_probe_opp::integer,cnt_t_probe_opp_3bet_pot=cnt_t_probe_opp_3bet_pot+playerdata.cnt_t_probe_opp_3bet_pot::integer,cnt_t_raise=cnt_t_raise+playerdata.cnt_t_raise::integer,cnt_t_raise_wtsd=cnt_t_raise_wtsd+playerdata.cnt_t_raise_wtsd::integer,cnt_t_raise_wtsd_won=cnt_t_raise_wtsd_won+playerdata.cnt_t_raise_wtsd_won::integer,cnt_t_saw=cnt_t_saw+playerdata.cnt_t_saw::integer,cnt_vpip=cnt_vpip+playerdata.cnt_vpip::integer,cnt_vpip_sb=cnt_vpip_sb+playerdata.cnt_vpip_sb::integer,cnt_walks=cnt_walks+playerdata.cnt_walks::integer,cnt_won_hand=cnt_won_hand+playerdata.cnt_won_hand::integer,cnt_wtsd=cnt_wtsd+playerdata.cnt_wtsd::integer,cnt_wtsd_allin=cnt_wtsd_allin+playerdata.cnt_wtsd_allin::integer,cnt_wtsd_non_small=cnt_wtsd_non_small+playerdata.cnt_wtsd_non_small::integer,cnt_wtsd_won=cnt_wtsd_won+playerdata.cnt_wtsd_won::integer,cnt_wtsd_won_non_small=cnt_wtsd_won_non_small+playerdata.cnt_wtsd_won_non_small::integer,cnt_wtsd_won_when_r_call=cnt_wtsd_won_when_r_call+playerdata.cnt_wtsd_won_when_r_call::integer,limit_currency=playerdata.limit_currency,val_equity=val_equity+playerdata.val_equity::numeric(14,2),val_f_equity=val_f_equity+playerdata.val_f_equity::numeric(14,2),val_p_equity=val_p_equity+playerdata.val_p_equity::numeric(14,2),val_r_equity=val_r_equity+playerdata.val_r_equity::numeric(14,2),val_t_equity=val_t_equity+playerdata.val_t_equity::numeric(14,2) WHERE id_player = playerdata.id_player AND id_gametype = playerdata.id_gametype AND id_limit = playerdata.id_limit AND cnt_players = playerdata.cnt_players AND position_type = playerdata.position_type AND flg_has_position_f = playerdata.flg_has_position_f AND flg_has_position_t = playerdata.flg_has_position_t AND flg_has_position_r = playerdata.flg_has_position_r AND date_played_year_week = playerdata.date_played_year_week;
      IF found THEN
        CONTINUE;
      END IF;
    END updateCashPlayersDataInCache;      
    
    -- If cache update fails or we are rebuilding the player's cache then insert the data
    <<insertCashPlayerDataToCache>>
    BEGIN
      INSERT INTO cash_cache VALUES(playerdata.id_player, playerdata.id_gametype, playerdata.id_limit, playerdata.cnt_players,playerdata.position_type::integer,playerdata.flg_has_position_f::boolean,playerdata.flg_has_position_t::boolean,playerdata.flg_has_position_r::boolean,playerdata.date_played_year_week::integer,playerdata.amt_bb_won::numeric(14,2),playerdata.amt_bb_won_inc_payout::numeric(14,2),playerdata.amt_blind::numeric(14,2),playerdata.amt_blind_curr_conv::numeric(14,2),playerdata.amt_expected_bb_won::numeric(14,2),playerdata.amt_expected_won::numeric(14,2),playerdata.amt_expected_won_curr_conv::numeric(14,2),playerdata.amt_jackpot_taken::numeric(14,2),playerdata.amt_jackpot_taken_curr_conv::numeric(14,2),playerdata.amt_payout::numeric(14,2),playerdata.amt_payout_curr_conv::numeric(14,2),playerdata.amt_payout_fee::numeric(14,2),playerdata.amt_payout_fee_curr_conv::numeric(14,2),playerdata.amt_r_call::numeric(14,2),playerdata.amt_r_call_won::numeric(14,2),playerdata.amt_rake_attributed::numeric(14,2),playerdata.amt_rake_attributed_curr_conv::numeric(14,2),playerdata.amt_rake_share::numeric(14,2),playerdata.amt_rake_share_curr_conv::numeric(14,2),playerdata.amt_rake_taken::numeric(14,2),playerdata.amt_rake_taken_curr_conv::numeric(14,2),playerdata.amt_rake_weighted_contributed::numeric(14,2),playerdata.amt_rake_weighted_contributed_curr_conv::numeric(14,2),playerdata.amt_straddle::numeric(14,2),playerdata.amt_straddle_curr_conv::numeric(14,2),playerdata.amt_won::numeric(14,2),playerdata.amt_won_curr_conv::numeric(14,2),playerdata.amt_won_inc_payout::numeric(14,2),playerdata.amt_won_inc_payout_curr_conv::numeric(14,2),playerdata.cnt_blind::integer,playerdata.cnt_f_2bet_def_action_call::integer,playerdata.cnt_f_2bet_def_action_fold::integer,playerdata.cnt_f_3bet::integer,playerdata.cnt_f_3bet_def_action_call::integer,playerdata.cnt_f_3bet_def_action_fold::integer,playerdata.cnt_f_3bet_def_opp::integer,playerdata.cnt_f_3bet_opp::integer,playerdata.cnt_f_4bet::integer,playerdata.cnt_f_4bet_def_action_call::integer,playerdata.cnt_f_4bet_def_action_fold::integer,playerdata.cnt_f_4bet_def_opp::integer,playerdata.cnt_f_4bet_opp::integer,playerdata.cnt_f_allin::integer,playerdata.cnt_f_allin_valid::integer,playerdata.cnt_f_bet::integer,playerdata.cnt_f_bet_def_action_call::integer,playerdata.cnt_f_bet_def_action_fold::integer,playerdata.cnt_f_bet_def_action_raise::integer,playerdata.cnt_f_bet_def_opp::integer,playerdata.cnt_f_bet_limp_pot::integer,playerdata.cnt_f_call::integer,playerdata.cnt_f_cbet::integer,playerdata.cnt_f_cbet_3bet_pot::integer,playerdata.cnt_f_cbet_def_action_call::integer,playerdata.cnt_f_cbet_def_action_call_in_pos::integer,playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_fold::integer,playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_raise::integer,playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,playerdata.cnt_f_cbet_def_opp::integer,playerdata.cnt_f_cbet_face_raise::integer,playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,playerdata.cnt_f_cbet_fold_to_raise::integer,playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_f_cbet_opp::integer,playerdata.cnt_f_cbet_opp_3bet_pot::integer,playerdata.cnt_f_cbet_success::integer,playerdata.cnt_f_check::integer,playerdata.cnt_f_check_raise::integer,playerdata.cnt_f_check_raise_opp::integer,playerdata.cnt_f_donk::integer,playerdata.cnt_f_donk_3bet_pot::integer,playerdata.cnt_f_donk_def_opp::integer,playerdata.cnt_f_donk_def_opp_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_call::integer,playerdata.cnt_f_donk_def_opp_action_fold::integer,playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_raise::integer,playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,playerdata.cnt_f_donk_face_raise::integer,playerdata.cnt_f_donk_fold::integer,playerdata.cnt_f_donk_opp::integer,playerdata.cnt_f_donk_opp_3bet_pot::integer,playerdata.cnt_f_face_xr::integer,playerdata.cnt_f_face_xr_call::integer,playerdata.cnt_f_face_xr_fold::integer,playerdata.cnt_f_face_xr_raise::integer,playerdata.cnt_f_float::integer,playerdata.cnt_f_float_3bet_pot::integer,playerdata.cnt_f_float_def_opp::integer,playerdata.cnt_f_float_def_opp_action_call::integer,playerdata.cnt_f_float_def_opp_action_fold::integer,playerdata.cnt_f_float_def_opp_action_raise::integer,playerdata.cnt_f_float_face_raise::integer,playerdata.cnt_f_float_fold::integer,playerdata.cnt_f_float_opp::integer,playerdata.cnt_f_float_opp_3bet_pot::integer,playerdata.cnt_f_fold::integer,playerdata.cnt_f_open_opp_limp_pot::integer,playerdata.cnt_f_raise::integer,playerdata.cnt_f_raise_def_opp::integer,playerdata.cnt_f_saw::integer,playerdata.cnt_f_saw_won::integer,playerdata.cnt_hands::integer,playerdata.cnt_hands_won::integer,playerdata.cnt_p_2bet_def_action_call::integer,playerdata.cnt_p_2bet_def_action_fold::integer,playerdata.cnt_p_2bet_def_opp::integer,playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,playerdata.cnt_p_3bet::integer,playerdata.cnt_p_3bet_def_action_call::integer,playerdata.cnt_p_3bet_def_action_call_after_2b::integer,playerdata.cnt_p_3bet_def_action_fold::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,playerdata.cnt_p_3bet_def_opp::integer,playerdata.cnt_p_3bet_def_opp_after_2b::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_f_cbet_def_opp::integer,playerdata.cnt_p_3bet_opp::integer,playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_open::integer,playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,playerdata.cnt_p_3bet_opp_vs_co_open::integer,playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_r_cbet_def_opp::integer,playerdata.cnt_p_3bet_success::integer,playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_t_cbet_def_opp::integer,playerdata.cnt_p_3bet_vs_bb_2bet::integer,playerdata.cnt_p_3bet_vs_btn_2bet::integer,playerdata.cnt_p_3bet_vs_btn_open::integer,playerdata.cnt_p_3bet_vs_co_2bet::integer,playerdata.cnt_p_3bet_vs_co_open::integer,playerdata.cnt_p_3bet_vs_ep_2bet::integer,playerdata.cnt_p_3bet_vs_mp_2bet::integer,playerdata.cnt_p_3bet_vs_sb_2bet::integer,playerdata.cnt_p_4bet::integer,playerdata.cnt_p_4bet_after_raising::integer,playerdata.cnt_p_4bet_cold::integer,playerdata.cnt_p_4bet_cold_opp::integer,playerdata.cnt_p_4bet_def_action_call::integer,playerdata.cnt_p_4bet_def_action_fold::integer,playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,playerdata.cnt_p_4bet_def_opp::integer,playerdata.cnt_p_4bet_def_opp_after_3b::integer,playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,playerdata.cnt_p_4bet_opp::integer,playerdata.cnt_p_4bet_opp_when_open_raised::integer,playerdata.cnt_p_5bet::integer,playerdata.cnt_p_5bet_def_action_fold::integer,playerdata.cnt_p_5bet_def_opp::integer,playerdata.cnt_p_5bet_opp::integer,playerdata.cnt_p_allin::integer,playerdata.cnt_p_allin_valid::integer,playerdata.cnt_p_bb_v_sb_3bet::integer,playerdata.cnt_p_bb_v_sb_3bet_opp::integer,playerdata.cnt_p_bb_v_sb_call::integer,playerdata.cnt_p_bb_v_sb_fold::integer,playerdata.cnt_p_call::integer,playerdata.cnt_p_call_vs_btn_open::integer,playerdata.cnt_p_call_vs_co_open::integer,playerdata.cnt_p_ccall::integer,playerdata.cnt_p_ccall_3bet::integer,playerdata.cnt_p_ccall_3bet_opp::integer,playerdata.cnt_p_ccall_opp::integer,playerdata.cnt_p_facing_limpers::integer,playerdata.cnt_p_fold::integer,playerdata.cnt_p_fold_vs_btn_open::integer,playerdata.cnt_p_fold_vs_co_open::integer,playerdata.cnt_p_limp::integer,playerdata.cnt_p_limp_call::integer,playerdata.cnt_p_limp_faceraise::integer,playerdata.cnt_p_limp_fold::integer,playerdata.cnt_p_limp_opp::integer,playerdata.cnt_p_limp_opp_facing_limpers::integer,playerdata.cnt_p_limp_raise::integer,playerdata.cnt_p_open_opp::integer,playerdata.cnt_p_open_opp_btn::integer,playerdata.cnt_p_open_opp_ep::integer,playerdata.cnt_p_raise::integer,playerdata.cnt_p_raise_3bet::integer,playerdata.cnt_p_raise_first_in::integer,playerdata.cnt_p_raise_limpers::integer,playerdata.cnt_p_rfi_btn::integer,playerdata.cnt_p_rfi_ep::integer,playerdata.cnt_p_squeeze::integer,playerdata.cnt_p_squeeze_def_call::integer,playerdata.cnt_p_squeeze_def_fold::integer,playerdata.cnt_p_squeeze_def_opp::integer,playerdata.cnt_p_squeeze_def_raise::integer,playerdata.cnt_p_squeeze_opp::integer,playerdata.cnt_pfr::integer,playerdata.cnt_pfr_opp::integer,playerdata.cnt_players_ttl::integer,playerdata.cnt_prev_callers_limp::integer,playerdata.cnt_r_2bet_def_action_call::integer,playerdata.cnt_r_2bet_def_action_fold::integer,playerdata.cnt_r_3bet::integer,playerdata.cnt_r_3bet_def_action_call::integer,playerdata.cnt_r_3bet_def_action_fold::integer,playerdata.cnt_r_3bet_def_opp::integer,playerdata.cnt_r_3bet_opp::integer,playerdata.cnt_r_4bet::integer,playerdata.cnt_r_4bet_def_action_call::integer,playerdata.cnt_r_4bet_def_action_fold::integer,playerdata.cnt_r_4bet_def_opp::integer,playerdata.cnt_r_4bet_opp::integer,playerdata.cnt_r_allin::integer,playerdata.cnt_r_allin_valid::integer,playerdata.cnt_r_bet::integer,playerdata.cnt_r_bet_def_action_call::integer,playerdata.cnt_r_bet_def_action_fold::integer,playerdata.cnt_r_bet_def_action_raise::integer,playerdata.cnt_r_bet_def_opp::integer,playerdata.cnt_r_call::integer,playerdata.cnt_r_call_hands::integer,playerdata.cnt_r_cbet::integer,playerdata.cnt_r_cbet_3bet_pot::integer,playerdata.cnt_r_cbet_def_action_call::integer,playerdata.cnt_r_cbet_def_action_fold::integer,playerdata.cnt_r_cbet_def_action_raise::integer,playerdata.cnt_r_cbet_def_opp::integer,playerdata.cnt_r_cbet_face_raise::integer,playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,playerdata.cnt_r_cbet_fold_to_raise::integer,playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_r_cbet_opp::integer,playerdata.cnt_r_cbet_opp_3bet_pot::integer,playerdata.cnt_r_cbet_success::integer,playerdata.cnt_r_check::integer,playerdata.cnt_r_check_raise::integer,playerdata.cnt_r_check_raise_opp::integer,playerdata.cnt_r_donk::integer,playerdata.cnt_r_donk_3bet_pot::integer,playerdata.cnt_r_donk_def_action_call::integer,playerdata.cnt_r_donk_def_action_fold::integer,playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_r_donk_def_action_raise::integer,playerdata.cnt_r_donk_def_opp::integer,playerdata.cnt_r_donk_def_opp_3bet_pot::integer,playerdata.cnt_r_donk_face_raise::integer,playerdata.cnt_r_donk_fold::integer,playerdata.cnt_r_donk_opp::integer,playerdata.cnt_r_donk_opp_3bet_pot::integer,playerdata.cnt_r_face_xr::integer,playerdata.cnt_r_face_xr_call::integer,playerdata.cnt_r_face_xr_fold::integer,playerdata.cnt_r_face_xr_raise::integer,playerdata.cnt_r_float::integer,playerdata.cnt_r_float_3bet_pot::integer,playerdata.cnt_r_float_def_action_call::integer,playerdata.cnt_r_float_def_action_fold::integer,playerdata.cnt_r_float_def_action_raise::integer,playerdata.cnt_r_float_def_opp::integer,playerdata.cnt_r_float_face_raise::integer,playerdata.cnt_r_float_fold::integer,playerdata.cnt_r_float_opp::integer,playerdata.cnt_r_float_opp_3bet_pot::integer,playerdata.cnt_r_fold::integer,playerdata.cnt_r_probe::integer,playerdata.cnt_r_probe_3bet_pot::integer,playerdata.cnt_r_probe_def_action_call::integer,playerdata.cnt_r_probe_def_action_fold::integer,playerdata.cnt_r_probe_def_action_raise::integer,playerdata.cnt_r_probe_def_opp::integer,playerdata.cnt_r_probe_face_raise::integer,playerdata.cnt_r_probe_fold::integer,playerdata.cnt_r_probe_opp::integer,playerdata.cnt_r_probe_opp_3bet_pot::integer,playerdata.cnt_r_raise::integer,playerdata.cnt_r_raise_wtsd::integer,playerdata.cnt_r_raise_wtsd_won::integer,playerdata.cnt_r_saw::integer,playerdata.cnt_steal_3bet_def_action_fold::integer,playerdata.cnt_steal_3bet_def_opp::integer,playerdata.cnt_steal_att::integer,playerdata.cnt_steal_att_lp::integer,playerdata.cnt_steal_att_sb::integer,playerdata.cnt_steal_def_3bet_opp::integer,playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,playerdata.cnt_steal_def_action_call::integer,playerdata.cnt_steal_def_action_call_vs_lp::integer,playerdata.cnt_steal_def_action_fold::integer,playerdata.cnt_steal_def_action_fold_vs_lp::integer,playerdata.cnt_steal_def_action_raise::integer,playerdata.cnt_steal_def_action_raise_vs_lp::integer,playerdata.cnt_steal_def_opp::integer,playerdata.cnt_steal_def_opp_vs_lp::integer,playerdata.cnt_steal_opp::integer,playerdata.cnt_steal_opp_lp::integer,playerdata.cnt_steal_opp_sb::integer,playerdata.cnt_steal_reraise_def_action_fold::integer,playerdata.cnt_steal_reraise_def_opp::integer,playerdata.cnt_steal_success::integer,playerdata.cnt_t_2bet_def_action_call::integer,playerdata.cnt_t_2bet_def_action_fold::integer,playerdata.cnt_t_3bet::integer,playerdata.cnt_t_3bet_def_action_call::integer,playerdata.cnt_t_3bet_def_action_fold::integer,playerdata.cnt_t_3bet_def_opp::integer,playerdata.cnt_t_3bet_opp::integer,playerdata.cnt_t_4bet::integer,playerdata.cnt_t_4bet_def_action_call::integer,playerdata.cnt_t_4bet_def_action_fold::integer,playerdata.cnt_t_4bet_def_opp::integer,playerdata.cnt_t_4bet_opp::integer,playerdata.cnt_t_allin::integer,playerdata.cnt_t_allin_valid::integer,playerdata.cnt_t_bet::integer,playerdata.cnt_t_bet_def_action_call::integer,playerdata.cnt_t_bet_def_action_fold::integer,playerdata.cnt_t_bet_def_action_raise::integer,playerdata.cnt_t_bet_def_opp::integer,playerdata.cnt_t_call::integer,playerdata.cnt_t_cbet::integer,playerdata.cnt_t_cbet_3bet_pot::integer,playerdata.cnt_t_cbet_def_action_call::integer,playerdata.cnt_t_cbet_def_action_fold::integer,playerdata.cnt_t_cbet_def_action_raise::integer,playerdata.cnt_t_cbet_def_opp::integer,playerdata.cnt_t_cbet_face_raise::integer,playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,playerdata.cnt_t_cbet_fold_to_raise::integer,playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_t_cbet_opp::integer,playerdata.cnt_t_cbet_opp_3bet_pot::integer,playerdata.cnt_t_cbet_success::integer,playerdata.cnt_t_check::integer,playerdata.cnt_t_check_raise::integer,playerdata.cnt_t_check_raise_opp::integer,playerdata.cnt_t_donk::integer,playerdata.cnt_t_donk_3bet_pot::integer,playerdata.cnt_t_donk_def_action_call::integer,playerdata.cnt_t_donk_def_action_fold::integer,playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_t_donk_def_action_raise::integer,playerdata.cnt_t_donk_def_opp::integer,playerdata.cnt_t_donk_def_opp_3bet_pot::integer,playerdata.cnt_t_donk_face_raise::integer,playerdata.cnt_t_donk_fold::integer,playerdata.cnt_t_donk_opp::integer,playerdata.cnt_t_donk_opp_3bet_pot::integer,playerdata.cnt_t_face_xr::integer,playerdata.cnt_t_face_xr_call::integer,playerdata.cnt_t_face_xr_fold::integer,playerdata.cnt_t_face_xr_raise::integer,playerdata.cnt_t_float::integer,playerdata.cnt_t_float_3bet_pot::integer,playerdata.cnt_t_float_def_action_call::integer,playerdata.cnt_t_float_def_action_fold::integer,playerdata.cnt_t_float_def_action_raise::integer,playerdata.cnt_t_float_def_opp::integer,playerdata.cnt_t_float_face_raise::integer,playerdata.cnt_t_float_fold::integer,playerdata.cnt_t_float_opp::integer,playerdata.cnt_t_float_opp_3bet_pot::integer,playerdata.cnt_t_fold::integer,playerdata.cnt_t_probe::integer,playerdata.cnt_t_probe_3bet_pot::integer,playerdata.cnt_t_probe_def_action_call::integer,playerdata.cnt_t_probe_def_action_fold::integer,playerdata.cnt_t_probe_def_action_raise::integer,playerdata.cnt_t_probe_def_opp::integer,playerdata.cnt_t_probe_face_raise::integer,playerdata.cnt_t_probe_fold::integer,playerdata.cnt_t_probe_opp::integer,playerdata.cnt_t_probe_opp_3bet_pot::integer,playerdata.cnt_t_raise::integer,playerdata.cnt_t_raise_wtsd::integer,playerdata.cnt_t_raise_wtsd_won::integer,playerdata.cnt_t_saw::integer,playerdata.cnt_vpip::integer,playerdata.cnt_vpip_sb::integer,playerdata.cnt_walks::integer,playerdata.cnt_won_hand::integer,playerdata.cnt_wtsd::integer,playerdata.cnt_wtsd_allin::integer,playerdata.cnt_wtsd_non_small::integer,playerdata.cnt_wtsd_won::integer,playerdata.cnt_wtsd_won_non_small::integer,playerdata.cnt_wtsd_won_when_r_call::integer,playerdata.limit_currency::text,playerdata.val_equity::numeric(14,2),playerdata.val_f_equity::numeric(14,2),playerdata.val_p_equity::numeric(14,2),playerdata.val_r_equity::numeric(14,2),playerdata.val_t_equity::numeric(14,2));
      CONTINUE;
    END insertCashPlayerDataToCache;
    
  END LOOP getCashPlayersDataToCache;
  
  <<updateLastIdHandCached>>
  BEGIN
    UPDATE settings SET setting_value = ( SELECT CASE WHEN max(id_hand) IS NULL THEN 0 ELSE max(id_hand) END FROM cash_hand_player_statistics ) WHERE setting_name = 'cache_update:cash';
    IF NOT FOUND THEN
      INSERT INTO settings (setting_name, setting_value) VALUES ( 'cache_update:cash', ( SELECT CASE WHEN max(id_hand) IS NULL THEN 0 ELSE max(id_hand) END FROM cash_hand_player_statistics ) );
    END IF;
  END updateLastIdHandCached;
  
  RETURN;
END;
$$;


ALTER FUNCTION public.update_cash_cache() OWNER TO %USERNAME%;

--
-- TOC entry 218 (class 1255 OID 17394)
-- Name: update_cash_cache_date(integer, integer[]); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_cash_cache_date(integer, integer[]) RETURNS void
    LANGUAGE plpgsql
    AS $_$

DECLARE
  playerdata cash_cache%ROWTYPE;

BEGIN
  <<deletePlayersCache>>
  BEGIN
    DELETE FROM cash_cache WHERE id_player = $1 AND date_played_year_week = ANY ($2);
  END deletePlayersCache;

  <<getCashPlayersDataToCache>>
  FOR playerdata IN 
    SELECT cash_hand_player_statistics.id_player, cash_hand_player_statistics.id_gametype, cash_hand_player_statistics.id_limit, cash_hand_summary.cnt_players,((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)), (cash_hand_player_statistics.flg_f_has_position), (cash_hand_player_statistics.flg_t_has_position), (cash_hand_player_statistics.flg_r_has_position), (CAST ( ((date_part('year',  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN ((cash_hand_player_statistics.amt_won * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN (((case when(cash_hand_player_statistics.amt_payout > 0) then (cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl) else  cash_hand_player_statistics.amt_won end) * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum(cash_hand_player_statistics.amt_blind)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_blind) as numeric) )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN ((cash_hand_player_statistics.amt_expected_won * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum(cash_hand_player_statistics.amt_expected_won)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_expected_won) as numeric ))), (sum(cash_hand_summary.amt_jackpot_fee)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_jackpot_fee) as numeric ))), (sum(cash_hand_player_statistics.amt_payout)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_payout)) AS numeric ))), (sum(cash_hand_player_statistics.amt_payout_fee)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_payout_fee)) AS numeric ))), (sum( (case when( cash_hand_player_statistics.cnt_r_call > 0 AND (cash_hand_player_statistics.amt_r_bet_made + cash_hand_player_statistics.amt_r_raise_made) = 0) then  cash_hand_player_statistics.amt_bet_r else  0  end))), (sum( (case when( cash_hand_player_statistics.cnt_r_call > 0 AND (cash_hand_player_statistics.amt_r_bet_made + cash_hand_player_statistics.amt_r_raise_made) = 0 AND cash_hand_player_statistics.flg_won_hand) then  cash_hand_player_statistics.amt_won + cash_hand_player_statistics.amt_bet_ttl else  0  end))), (sum(cash_hand_summary.amt_rake * ( (CASE WHEN ( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee)) <> 0 THEN (( (cash_hand_player_statistics.amt_won +  cash_hand_player_statistics.amt_bet_ttl)  * 1.0 )/( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee))) ELSE 0 END) ))), (sum(CAST( ((case when(cash_hand_player_statistics.flg_won_hand) then  cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_rake * ( (CASE WHEN ( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee)) <> 0 THEN (( (cash_hand_player_statistics.amt_won + cash_hand_player_statistics.amt_bet_ttl)  * 1.0 )/( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee))) ELSE 0 END) ) else  0 end)) as numeric))), (sum(cash_hand_summary.amt_mgr)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_mgr) AS numeric ))), (sum(cash_hand_summary.amt_rake)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_rake) as numeric ))), (sum(( (CASE WHEN ( cash_hand_summary.amt_pot) <> 0 THEN ((cash_hand_player_statistics.amt_bet_ttl * 1.0 )/( cash_hand_summary.amt_pot)) ELSE 0 END) ) * cash_hand_summary.amt_rake)), (sum(CAST( ((case when(cash_hand_player_statistics.amt_bet_ttl > 0) then  cash_hand_player_statistics.val_curr_conv * ( (CASE WHEN ( cash_hand_summary.amt_pot) <> 0 THEN ((cash_hand_player_statistics.amt_bet_ttl * 1.0 )/( cash_hand_summary.amt_pot)) ELSE 0 END) ) * cash_hand_summary.amt_rake else  0 end)) AS numeric ))), (sum(cash_hand_player_statistics.amt_straddle)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_straddle)) AS numeric ))), (sum(cash_hand_player_statistics.amt_won)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_won) AS numeric ))), (sum((case when(cash_hand_player_statistics.amt_payout > 0) then  cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl else  cash_hand_player_statistics.amt_won end))), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * ((case when(cash_hand_player_statistics.amt_payout > 0) then  cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl else  cash_hand_player_statistics.amt_won end))) AS numeric ))), (sum((case when(cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_s OR cash_hand_player_statistics.flg_blind_db OR cash_hand_player_statistics.flg_blind_ds) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp AND ((cash_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp AND ((cash_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(F|XF)')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_bet and NOT(cash_hand_player_statistics.flg_p_face_raise) and cash_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_f_call )), (sum((case when(cash_hand_player_statistics.flg_f_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='C') then 1 else 0 end))), (sum((case when( not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND cash_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND cash_hand_player_statistics.flg_f_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND NOT (cash_hand_player_statistics.flg_t_saw) AND NOT (cash_hand_player_statistics.flg_f_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND (cash_hand_player_statistics.cnt_f_raise > 0 OR cash_hand_player_statistics.cnt_f_call > 0 OR cash_hand_player_statistics.flg_f_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND cash_hand_player_statistics.flg_f_bet AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND cash_hand_player_statistics.flg_f_bet AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'C') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT(cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action SIMILAR TO 'B_%' AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT(cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action = 'BF' AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND (cash_hand_player_statistics.flg_f_open_opp) AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND (cash_hand_player_statistics.flg_f_open_opp) AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when(cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and cash_hand_player_statistics.flg_f_has_position and cash_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XC') then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XF') then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XR') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position OR cash_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action LIKE 'B_%') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position OR cash_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_open_opp AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and cash_hand_player_statistics.flg_f_has_position and cash_hand_player_statistics.flg_f_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_open_opp and not(cash_hand_player_statistics.flg_p_face_raise) and cash_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_f_raise)), (sum((case when(cash_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand AND cash_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.id_hand > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(cash_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'C%') OR lookup_actions_p.action SIMILAR TO '(C|X)C%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(cash_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'F') OR lookup_actions_p.action SIMILAR TO '(C|X)F')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.enum_p_3bet_action = 'C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int > cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int < cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int > cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int < cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet_opp AND ((cash_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet_opp AND ((cash_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_player_statistics.flg_won_hand and not(cash_hand_player_statistics.flg_f_saw) and not(cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet AND ((cash_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet AND ((cash_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet and lookup_actions_p.action LIKE 'R%' and not(cash_hand_player_statistics.flg_p_first_raise) and not(cash_hand_player_statistics.flg_p_3bet)) then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_p_limp) and not(cash_hand_player_statistics.flg_p_open_opp) and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0 and (cash_hand_player_statistics.amt_p_3bet_facing > 0 or cash_hand_player_statistics.amt_p_4bet_facing > 0) and cash_hand_player_statistics.flg_p_4bet_opp ) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet AND cash_hand_player_statistics.enum_p_4bet_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet AND cash_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when( char_length(cash_hand_summary.str_aggressors_p) >= 4 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int != cash_hand_player_statistics.position AND cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 5 AND cash_hand_player_statistics.flg_p_4bet_def_opp AND cash_hand_player_statistics.enum_folded = 'P' AND (cash_hand_player_statistics.flg_p_4bet OR  NOT(((10 + cash_hand_player_statistics.position -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))  ), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 5 AND cash_hand_player_statistics.flg_p_4bet_def_opp AND (cash_hand_player_statistics.flg_p_4bet OR   NOT(((10 + cash_hand_player_statistics.position -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp and ((not cash_hand_player_statistics.flg_p_3bet_def_opp) OR (cash_hand_player_statistics.enum_p_3bet_action SIMILAR TO '(C|R)' AND cash_hand_player_statistics.flg_p_4bet_def_opp))) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9 AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='C' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='F' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_p_call )), (sum((case when(lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%' AND cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%' AND cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_ccall and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when( (cash_hand_player_statistics.enum_p_3bet_action = 'C' and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0) OR (cash_hand_player_statistics.amt_p_3bet_facing = 0 and cash_hand_player_statistics.enum_p_4bet_action = 'C' and not(cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when( (cash_hand_player_statistics.flg_p_3bet_def_opp and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0) or (cash_hand_player_statistics.amt_p_3bet_facing = 0 and cash_hand_player_statistics.flg_p_4bet_def_opp and not(cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_player_statistics.amt_blind = 0 and not(cash_hand_player_statistics.flg_p_limp)) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.cnt_p_face_limpers > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_fold) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%' and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%' and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CC%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND cash_hand_player_statistics.flg_p_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action = 'CF') then  1 else  0 end))), (sum((case when(((NOT cash_hand_player_statistics.flg_p_face_raise) OR (cash_hand_player_statistics.flg_p_limp) OR (cash_hand_player_statistics.flg_p_first_raise)) AND NOT (cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_db)) then 1 else 0 end))), (sum((case when( cash_hand_player_statistics.cnt_p_face_limpers > 0 AND NOT (cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_db)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CR%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.position = 0 and cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp AND ((cash_hand_summary.cnt_players between 4 and 6 and cash_hand_player_statistics.position between 3 and 5) OR (cash_hand_summary.cnt_players between 7 and 8 and cash_hand_player_statistics.position between 4 and 7) OR (cash_hand_summary.cnt_players between 9 and 10 and cash_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_p_raise )), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action = 'R' AND cash_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND NOT cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.position = 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND cash_hand_player_statistics.flg_p_open_opp and ((cash_hand_summary.cnt_players between 4 and 6 and cash_hand_player_statistics.position between 3 and 5) OR (cash_hand_summary.cnt_players between 7 and 8 and cash_hand_player_statistics.position between 4 and 7) OR (cash_hand_summary.cnt_players between 9 and 10 and cash_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_p_raise > 0) then  1 else  0 end))), (sum((case when( lookup_actions_p.action LIKE '__%' OR (lookup_actions_p.action LIKE '_' AND (cash_hand_player_statistics.amt_before > (cash_limit.amt_bb + cash_hand_player_statistics.amt_ante)) AND (cash_hand_player_statistics.amt_p_raise_facing < (cash_hand_player_statistics.amt_before - (cash_hand_player_statistics.amt_blind + cash_hand_player_statistics.amt_ante))) AND (cash_hand_player_statistics.flg_p_open_opp OR cash_hand_player_statistics.cnt_p_face_limpers > 0 OR cash_hand_player_statistics.flg_p_3bet_opp OR cash_hand_player_statistics.flg_p_4bet_opp) )) then  1 else  0 end))), (sum(cash_hand_summary.cnt_players)), (sum((case when(cash_hand_player_statistics.flg_p_open = false AND cash_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp AND ((cash_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp AND ((cash_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_r_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_r_call )), (sum((case when(cash_hand_player_statistics.cnt_r_call > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND cash_hand_player_statistics.flg_r_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND cash_hand_player_statistics.flg_r_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND lookup_actions_r.action LIKE 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND NOT(cash_hand_player_statistics.flg_r_face_raise) AND NOT(cash_hand_player_statistics.flg_showdown)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check AND (cash_hand_player_statistics.cnt_r_raise > 0 OR cash_hand_player_statistics.cnt_r_call > 0 OR cash_hand_player_statistics.flg_r_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp or cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.enum_r_donk_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='F') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='R') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_opp and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b)) AND (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND lookup_actions_r.action LIKE 'B_%' AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action = 'BF' AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b)) AND (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_r_raise)), (sum((case when(cash_hand_player_statistics.cnt_r_raise > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_r_raise > 0 AND cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp ) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att and cash_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp and cash_hand_summary.str_aggressors_p NOT LIKE '89%' AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F' AND cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp and cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_opp and cash_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND NOT (cash_hand_player_statistics.flg_f_saw) AND NOT (cash_hand_player_statistics.flg_p_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp AND ((cash_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp AND ((cash_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_t_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_t_call )), (sum((case when(cash_hand_player_statistics.flg_t_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND cash_hand_player_statistics.flg_t_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND cash_hand_player_statistics.flg_t_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND lookup_actions_t.action LIKE 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND NOT (cash_hand_player_statistics.flg_r_saw) AND NOT (cash_hand_player_statistics.flg_t_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check AND (cash_hand_player_statistics.cnt_t_raise > 0 OR cash_hand_player_statistics.cnt_t_call > 0 OR cash_hand_player_statistics.flg_t_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp or cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.enum_t_donk_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_opp and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_t_raise)), (sum((case when(cash_hand_player_statistics.cnt_t_raise > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_t_raise > 0 AND cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_b = false AND cash_hand_player_statistics.flg_blind_s AND cash_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = '') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.enum_allin<>'N') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown and cash_hand_player_statistics.amt_bet_ttl > 5 * cash_limit.amt_bb) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown and cash_hand_player_statistics.flg_won_hand and cash_hand_player_statistics.amt_bet_ttl > 5 * cash_limit.amt_bb) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_r_call > 0 AND cash_hand_player_statistics.flg_won_hand AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (cash_limit.limit_currency), (sum((case when( cash_hand_player_statistics.enum_allin='P' OR cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p' OR  cash_hand_player_statistics.enum_allin='F' OR cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f' OR  cash_hand_player_statistics.enum_allin='T' OR cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t' OR  cash_hand_player_statistics.enum_allin='R' OR cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r' ) then    ( (case when(cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND  cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND  cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) )   else  0 end))), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )) FROM	 cash_hand_player_statistics , cash_hand_summary, cash_limit, lookup_actions lookup_actions_f, lookup_actions lookup_actions_p, lookup_actions lookup_actions_r, lookup_actions lookup_actions_t, lookup_positions WHERE (cash_hand_summary.id_hand = cash_hand_player_statistics.id_hand AND cash_hand_summary.id_limit = cash_hand_player_statistics.id_limit)  AND (cash_limit.id_limit = cash_hand_player_statistics.id_limit)  AND (lookup_actions_f.id_action=cash_hand_player_statistics.id_action_f)  AND (lookup_actions_p.id_action=cash_hand_player_statistics.id_action_p)  AND (lookup_actions_r.id_action=cash_hand_player_statistics.id_action_r)  AND (lookup_actions_t.id_action=cash_hand_player_statistics.id_action_t)  AND (lookup_positions."position"=cash_hand_player_statistics."position" AND lookup_positions.cnt_players=cash_hand_player_statistics.cnt_players_lookup_position)  AND (cash_limit.id_limit = cash_hand_summary.id_limit)   AND ((cash_hand_player_statistics.id_player = $1))  AND ((CAST ( ((date_part('year',  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )) = ANY ($2))  GROUP BY cash_hand_player_statistics.id_player, cash_hand_player_statistics.id_gametype, cash_hand_player_statistics.id_limit, cash_hand_summary.cnt_players,  ((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)),  (cash_hand_player_statistics.flg_f_has_position),  (cash_hand_player_statistics.flg_t_has_position),  (cash_hand_player_statistics.flg_r_has_position),  (CAST ( ((date_part('year',  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )),  (cash_limit.limit_currency) 

  LOOP  
    <<insertCashPlayerDataToCache>>
    BEGIN
      INSERT INTO cash_cache VALUES(playerdata.id_player, playerdata.id_gametype, playerdata.id_limit, playerdata.cnt_players,playerdata.position_type::integer,playerdata.flg_has_position_f::boolean,playerdata.flg_has_position_t::boolean,playerdata.flg_has_position_r::boolean,playerdata.date_played_year_week::integer,playerdata.amt_bb_won::numeric(14,2),playerdata.amt_bb_won_inc_payout::numeric(14,2),playerdata.amt_blind::numeric(14,2),playerdata.amt_blind_curr_conv::numeric(14,2),playerdata.amt_expected_bb_won::numeric(14,2),playerdata.amt_expected_won::numeric(14,2),playerdata.amt_expected_won_curr_conv::numeric(14,2),playerdata.amt_jackpot_taken::numeric(14,2),playerdata.amt_jackpot_taken_curr_conv::numeric(14,2),playerdata.amt_payout::numeric(14,2),playerdata.amt_payout_curr_conv::numeric(14,2),playerdata.amt_payout_fee::numeric(14,2),playerdata.amt_payout_fee_curr_conv::numeric(14,2),playerdata.amt_r_call::numeric(14,2),playerdata.amt_r_call_won::numeric(14,2),playerdata.amt_rake_attributed::numeric(14,2),playerdata.amt_rake_attributed_curr_conv::numeric(14,2),playerdata.amt_rake_share::numeric(14,2),playerdata.amt_rake_share_curr_conv::numeric(14,2),playerdata.amt_rake_taken::numeric(14,2),playerdata.amt_rake_taken_curr_conv::numeric(14,2),playerdata.amt_rake_weighted_contributed::numeric(14,2),playerdata.amt_rake_weighted_contributed_curr_conv::numeric(14,2),playerdata.amt_straddle::numeric(14,2),playerdata.amt_straddle_curr_conv::numeric(14,2),playerdata.amt_won::numeric(14,2),playerdata.amt_won_curr_conv::numeric(14,2),playerdata.amt_won_inc_payout::numeric(14,2),playerdata.amt_won_inc_payout_curr_conv::numeric(14,2),playerdata.cnt_blind::integer,playerdata.cnt_f_2bet_def_action_call::integer,playerdata.cnt_f_2bet_def_action_fold::integer,playerdata.cnt_f_3bet::integer,playerdata.cnt_f_3bet_def_action_call::integer,playerdata.cnt_f_3bet_def_action_fold::integer,playerdata.cnt_f_3bet_def_opp::integer,playerdata.cnt_f_3bet_opp::integer,playerdata.cnt_f_4bet::integer,playerdata.cnt_f_4bet_def_action_call::integer,playerdata.cnt_f_4bet_def_action_fold::integer,playerdata.cnt_f_4bet_def_opp::integer,playerdata.cnt_f_4bet_opp::integer,playerdata.cnt_f_allin::integer,playerdata.cnt_f_allin_valid::integer,playerdata.cnt_f_bet::integer,playerdata.cnt_f_bet_def_action_call::integer,playerdata.cnt_f_bet_def_action_fold::integer,playerdata.cnt_f_bet_def_action_raise::integer,playerdata.cnt_f_bet_def_opp::integer,playerdata.cnt_f_bet_limp_pot::integer,playerdata.cnt_f_call::integer,playerdata.cnt_f_cbet::integer,playerdata.cnt_f_cbet_3bet_pot::integer,playerdata.cnt_f_cbet_def_action_call::integer,playerdata.cnt_f_cbet_def_action_call_in_pos::integer,playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_fold::integer,playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_raise::integer,playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,playerdata.cnt_f_cbet_def_opp::integer,playerdata.cnt_f_cbet_face_raise::integer,playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,playerdata.cnt_f_cbet_fold_to_raise::integer,playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_f_cbet_opp::integer,playerdata.cnt_f_cbet_opp_3bet_pot::integer,playerdata.cnt_f_cbet_success::integer,playerdata.cnt_f_check::integer,playerdata.cnt_f_check_raise::integer,playerdata.cnt_f_check_raise_opp::integer,playerdata.cnt_f_donk::integer,playerdata.cnt_f_donk_3bet_pot::integer,playerdata.cnt_f_donk_def_opp::integer,playerdata.cnt_f_donk_def_opp_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_call::integer,playerdata.cnt_f_donk_def_opp_action_fold::integer,playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_raise::integer,playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,playerdata.cnt_f_donk_face_raise::integer,playerdata.cnt_f_donk_fold::integer,playerdata.cnt_f_donk_opp::integer,playerdata.cnt_f_donk_opp_3bet_pot::integer,playerdata.cnt_f_face_xr::integer,playerdata.cnt_f_face_xr_call::integer,playerdata.cnt_f_face_xr_fold::integer,playerdata.cnt_f_face_xr_raise::integer,playerdata.cnt_f_float::integer,playerdata.cnt_f_float_3bet_pot::integer,playerdata.cnt_f_float_def_opp::integer,playerdata.cnt_f_float_def_opp_action_call::integer,playerdata.cnt_f_float_def_opp_action_fold::integer,playerdata.cnt_f_float_def_opp_action_raise::integer,playerdata.cnt_f_float_face_raise::integer,playerdata.cnt_f_float_fold::integer,playerdata.cnt_f_float_opp::integer,playerdata.cnt_f_float_opp_3bet_pot::integer,playerdata.cnt_f_fold::integer,playerdata.cnt_f_open_opp_limp_pot::integer,playerdata.cnt_f_raise::integer,playerdata.cnt_f_raise_def_opp::integer,playerdata.cnt_f_saw::integer,playerdata.cnt_f_saw_won::integer,playerdata.cnt_hands::integer,playerdata.cnt_hands_won::integer,playerdata.cnt_p_2bet_def_action_call::integer,playerdata.cnt_p_2bet_def_action_fold::integer,playerdata.cnt_p_2bet_def_opp::integer,playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,playerdata.cnt_p_3bet::integer,playerdata.cnt_p_3bet_def_action_call::integer,playerdata.cnt_p_3bet_def_action_call_after_2b::integer,playerdata.cnt_p_3bet_def_action_fold::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,playerdata.cnt_p_3bet_def_opp::integer,playerdata.cnt_p_3bet_def_opp_after_2b::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_f_cbet_def_opp::integer,playerdata.cnt_p_3bet_opp::integer,playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_open::integer,playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,playerdata.cnt_p_3bet_opp_vs_co_open::integer,playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_r_cbet_def_opp::integer,playerdata.cnt_p_3bet_success::integer,playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_t_cbet_def_opp::integer,playerdata.cnt_p_3bet_vs_bb_2bet::integer,playerdata.cnt_p_3bet_vs_btn_2bet::integer,playerdata.cnt_p_3bet_vs_btn_open::integer,playerdata.cnt_p_3bet_vs_co_2bet::integer,playerdata.cnt_p_3bet_vs_co_open::integer,playerdata.cnt_p_3bet_vs_ep_2bet::integer,playerdata.cnt_p_3bet_vs_mp_2bet::integer,playerdata.cnt_p_3bet_vs_sb_2bet::integer,playerdata.cnt_p_4bet::integer,playerdata.cnt_p_4bet_after_raising::integer,playerdata.cnt_p_4bet_cold::integer,playerdata.cnt_p_4bet_cold_opp::integer,playerdata.cnt_p_4bet_def_action_call::integer,playerdata.cnt_p_4bet_def_action_fold::integer,playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,playerdata.cnt_p_4bet_def_opp::integer,playerdata.cnt_p_4bet_def_opp_after_3b::integer,playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,playerdata.cnt_p_4bet_opp::integer,playerdata.cnt_p_4bet_opp_when_open_raised::integer,playerdata.cnt_p_5bet::integer,playerdata.cnt_p_5bet_def_action_fold::integer,playerdata.cnt_p_5bet_def_opp::integer,playerdata.cnt_p_5bet_opp::integer,playerdata.cnt_p_allin::integer,playerdata.cnt_p_allin_valid::integer,playerdata.cnt_p_bb_v_sb_3bet::integer,playerdata.cnt_p_bb_v_sb_3bet_opp::integer,playerdata.cnt_p_bb_v_sb_call::integer,playerdata.cnt_p_bb_v_sb_fold::integer,playerdata.cnt_p_call::integer,playerdata.cnt_p_call_vs_btn_open::integer,playerdata.cnt_p_call_vs_co_open::integer,playerdata.cnt_p_ccall::integer,playerdata.cnt_p_ccall_3bet::integer,playerdata.cnt_p_ccall_3bet_opp::integer,playerdata.cnt_p_ccall_opp::integer,playerdata.cnt_p_facing_limpers::integer,playerdata.cnt_p_fold::integer,playerdata.cnt_p_fold_vs_btn_open::integer,playerdata.cnt_p_fold_vs_co_open::integer,playerdata.cnt_p_limp::integer,playerdata.cnt_p_limp_call::integer,playerdata.cnt_p_limp_faceraise::integer,playerdata.cnt_p_limp_fold::integer,playerdata.cnt_p_limp_opp::integer,playerdata.cnt_p_limp_opp_facing_limpers::integer,playerdata.cnt_p_limp_raise::integer,playerdata.cnt_p_open_opp::integer,playerdata.cnt_p_open_opp_btn::integer,playerdata.cnt_p_open_opp_ep::integer,playerdata.cnt_p_raise::integer,playerdata.cnt_p_raise_3bet::integer,playerdata.cnt_p_raise_first_in::integer,playerdata.cnt_p_raise_limpers::integer,playerdata.cnt_p_rfi_btn::integer,playerdata.cnt_p_rfi_ep::integer,playerdata.cnt_p_squeeze::integer,playerdata.cnt_p_squeeze_def_call::integer,playerdata.cnt_p_squeeze_def_fold::integer,playerdata.cnt_p_squeeze_def_opp::integer,playerdata.cnt_p_squeeze_def_raise::integer,playerdata.cnt_p_squeeze_opp::integer,playerdata.cnt_pfr::integer,playerdata.cnt_pfr_opp::integer,playerdata.cnt_players_ttl::integer,playerdata.cnt_prev_callers_limp::integer,playerdata.cnt_r_2bet_def_action_call::integer,playerdata.cnt_r_2bet_def_action_fold::integer,playerdata.cnt_r_3bet::integer,playerdata.cnt_r_3bet_def_action_call::integer,playerdata.cnt_r_3bet_def_action_fold::integer,playerdata.cnt_r_3bet_def_opp::integer,playerdata.cnt_r_3bet_opp::integer,playerdata.cnt_r_4bet::integer,playerdata.cnt_r_4bet_def_action_call::integer,playerdata.cnt_r_4bet_def_action_fold::integer,playerdata.cnt_r_4bet_def_opp::integer,playerdata.cnt_r_4bet_opp::integer,playerdata.cnt_r_allin::integer,playerdata.cnt_r_allin_valid::integer,playerdata.cnt_r_bet::integer,playerdata.cnt_r_bet_def_action_call::integer,playerdata.cnt_r_bet_def_action_fold::integer,playerdata.cnt_r_bet_def_action_raise::integer,playerdata.cnt_r_bet_def_opp::integer,playerdata.cnt_r_call::integer,playerdata.cnt_r_call_hands::integer,playerdata.cnt_r_cbet::integer,playerdata.cnt_r_cbet_3bet_pot::integer,playerdata.cnt_r_cbet_def_action_call::integer,playerdata.cnt_r_cbet_def_action_fold::integer,playerdata.cnt_r_cbet_def_action_raise::integer,playerdata.cnt_r_cbet_def_opp::integer,playerdata.cnt_r_cbet_face_raise::integer,playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,playerdata.cnt_r_cbet_fold_to_raise::integer,playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_r_cbet_opp::integer,playerdata.cnt_r_cbet_opp_3bet_pot::integer,playerdata.cnt_r_cbet_success::integer,playerdata.cnt_r_check::integer,playerdata.cnt_r_check_raise::integer,playerdata.cnt_r_check_raise_opp::integer,playerdata.cnt_r_donk::integer,playerdata.cnt_r_donk_3bet_pot::integer,playerdata.cnt_r_donk_def_action_call::integer,playerdata.cnt_r_donk_def_action_fold::integer,playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_r_donk_def_action_raise::integer,playerdata.cnt_r_donk_def_opp::integer,playerdata.cnt_r_donk_def_opp_3bet_pot::integer,playerdata.cnt_r_donk_face_raise::integer,playerdata.cnt_r_donk_fold::integer,playerdata.cnt_r_donk_opp::integer,playerdata.cnt_r_donk_opp_3bet_pot::integer,playerdata.cnt_r_face_xr::integer,playerdata.cnt_r_face_xr_call::integer,playerdata.cnt_r_face_xr_fold::integer,playerdata.cnt_r_face_xr_raise::integer,playerdata.cnt_r_float::integer,playerdata.cnt_r_float_3bet_pot::integer,playerdata.cnt_r_float_def_action_call::integer,playerdata.cnt_r_float_def_action_fold::integer,playerdata.cnt_r_float_def_action_raise::integer,playerdata.cnt_r_float_def_opp::integer,playerdata.cnt_r_float_face_raise::integer,playerdata.cnt_r_float_fold::integer,playerdata.cnt_r_float_opp::integer,playerdata.cnt_r_float_opp_3bet_pot::integer,playerdata.cnt_r_fold::integer,playerdata.cnt_r_probe::integer,playerdata.cnt_r_probe_3bet_pot::integer,playerdata.cnt_r_probe_def_action_call::integer,playerdata.cnt_r_probe_def_action_fold::integer,playerdata.cnt_r_probe_def_action_raise::integer,playerdata.cnt_r_probe_def_opp::integer,playerdata.cnt_r_probe_face_raise::integer,playerdata.cnt_r_probe_fold::integer,playerdata.cnt_r_probe_opp::integer,playerdata.cnt_r_probe_opp_3bet_pot::integer,playerdata.cnt_r_raise::integer,playerdata.cnt_r_raise_wtsd::integer,playerdata.cnt_r_raise_wtsd_won::integer,playerdata.cnt_r_saw::integer,playerdata.cnt_steal_3bet_def_action_fold::integer,playerdata.cnt_steal_3bet_def_opp::integer,playerdata.cnt_steal_att::integer,playerdata.cnt_steal_att_lp::integer,playerdata.cnt_steal_att_sb::integer,playerdata.cnt_steal_def_3bet_opp::integer,playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,playerdata.cnt_steal_def_action_call::integer,playerdata.cnt_steal_def_action_call_vs_lp::integer,playerdata.cnt_steal_def_action_fold::integer,playerdata.cnt_steal_def_action_fold_vs_lp::integer,playerdata.cnt_steal_def_action_raise::integer,playerdata.cnt_steal_def_action_raise_vs_lp::integer,playerdata.cnt_steal_def_opp::integer,playerdata.cnt_steal_def_opp_vs_lp::integer,playerdata.cnt_steal_opp::integer,playerdata.cnt_steal_opp_lp::integer,playerdata.cnt_steal_opp_sb::integer,playerdata.cnt_steal_reraise_def_action_fold::integer,playerdata.cnt_steal_reraise_def_opp::integer,playerdata.cnt_steal_success::integer,playerdata.cnt_t_2bet_def_action_call::integer,playerdata.cnt_t_2bet_def_action_fold::integer,playerdata.cnt_t_3bet::integer,playerdata.cnt_t_3bet_def_action_call::integer,playerdata.cnt_t_3bet_def_action_fold::integer,playerdata.cnt_t_3bet_def_opp::integer,playerdata.cnt_t_3bet_opp::integer,playerdata.cnt_t_4bet::integer,playerdata.cnt_t_4bet_def_action_call::integer,playerdata.cnt_t_4bet_def_action_fold::integer,playerdata.cnt_t_4bet_def_opp::integer,playerdata.cnt_t_4bet_opp::integer,playerdata.cnt_t_allin::integer,playerdata.cnt_t_allin_valid::integer,playerdata.cnt_t_bet::integer,playerdata.cnt_t_bet_def_action_call::integer,playerdata.cnt_t_bet_def_action_fold::integer,playerdata.cnt_t_bet_def_action_raise::integer,playerdata.cnt_t_bet_def_opp::integer,playerdata.cnt_t_call::integer,playerdata.cnt_t_cbet::integer,playerdata.cnt_t_cbet_3bet_pot::integer,playerdata.cnt_t_cbet_def_action_call::integer,playerdata.cnt_t_cbet_def_action_fold::integer,playerdata.cnt_t_cbet_def_action_raise::integer,playerdata.cnt_t_cbet_def_opp::integer,playerdata.cnt_t_cbet_face_raise::integer,playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,playerdata.cnt_t_cbet_fold_to_raise::integer,playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_t_cbet_opp::integer,playerdata.cnt_t_cbet_opp_3bet_pot::integer,playerdata.cnt_t_cbet_success::integer,playerdata.cnt_t_check::integer,playerdata.cnt_t_check_raise::integer,playerdata.cnt_t_check_raise_opp::integer,playerdata.cnt_t_donk::integer,playerdata.cnt_t_donk_3bet_pot::integer,playerdata.cnt_t_donk_def_action_call::integer,playerdata.cnt_t_donk_def_action_fold::integer,playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_t_donk_def_action_raise::integer,playerdata.cnt_t_donk_def_opp::integer,playerdata.cnt_t_donk_def_opp_3bet_pot::integer,playerdata.cnt_t_donk_face_raise::integer,playerdata.cnt_t_donk_fold::integer,playerdata.cnt_t_donk_opp::integer,playerdata.cnt_t_donk_opp_3bet_pot::integer,playerdata.cnt_t_face_xr::integer,playerdata.cnt_t_face_xr_call::integer,playerdata.cnt_t_face_xr_fold::integer,playerdata.cnt_t_face_xr_raise::integer,playerdata.cnt_t_float::integer,playerdata.cnt_t_float_3bet_pot::integer,playerdata.cnt_t_float_def_action_call::integer,playerdata.cnt_t_float_def_action_fold::integer,playerdata.cnt_t_float_def_action_raise::integer,playerdata.cnt_t_float_def_opp::integer,playerdata.cnt_t_float_face_raise::integer,playerdata.cnt_t_float_fold::integer,playerdata.cnt_t_float_opp::integer,playerdata.cnt_t_float_opp_3bet_pot::integer,playerdata.cnt_t_fold::integer,playerdata.cnt_t_probe::integer,playerdata.cnt_t_probe_3bet_pot::integer,playerdata.cnt_t_probe_def_action_call::integer,playerdata.cnt_t_probe_def_action_fold::integer,playerdata.cnt_t_probe_def_action_raise::integer,playerdata.cnt_t_probe_def_opp::integer,playerdata.cnt_t_probe_face_raise::integer,playerdata.cnt_t_probe_fold::integer,playerdata.cnt_t_probe_opp::integer,playerdata.cnt_t_probe_opp_3bet_pot::integer,playerdata.cnt_t_raise::integer,playerdata.cnt_t_raise_wtsd::integer,playerdata.cnt_t_raise_wtsd_won::integer,playerdata.cnt_t_saw::integer,playerdata.cnt_vpip::integer,playerdata.cnt_vpip_sb::integer,playerdata.cnt_walks::integer,playerdata.cnt_won_hand::integer,playerdata.cnt_wtsd::integer,playerdata.cnt_wtsd_allin::integer,playerdata.cnt_wtsd_non_small::integer,playerdata.cnt_wtsd_won::integer,playerdata.cnt_wtsd_won_non_small::integer,playerdata.cnt_wtsd_won_when_r_call::integer,playerdata.limit_currency::text,playerdata.val_equity::numeric(14,2),playerdata.val_f_equity::numeric(14,2),playerdata.val_p_equity::numeric(14,2),playerdata.val_r_equity::numeric(14,2),playerdata.val_t_equity::numeric(14,2));
      CONTINUE;
    END insertCashPlayerDataToCache;
    
  END LOOP getCashPlayersDataToCache;
  
  RETURN;
END;
$_$;


ALTER FUNCTION public.update_cash_cache_date(integer, integer[]) OWNER TO %USERNAME%;

--
-- TOC entry 210 (class 1255 OID 17390)
-- Name: update_cash_cache_player(integer); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_cash_cache_player(integer) RETURNS void
    LANGUAGE plpgsql
    AS $_$

DECLARE
  playerdata cash_cache%ROWTYPE;

BEGIN
  <<deletePlayersCache>>
  BEGIN
    DELETE FROM cash_cache WHERE id_player = $1;
  END deletePlayersCache;

  <<getCashPlayersDataToCache>>
  FOR playerdata IN 
    SELECT cash_hand_player_statistics.id_player, cash_hand_player_statistics.id_gametype, cash_hand_player_statistics.id_limit, cash_hand_summary.cnt_players,((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)), (cash_hand_player_statistics.flg_f_has_position), (cash_hand_player_statistics.flg_t_has_position), (cash_hand_player_statistics.flg_r_has_position), (CAST ( ((date_part('year',  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN ((cash_hand_player_statistics.amt_won * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN (((case when(cash_hand_player_statistics.amt_payout > 0) then (cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl) else  cash_hand_player_statistics.amt_won end) * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum(cash_hand_player_statistics.amt_blind)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_blind) as numeric) )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN ((cash_hand_player_statistics.amt_expected_won * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum(cash_hand_player_statistics.amt_expected_won)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_expected_won) as numeric ))), (sum(cash_hand_summary.amt_jackpot_fee)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_jackpot_fee) as numeric ))), (sum(cash_hand_player_statistics.amt_payout)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_payout)) AS numeric ))), (sum(cash_hand_player_statistics.amt_payout_fee)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_payout_fee)) AS numeric ))), (sum( (case when( cash_hand_player_statistics.cnt_r_call > 0 AND (cash_hand_player_statistics.amt_r_bet_made + cash_hand_player_statistics.amt_r_raise_made) = 0) then  cash_hand_player_statistics.amt_bet_r else  0  end))), (sum( (case when( cash_hand_player_statistics.cnt_r_call > 0 AND (cash_hand_player_statistics.amt_r_bet_made + cash_hand_player_statistics.amt_r_raise_made) = 0 AND cash_hand_player_statistics.flg_won_hand) then  cash_hand_player_statistics.amt_won + cash_hand_player_statistics.amt_bet_ttl else  0  end))), (sum(cash_hand_summary.amt_rake * ( (CASE WHEN ( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee)) <> 0 THEN (( (cash_hand_player_statistics.amt_won +  cash_hand_player_statistics.amt_bet_ttl)  * 1.0 )/( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee))) ELSE 0 END) ))), (sum(CAST( ((case when(cash_hand_player_statistics.flg_won_hand) then  cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_rake * ( (CASE WHEN ( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee)) <> 0 THEN (( (cash_hand_player_statistics.amt_won + cash_hand_player_statistics.amt_bet_ttl)  * 1.0 )/( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee))) ELSE 0 END) ) else  0 end)) as numeric))), (sum(cash_hand_summary.amt_mgr)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_mgr) AS numeric ))), (sum(cash_hand_summary.amt_rake)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_rake) as numeric ))), (sum(( (CASE WHEN ( cash_hand_summary.amt_pot) <> 0 THEN ((cash_hand_player_statistics.amt_bet_ttl * 1.0 )/( cash_hand_summary.amt_pot)) ELSE 0 END) ) * cash_hand_summary.amt_rake)), (sum(CAST( ((case when(cash_hand_player_statistics.amt_bet_ttl > 0) then  cash_hand_player_statistics.val_curr_conv * ( (CASE WHEN ( cash_hand_summary.amt_pot) <> 0 THEN ((cash_hand_player_statistics.amt_bet_ttl * 1.0 )/( cash_hand_summary.amt_pot)) ELSE 0 END) ) * cash_hand_summary.amt_rake else  0 end)) AS numeric ))), (sum(cash_hand_player_statistics.amt_straddle)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_straddle)) AS numeric ))), (sum(cash_hand_player_statistics.amt_won)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_won) AS numeric ))), (sum((case when(cash_hand_player_statistics.amt_payout > 0) then  cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl else  cash_hand_player_statistics.amt_won end))), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * ((case when(cash_hand_player_statistics.amt_payout > 0) then  cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl else  cash_hand_player_statistics.amt_won end))) AS numeric ))), (sum((case when(cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_s OR cash_hand_player_statistics.flg_blind_db OR cash_hand_player_statistics.flg_blind_ds) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp AND ((cash_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp AND ((cash_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(F|XF)')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_bet and NOT(cash_hand_player_statistics.flg_p_face_raise) and cash_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_f_call )), (sum((case when(cash_hand_player_statistics.flg_f_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='C') then 1 else 0 end))), (sum((case when( not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND cash_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND cash_hand_player_statistics.flg_f_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND NOT (cash_hand_player_statistics.flg_t_saw) AND NOT (cash_hand_player_statistics.flg_f_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND (cash_hand_player_statistics.cnt_f_raise > 0 OR cash_hand_player_statistics.cnt_f_call > 0 OR cash_hand_player_statistics.flg_f_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND cash_hand_player_statistics.flg_f_bet AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND cash_hand_player_statistics.flg_f_bet AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'C') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT(cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action SIMILAR TO 'B_%' AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT(cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action = 'BF' AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND (cash_hand_player_statistics.flg_f_open_opp) AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND (cash_hand_player_statistics.flg_f_open_opp) AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when(cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and cash_hand_player_statistics.flg_f_has_position and cash_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XC') then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XF') then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XR') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position OR cash_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action LIKE 'B_%') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position OR cash_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_open_opp AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and cash_hand_player_statistics.flg_f_has_position and cash_hand_player_statistics.flg_f_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_open_opp and not(cash_hand_player_statistics.flg_p_face_raise) and cash_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_f_raise)), (sum((case when(cash_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand AND cash_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.id_hand > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(cash_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'C%') OR lookup_actions_p.action SIMILAR TO '(C|X)C%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(cash_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'F') OR lookup_actions_p.action SIMILAR TO '(C|X)F')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.enum_p_3bet_action = 'C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int > cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int < cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int > cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int < cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet_opp AND ((cash_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet_opp AND ((cash_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_player_statistics.flg_won_hand and not(cash_hand_player_statistics.flg_f_saw) and not(cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet AND ((cash_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet AND ((cash_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet and lookup_actions_p.action LIKE 'R%' and not(cash_hand_player_statistics.flg_p_first_raise) and not(cash_hand_player_statistics.flg_p_3bet)) then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_p_limp) and not(cash_hand_player_statistics.flg_p_open_opp) and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0 and (cash_hand_player_statistics.amt_p_3bet_facing > 0 or cash_hand_player_statistics.amt_p_4bet_facing > 0) and cash_hand_player_statistics.flg_p_4bet_opp ) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet AND cash_hand_player_statistics.enum_p_4bet_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet AND cash_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when( char_length(cash_hand_summary.str_aggressors_p) >= 4 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int != cash_hand_player_statistics.position AND cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 5 AND cash_hand_player_statistics.flg_p_4bet_def_opp AND cash_hand_player_statistics.enum_folded = 'P' AND (cash_hand_player_statistics.flg_p_4bet OR  NOT(((10 + cash_hand_player_statistics.position -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))  ), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 5 AND cash_hand_player_statistics.flg_p_4bet_def_opp AND (cash_hand_player_statistics.flg_p_4bet OR   NOT(((10 + cash_hand_player_statistics.position -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp and ((not cash_hand_player_statistics.flg_p_3bet_def_opp) OR (cash_hand_player_statistics.enum_p_3bet_action SIMILAR TO '(C|R)' AND cash_hand_player_statistics.flg_p_4bet_def_opp))) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9 AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='C' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='F' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_p_call )), (sum((case when(lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%' AND cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%' AND cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_ccall and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when( (cash_hand_player_statistics.enum_p_3bet_action = 'C' and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0) OR (cash_hand_player_statistics.amt_p_3bet_facing = 0 and cash_hand_player_statistics.enum_p_4bet_action = 'C' and not(cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when( (cash_hand_player_statistics.flg_p_3bet_def_opp and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0) or (cash_hand_player_statistics.amt_p_3bet_facing = 0 and cash_hand_player_statistics.flg_p_4bet_def_opp and not(cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_player_statistics.amt_blind = 0 and not(cash_hand_player_statistics.flg_p_limp)) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.cnt_p_face_limpers > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_fold) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%' and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%' and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CC%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND cash_hand_player_statistics.flg_p_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action = 'CF') then  1 else  0 end))), (sum((case when(((NOT cash_hand_player_statistics.flg_p_face_raise) OR (cash_hand_player_statistics.flg_p_limp) OR (cash_hand_player_statistics.flg_p_first_raise)) AND NOT (cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_db)) then 1 else 0 end))), (sum((case when( cash_hand_player_statistics.cnt_p_face_limpers > 0 AND NOT (cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_db)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CR%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.position = 0 and cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp AND ((cash_hand_summary.cnt_players between 4 and 6 and cash_hand_player_statistics.position between 3 and 5) OR (cash_hand_summary.cnt_players between 7 and 8 and cash_hand_player_statistics.position between 4 and 7) OR (cash_hand_summary.cnt_players between 9 and 10 and cash_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_p_raise )), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action = 'R' AND cash_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND NOT cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.position = 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND cash_hand_player_statistics.flg_p_open_opp and ((cash_hand_summary.cnt_players between 4 and 6 and cash_hand_player_statistics.position between 3 and 5) OR (cash_hand_summary.cnt_players between 7 and 8 and cash_hand_player_statistics.position between 4 and 7) OR (cash_hand_summary.cnt_players between 9 and 10 and cash_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_p_raise > 0) then  1 else  0 end))), (sum((case when( lookup_actions_p.action LIKE '__%' OR (lookup_actions_p.action LIKE '_' AND (cash_hand_player_statistics.amt_before > (cash_limit.amt_bb + cash_hand_player_statistics.amt_ante)) AND (cash_hand_player_statistics.amt_p_raise_facing < (cash_hand_player_statistics.amt_before - (cash_hand_player_statistics.amt_blind + cash_hand_player_statistics.amt_ante))) AND (cash_hand_player_statistics.flg_p_open_opp OR cash_hand_player_statistics.cnt_p_face_limpers > 0 OR cash_hand_player_statistics.flg_p_3bet_opp OR cash_hand_player_statistics.flg_p_4bet_opp) )) then  1 else  0 end))), (sum(cash_hand_summary.cnt_players)), (sum((case when(cash_hand_player_statistics.flg_p_open = false AND cash_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp AND ((cash_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp AND ((cash_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_r_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_r_call )), (sum((case when(cash_hand_player_statistics.cnt_r_call > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND cash_hand_player_statistics.flg_r_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND cash_hand_player_statistics.flg_r_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND lookup_actions_r.action LIKE 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND NOT(cash_hand_player_statistics.flg_r_face_raise) AND NOT(cash_hand_player_statistics.flg_showdown)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check AND (cash_hand_player_statistics.cnt_r_raise > 0 OR cash_hand_player_statistics.cnt_r_call > 0 OR cash_hand_player_statistics.flg_r_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp or cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.enum_r_donk_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='F') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='R') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_opp and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b)) AND (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND lookup_actions_r.action LIKE 'B_%' AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action = 'BF' AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b)) AND (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_r_raise)), (sum((case when(cash_hand_player_statistics.cnt_r_raise > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_r_raise > 0 AND cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp ) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att and cash_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp and cash_hand_summary.str_aggressors_p NOT LIKE '89%' AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F' AND cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp and cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_opp and cash_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND NOT (cash_hand_player_statistics.flg_f_saw) AND NOT (cash_hand_player_statistics.flg_p_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp AND ((cash_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp AND ((cash_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_t_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_t_call )), (sum((case when(cash_hand_player_statistics.flg_t_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND cash_hand_player_statistics.flg_t_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND cash_hand_player_statistics.flg_t_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND lookup_actions_t.action LIKE 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND NOT (cash_hand_player_statistics.flg_r_saw) AND NOT (cash_hand_player_statistics.flg_t_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check AND (cash_hand_player_statistics.cnt_t_raise > 0 OR cash_hand_player_statistics.cnt_t_call > 0 OR cash_hand_player_statistics.flg_t_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp or cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.enum_t_donk_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_opp and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_t_raise)), (sum((case when(cash_hand_player_statistics.cnt_t_raise > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_t_raise > 0 AND cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_b = false AND cash_hand_player_statistics.flg_blind_s AND cash_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = '') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.enum_allin<>'N') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown and cash_hand_player_statistics.amt_bet_ttl > 5 * cash_limit.amt_bb) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown and cash_hand_player_statistics.flg_won_hand and cash_hand_player_statistics.amt_bet_ttl > 5 * cash_limit.amt_bb) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_r_call > 0 AND cash_hand_player_statistics.flg_won_hand AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (cash_limit.limit_currency), (sum((case when( cash_hand_player_statistics.enum_allin='P' OR cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p' OR  cash_hand_player_statistics.enum_allin='F' OR cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f' OR  cash_hand_player_statistics.enum_allin='T' OR cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t' OR  cash_hand_player_statistics.enum_allin='R' OR cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r' ) then    ( (case when(cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND  cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND  cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) )   else  0 end))), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )) FROM	 cash_hand_player_statistics , cash_hand_summary, cash_limit, lookup_actions lookup_actions_f, lookup_actions lookup_actions_p, lookup_actions lookup_actions_r, lookup_actions lookup_actions_t, lookup_positions WHERE (cash_hand_summary.id_hand = cash_hand_player_statistics.id_hand AND cash_hand_summary.id_limit = cash_hand_player_statistics.id_limit)  AND (cash_limit.id_limit = cash_hand_player_statistics.id_limit)  AND (lookup_actions_f.id_action=cash_hand_player_statistics.id_action_f)  AND (lookup_actions_p.id_action=cash_hand_player_statistics.id_action_p)  AND (lookup_actions_r.id_action=cash_hand_player_statistics.id_action_r)  AND (lookup_actions_t.id_action=cash_hand_player_statistics.id_action_t)  AND (lookup_positions."position"=cash_hand_player_statistics."position" AND lookup_positions.cnt_players=cash_hand_player_statistics.cnt_players_lookup_position)  AND (cash_limit.id_limit = cash_hand_summary.id_limit)   AND ((cash_hand_player_statistics.id_player = $1))  GROUP BY cash_hand_player_statistics.id_player, cash_hand_player_statistics.id_gametype, cash_hand_player_statistics.id_limit, cash_hand_summary.cnt_players,  ((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)),  (cash_hand_player_statistics.flg_f_has_position),  (cash_hand_player_statistics.flg_t_has_position),  (cash_hand_player_statistics.flg_r_has_position),  (CAST ( ((date_part('year',  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )),  (cash_limit.limit_currency) 

  LOOP  
    <<insertCashPlayerDataToCache>>
    BEGIN
      INSERT INTO cash_cache VALUES(playerdata.id_player, playerdata.id_gametype, playerdata.id_limit, playerdata.cnt_players,playerdata.position_type::integer,playerdata.flg_has_position_f::boolean,playerdata.flg_has_position_t::boolean,playerdata.flg_has_position_r::boolean,playerdata.date_played_year_week::integer,playerdata.amt_bb_won::numeric(14,2),playerdata.amt_bb_won_inc_payout::numeric(14,2),playerdata.amt_blind::numeric(14,2),playerdata.amt_blind_curr_conv::numeric(14,2),playerdata.amt_expected_bb_won::numeric(14,2),playerdata.amt_expected_won::numeric(14,2),playerdata.amt_expected_won_curr_conv::numeric(14,2),playerdata.amt_jackpot_taken::numeric(14,2),playerdata.amt_jackpot_taken_curr_conv::numeric(14,2),playerdata.amt_payout::numeric(14,2),playerdata.amt_payout_curr_conv::numeric(14,2),playerdata.amt_payout_fee::numeric(14,2),playerdata.amt_payout_fee_curr_conv::numeric(14,2),playerdata.amt_r_call::numeric(14,2),playerdata.amt_r_call_won::numeric(14,2),playerdata.amt_rake_attributed::numeric(14,2),playerdata.amt_rake_attributed_curr_conv::numeric(14,2),playerdata.amt_rake_share::numeric(14,2),playerdata.amt_rake_share_curr_conv::numeric(14,2),playerdata.amt_rake_taken::numeric(14,2),playerdata.amt_rake_taken_curr_conv::numeric(14,2),playerdata.amt_rake_weighted_contributed::numeric(14,2),playerdata.amt_rake_weighted_contributed_curr_conv::numeric(14,2),playerdata.amt_straddle::numeric(14,2),playerdata.amt_straddle_curr_conv::numeric(14,2),playerdata.amt_won::numeric(14,2),playerdata.amt_won_curr_conv::numeric(14,2),playerdata.amt_won_inc_payout::numeric(14,2),playerdata.amt_won_inc_payout_curr_conv::numeric(14,2),playerdata.cnt_blind::integer,playerdata.cnt_f_2bet_def_action_call::integer,playerdata.cnt_f_2bet_def_action_fold::integer,playerdata.cnt_f_3bet::integer,playerdata.cnt_f_3bet_def_action_call::integer,playerdata.cnt_f_3bet_def_action_fold::integer,playerdata.cnt_f_3bet_def_opp::integer,playerdata.cnt_f_3bet_opp::integer,playerdata.cnt_f_4bet::integer,playerdata.cnt_f_4bet_def_action_call::integer,playerdata.cnt_f_4bet_def_action_fold::integer,playerdata.cnt_f_4bet_def_opp::integer,playerdata.cnt_f_4bet_opp::integer,playerdata.cnt_f_allin::integer,playerdata.cnt_f_allin_valid::integer,playerdata.cnt_f_bet::integer,playerdata.cnt_f_bet_def_action_call::integer,playerdata.cnt_f_bet_def_action_fold::integer,playerdata.cnt_f_bet_def_action_raise::integer,playerdata.cnt_f_bet_def_opp::integer,playerdata.cnt_f_bet_limp_pot::integer,playerdata.cnt_f_call::integer,playerdata.cnt_f_cbet::integer,playerdata.cnt_f_cbet_3bet_pot::integer,playerdata.cnt_f_cbet_def_action_call::integer,playerdata.cnt_f_cbet_def_action_call_in_pos::integer,playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_fold::integer,playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_raise::integer,playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,playerdata.cnt_f_cbet_def_opp::integer,playerdata.cnt_f_cbet_face_raise::integer,playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,playerdata.cnt_f_cbet_fold_to_raise::integer,playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_f_cbet_opp::integer,playerdata.cnt_f_cbet_opp_3bet_pot::integer,playerdata.cnt_f_cbet_success::integer,playerdata.cnt_f_check::integer,playerdata.cnt_f_check_raise::integer,playerdata.cnt_f_check_raise_opp::integer,playerdata.cnt_f_donk::integer,playerdata.cnt_f_donk_3bet_pot::integer,playerdata.cnt_f_donk_def_opp::integer,playerdata.cnt_f_donk_def_opp_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_call::integer,playerdata.cnt_f_donk_def_opp_action_fold::integer,playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_raise::integer,playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,playerdata.cnt_f_donk_face_raise::integer,playerdata.cnt_f_donk_fold::integer,playerdata.cnt_f_donk_opp::integer,playerdata.cnt_f_donk_opp_3bet_pot::integer,playerdata.cnt_f_face_xr::integer,playerdata.cnt_f_face_xr_call::integer,playerdata.cnt_f_face_xr_fold::integer,playerdata.cnt_f_face_xr_raise::integer,playerdata.cnt_f_float::integer,playerdata.cnt_f_float_3bet_pot::integer,playerdata.cnt_f_float_def_opp::integer,playerdata.cnt_f_float_def_opp_action_call::integer,playerdata.cnt_f_float_def_opp_action_fold::integer,playerdata.cnt_f_float_def_opp_action_raise::integer,playerdata.cnt_f_float_face_raise::integer,playerdata.cnt_f_float_fold::integer,playerdata.cnt_f_float_opp::integer,playerdata.cnt_f_float_opp_3bet_pot::integer,playerdata.cnt_f_fold::integer,playerdata.cnt_f_open_opp_limp_pot::integer,playerdata.cnt_f_raise::integer,playerdata.cnt_f_raise_def_opp::integer,playerdata.cnt_f_saw::integer,playerdata.cnt_f_saw_won::integer,playerdata.cnt_hands::integer,playerdata.cnt_hands_won::integer,playerdata.cnt_p_2bet_def_action_call::integer,playerdata.cnt_p_2bet_def_action_fold::integer,playerdata.cnt_p_2bet_def_opp::integer,playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,playerdata.cnt_p_3bet::integer,playerdata.cnt_p_3bet_def_action_call::integer,playerdata.cnt_p_3bet_def_action_call_after_2b::integer,playerdata.cnt_p_3bet_def_action_fold::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,playerdata.cnt_p_3bet_def_opp::integer,playerdata.cnt_p_3bet_def_opp_after_2b::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_f_cbet_def_opp::integer,playerdata.cnt_p_3bet_opp::integer,playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_open::integer,playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,playerdata.cnt_p_3bet_opp_vs_co_open::integer,playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_r_cbet_def_opp::integer,playerdata.cnt_p_3bet_success::integer,playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_t_cbet_def_opp::integer,playerdata.cnt_p_3bet_vs_bb_2bet::integer,playerdata.cnt_p_3bet_vs_btn_2bet::integer,playerdata.cnt_p_3bet_vs_btn_open::integer,playerdata.cnt_p_3bet_vs_co_2bet::integer,playerdata.cnt_p_3bet_vs_co_open::integer,playerdata.cnt_p_3bet_vs_ep_2bet::integer,playerdata.cnt_p_3bet_vs_mp_2bet::integer,playerdata.cnt_p_3bet_vs_sb_2bet::integer,playerdata.cnt_p_4bet::integer,playerdata.cnt_p_4bet_after_raising::integer,playerdata.cnt_p_4bet_cold::integer,playerdata.cnt_p_4bet_cold_opp::integer,playerdata.cnt_p_4bet_def_action_call::integer,playerdata.cnt_p_4bet_def_action_fold::integer,playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,playerdata.cnt_p_4bet_def_opp::integer,playerdata.cnt_p_4bet_def_opp_after_3b::integer,playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,playerdata.cnt_p_4bet_opp::integer,playerdata.cnt_p_4bet_opp_when_open_raised::integer,playerdata.cnt_p_5bet::integer,playerdata.cnt_p_5bet_def_action_fold::integer,playerdata.cnt_p_5bet_def_opp::integer,playerdata.cnt_p_5bet_opp::integer,playerdata.cnt_p_allin::integer,playerdata.cnt_p_allin_valid::integer,playerdata.cnt_p_bb_v_sb_3bet::integer,playerdata.cnt_p_bb_v_sb_3bet_opp::integer,playerdata.cnt_p_bb_v_sb_call::integer,playerdata.cnt_p_bb_v_sb_fold::integer,playerdata.cnt_p_call::integer,playerdata.cnt_p_call_vs_btn_open::integer,playerdata.cnt_p_call_vs_co_open::integer,playerdata.cnt_p_ccall::integer,playerdata.cnt_p_ccall_3bet::integer,playerdata.cnt_p_ccall_3bet_opp::integer,playerdata.cnt_p_ccall_opp::integer,playerdata.cnt_p_facing_limpers::integer,playerdata.cnt_p_fold::integer,playerdata.cnt_p_fold_vs_btn_open::integer,playerdata.cnt_p_fold_vs_co_open::integer,playerdata.cnt_p_limp::integer,playerdata.cnt_p_limp_call::integer,playerdata.cnt_p_limp_faceraise::integer,playerdata.cnt_p_limp_fold::integer,playerdata.cnt_p_limp_opp::integer,playerdata.cnt_p_limp_opp_facing_limpers::integer,playerdata.cnt_p_limp_raise::integer,playerdata.cnt_p_open_opp::integer,playerdata.cnt_p_open_opp_btn::integer,playerdata.cnt_p_open_opp_ep::integer,playerdata.cnt_p_raise::integer,playerdata.cnt_p_raise_3bet::integer,playerdata.cnt_p_raise_first_in::integer,playerdata.cnt_p_raise_limpers::integer,playerdata.cnt_p_rfi_btn::integer,playerdata.cnt_p_rfi_ep::integer,playerdata.cnt_p_squeeze::integer,playerdata.cnt_p_squeeze_def_call::integer,playerdata.cnt_p_squeeze_def_fold::integer,playerdata.cnt_p_squeeze_def_opp::integer,playerdata.cnt_p_squeeze_def_raise::integer,playerdata.cnt_p_squeeze_opp::integer,playerdata.cnt_pfr::integer,playerdata.cnt_pfr_opp::integer,playerdata.cnt_players_ttl::integer,playerdata.cnt_prev_callers_limp::integer,playerdata.cnt_r_2bet_def_action_call::integer,playerdata.cnt_r_2bet_def_action_fold::integer,playerdata.cnt_r_3bet::integer,playerdata.cnt_r_3bet_def_action_call::integer,playerdata.cnt_r_3bet_def_action_fold::integer,playerdata.cnt_r_3bet_def_opp::integer,playerdata.cnt_r_3bet_opp::integer,playerdata.cnt_r_4bet::integer,playerdata.cnt_r_4bet_def_action_call::integer,playerdata.cnt_r_4bet_def_action_fold::integer,playerdata.cnt_r_4bet_def_opp::integer,playerdata.cnt_r_4bet_opp::integer,playerdata.cnt_r_allin::integer,playerdata.cnt_r_allin_valid::integer,playerdata.cnt_r_bet::integer,playerdata.cnt_r_bet_def_action_call::integer,playerdata.cnt_r_bet_def_action_fold::integer,playerdata.cnt_r_bet_def_action_raise::integer,playerdata.cnt_r_bet_def_opp::integer,playerdata.cnt_r_call::integer,playerdata.cnt_r_call_hands::integer,playerdata.cnt_r_cbet::integer,playerdata.cnt_r_cbet_3bet_pot::integer,playerdata.cnt_r_cbet_def_action_call::integer,playerdata.cnt_r_cbet_def_action_fold::integer,playerdata.cnt_r_cbet_def_action_raise::integer,playerdata.cnt_r_cbet_def_opp::integer,playerdata.cnt_r_cbet_face_raise::integer,playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,playerdata.cnt_r_cbet_fold_to_raise::integer,playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_r_cbet_opp::integer,playerdata.cnt_r_cbet_opp_3bet_pot::integer,playerdata.cnt_r_cbet_success::integer,playerdata.cnt_r_check::integer,playerdata.cnt_r_check_raise::integer,playerdata.cnt_r_check_raise_opp::integer,playerdata.cnt_r_donk::integer,playerdata.cnt_r_donk_3bet_pot::integer,playerdata.cnt_r_donk_def_action_call::integer,playerdata.cnt_r_donk_def_action_fold::integer,playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_r_donk_def_action_raise::integer,playerdata.cnt_r_donk_def_opp::integer,playerdata.cnt_r_donk_def_opp_3bet_pot::integer,playerdata.cnt_r_donk_face_raise::integer,playerdata.cnt_r_donk_fold::integer,playerdata.cnt_r_donk_opp::integer,playerdata.cnt_r_donk_opp_3bet_pot::integer,playerdata.cnt_r_face_xr::integer,playerdata.cnt_r_face_xr_call::integer,playerdata.cnt_r_face_xr_fold::integer,playerdata.cnt_r_face_xr_raise::integer,playerdata.cnt_r_float::integer,playerdata.cnt_r_float_3bet_pot::integer,playerdata.cnt_r_float_def_action_call::integer,playerdata.cnt_r_float_def_action_fold::integer,playerdata.cnt_r_float_def_action_raise::integer,playerdata.cnt_r_float_def_opp::integer,playerdata.cnt_r_float_face_raise::integer,playerdata.cnt_r_float_fold::integer,playerdata.cnt_r_float_opp::integer,playerdata.cnt_r_float_opp_3bet_pot::integer,playerdata.cnt_r_fold::integer,playerdata.cnt_r_probe::integer,playerdata.cnt_r_probe_3bet_pot::integer,playerdata.cnt_r_probe_def_action_call::integer,playerdata.cnt_r_probe_def_action_fold::integer,playerdata.cnt_r_probe_def_action_raise::integer,playerdata.cnt_r_probe_def_opp::integer,playerdata.cnt_r_probe_face_raise::integer,playerdata.cnt_r_probe_fold::integer,playerdata.cnt_r_probe_opp::integer,playerdata.cnt_r_probe_opp_3bet_pot::integer,playerdata.cnt_r_raise::integer,playerdata.cnt_r_raise_wtsd::integer,playerdata.cnt_r_raise_wtsd_won::integer,playerdata.cnt_r_saw::integer,playerdata.cnt_steal_3bet_def_action_fold::integer,playerdata.cnt_steal_3bet_def_opp::integer,playerdata.cnt_steal_att::integer,playerdata.cnt_steal_att_lp::integer,playerdata.cnt_steal_att_sb::integer,playerdata.cnt_steal_def_3bet_opp::integer,playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,playerdata.cnt_steal_def_action_call::integer,playerdata.cnt_steal_def_action_call_vs_lp::integer,playerdata.cnt_steal_def_action_fold::integer,playerdata.cnt_steal_def_action_fold_vs_lp::integer,playerdata.cnt_steal_def_action_raise::integer,playerdata.cnt_steal_def_action_raise_vs_lp::integer,playerdata.cnt_steal_def_opp::integer,playerdata.cnt_steal_def_opp_vs_lp::integer,playerdata.cnt_steal_opp::integer,playerdata.cnt_steal_opp_lp::integer,playerdata.cnt_steal_opp_sb::integer,playerdata.cnt_steal_reraise_def_action_fold::integer,playerdata.cnt_steal_reraise_def_opp::integer,playerdata.cnt_steal_success::integer,playerdata.cnt_t_2bet_def_action_call::integer,playerdata.cnt_t_2bet_def_action_fold::integer,playerdata.cnt_t_3bet::integer,playerdata.cnt_t_3bet_def_action_call::integer,playerdata.cnt_t_3bet_def_action_fold::integer,playerdata.cnt_t_3bet_def_opp::integer,playerdata.cnt_t_3bet_opp::integer,playerdata.cnt_t_4bet::integer,playerdata.cnt_t_4bet_def_action_call::integer,playerdata.cnt_t_4bet_def_action_fold::integer,playerdata.cnt_t_4bet_def_opp::integer,playerdata.cnt_t_4bet_opp::integer,playerdata.cnt_t_allin::integer,playerdata.cnt_t_allin_valid::integer,playerdata.cnt_t_bet::integer,playerdata.cnt_t_bet_def_action_call::integer,playerdata.cnt_t_bet_def_action_fold::integer,playerdata.cnt_t_bet_def_action_raise::integer,playerdata.cnt_t_bet_def_opp::integer,playerdata.cnt_t_call::integer,playerdata.cnt_t_cbet::integer,playerdata.cnt_t_cbet_3bet_pot::integer,playerdata.cnt_t_cbet_def_action_call::integer,playerdata.cnt_t_cbet_def_action_fold::integer,playerdata.cnt_t_cbet_def_action_raise::integer,playerdata.cnt_t_cbet_def_opp::integer,playerdata.cnt_t_cbet_face_raise::integer,playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,playerdata.cnt_t_cbet_fold_to_raise::integer,playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_t_cbet_opp::integer,playerdata.cnt_t_cbet_opp_3bet_pot::integer,playerdata.cnt_t_cbet_success::integer,playerdata.cnt_t_check::integer,playerdata.cnt_t_check_raise::integer,playerdata.cnt_t_check_raise_opp::integer,playerdata.cnt_t_donk::integer,playerdata.cnt_t_donk_3bet_pot::integer,playerdata.cnt_t_donk_def_action_call::integer,playerdata.cnt_t_donk_def_action_fold::integer,playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_t_donk_def_action_raise::integer,playerdata.cnt_t_donk_def_opp::integer,playerdata.cnt_t_donk_def_opp_3bet_pot::integer,playerdata.cnt_t_donk_face_raise::integer,playerdata.cnt_t_donk_fold::integer,playerdata.cnt_t_donk_opp::integer,playerdata.cnt_t_donk_opp_3bet_pot::integer,playerdata.cnt_t_face_xr::integer,playerdata.cnt_t_face_xr_call::integer,playerdata.cnt_t_face_xr_fold::integer,playerdata.cnt_t_face_xr_raise::integer,playerdata.cnt_t_float::integer,playerdata.cnt_t_float_3bet_pot::integer,playerdata.cnt_t_float_def_action_call::integer,playerdata.cnt_t_float_def_action_fold::integer,playerdata.cnt_t_float_def_action_raise::integer,playerdata.cnt_t_float_def_opp::integer,playerdata.cnt_t_float_face_raise::integer,playerdata.cnt_t_float_fold::integer,playerdata.cnt_t_float_opp::integer,playerdata.cnt_t_float_opp_3bet_pot::integer,playerdata.cnt_t_fold::integer,playerdata.cnt_t_probe::integer,playerdata.cnt_t_probe_3bet_pot::integer,playerdata.cnt_t_probe_def_action_call::integer,playerdata.cnt_t_probe_def_action_fold::integer,playerdata.cnt_t_probe_def_action_raise::integer,playerdata.cnt_t_probe_def_opp::integer,playerdata.cnt_t_probe_face_raise::integer,playerdata.cnt_t_probe_fold::integer,playerdata.cnt_t_probe_opp::integer,playerdata.cnt_t_probe_opp_3bet_pot::integer,playerdata.cnt_t_raise::integer,playerdata.cnt_t_raise_wtsd::integer,playerdata.cnt_t_raise_wtsd_won::integer,playerdata.cnt_t_saw::integer,playerdata.cnt_vpip::integer,playerdata.cnt_vpip_sb::integer,playerdata.cnt_walks::integer,playerdata.cnt_won_hand::integer,playerdata.cnt_wtsd::integer,playerdata.cnt_wtsd_allin::integer,playerdata.cnt_wtsd_non_small::integer,playerdata.cnt_wtsd_won::integer,playerdata.cnt_wtsd_won_non_small::integer,playerdata.cnt_wtsd_won_when_r_call::integer,playerdata.limit_currency::text,playerdata.val_equity::numeric(14,2),playerdata.val_f_equity::numeric(14,2),playerdata.val_p_equity::numeric(14,2),playerdata.val_r_equity::numeric(14,2),playerdata.val_t_equity::numeric(14,2));
      CONTINUE;
    END insertCashPlayerDataToCache;
    
  END LOOP getCashPlayersDataToCache;
  
  RETURN;
END;
$_$;


ALTER FUNCTION public.update_cash_cache_player(integer) OWNER TO %USERNAME%;

--
-- TOC entry 217 (class 1255 OID 17392)
-- Name: update_cash_cache_playerrange(integer, integer); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_cash_cache_playerrange(integer, integer) RETURNS void
    LANGUAGE plpgsql
    AS $_$

DECLARE
  playerdata cash_cache%ROWTYPE;

BEGIN
  <<deletePlayersCache>>
  BEGIN
    DELETE FROM cash_cache WHERE id_player >= $1 AND id_player <= $2;
  END deletePlayersCache;

  <<getCashPlayersDataToCache>>
  FOR playerdata IN 
    SELECT cash_hand_player_statistics.id_player, cash_hand_player_statistics.id_gametype, cash_hand_player_statistics.id_limit, cash_hand_summary.cnt_players,((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)), (cash_hand_player_statistics.flg_f_has_position), (cash_hand_player_statistics.flg_t_has_position), (cash_hand_player_statistics.flg_r_has_position), (CAST ( ((date_part('year',  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN ((cash_hand_player_statistics.amt_won * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN (((case when(cash_hand_player_statistics.amt_payout > 0) then (cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl) else  cash_hand_player_statistics.amt_won end) * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum(cash_hand_player_statistics.amt_blind)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_blind) as numeric) )), (sum( (CASE WHEN ( cash_limit.amt_bb) <> 0 THEN ((cash_hand_player_statistics.amt_expected_won * 1.0 )/( cash_limit.amt_bb)) ELSE 0 END) )), (sum(cash_hand_player_statistics.amt_expected_won)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_expected_won) as numeric ))), (sum(cash_hand_summary.amt_jackpot_fee)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_jackpot_fee) as numeric ))), (sum(cash_hand_player_statistics.amt_payout)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_payout)) AS numeric ))), (sum(cash_hand_player_statistics.amt_payout_fee)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_payout_fee)) AS numeric ))), (sum( (case when( cash_hand_player_statistics.cnt_r_call > 0 AND (cash_hand_player_statistics.amt_r_bet_made + cash_hand_player_statistics.amt_r_raise_made) = 0) then  cash_hand_player_statistics.amt_bet_r else  0  end))), (sum( (case when( cash_hand_player_statistics.cnt_r_call > 0 AND (cash_hand_player_statistics.amt_r_bet_made + cash_hand_player_statistics.amt_r_raise_made) = 0 AND cash_hand_player_statistics.flg_won_hand) then  cash_hand_player_statistics.amt_won + cash_hand_player_statistics.amt_bet_ttl else  0  end))), (sum(cash_hand_summary.amt_rake * ( (CASE WHEN ( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee)) <> 0 THEN (( (cash_hand_player_statistics.amt_won +  cash_hand_player_statistics.amt_bet_ttl)  * 1.0 )/( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee))) ELSE 0 END) ))), (sum(CAST( ((case when(cash_hand_player_statistics.flg_won_hand) then  cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_rake * ( (CASE WHEN ( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee)) <> 0 THEN (( (cash_hand_player_statistics.amt_won + cash_hand_player_statistics.amt_bet_ttl)  * 1.0 )/( (cash_hand_summary.amt_pot - cash_hand_summary.amt_rake - cash_hand_summary.amt_jackpot_fee))) ELSE 0 END) ) else  0 end)) as numeric))), (sum(cash_hand_summary.amt_mgr)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_mgr) AS numeric ))), (sum(cash_hand_summary.amt_rake)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_summary.amt_rake) as numeric ))), (sum(( (CASE WHEN ( cash_hand_summary.amt_pot) <> 0 THEN ((cash_hand_player_statistics.amt_bet_ttl * 1.0 )/( cash_hand_summary.amt_pot)) ELSE 0 END) ) * cash_hand_summary.amt_rake)), (sum(CAST( ((case when(cash_hand_player_statistics.amt_bet_ttl > 0) then  cash_hand_player_statistics.val_curr_conv * ( (CASE WHEN ( cash_hand_summary.amt_pot) <> 0 THEN ((cash_hand_player_statistics.amt_bet_ttl * 1.0 )/( cash_hand_summary.amt_pot)) ELSE 0 END) ) * cash_hand_summary.amt_rake else  0 end)) AS numeric ))), (sum(cash_hand_player_statistics.amt_straddle)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * (cash_hand_player_statistics.amt_straddle)) AS numeric ))), (sum(cash_hand_player_statistics.amt_won)), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * cash_hand_player_statistics.amt_won) AS numeric ))), (sum((case when(cash_hand_player_statistics.amt_payout > 0) then  cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl else  cash_hand_player_statistics.amt_won end))), (sum(CAST( (cash_hand_player_statistics.val_curr_conv * ((case when(cash_hand_player_statistics.amt_payout > 0) then  cash_hand_player_statistics.amt_payout - cash_hand_player_statistics.amt_bet_ttl else  cash_hand_player_statistics.amt_won end))) AS numeric ))), (sum((case when(cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_s OR cash_hand_player_statistics.flg_blind_db OR cash_hand_player_statistics.flg_blind_ds) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp AND ((cash_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp AND ((cash_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(F|XF)')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_bet and NOT(cash_hand_player_statistics.flg_p_face_raise) and cash_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_f_call )), (sum((case when(cash_hand_player_statistics.flg_f_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='C') then 1 else 0 end))), (sum((case when( not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_f_check) AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND cash_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND cash_hand_player_statistics.flg_f_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_cbet AND NOT (cash_hand_player_statistics.flg_t_saw) AND NOT (cash_hand_player_statistics.flg_f_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_check AND (cash_hand_player_statistics.cnt_f_raise > 0 OR cash_hand_player_statistics.cnt_f_call > 0 OR cash_hand_player_statistics.flg_f_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND cash_hand_player_statistics.flg_f_bet AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND cash_hand_player_statistics.flg_f_bet AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'C') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) and cash_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (cash_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT(cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action SIMILAR TO 'B_%' AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT(cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action = 'BF' AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_p_face_raise AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND (cash_hand_player_statistics.flg_f_open_opp) AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet) AND (cash_hand_player_statistics.flg_f_open_opp) AND NOT (cash_hand_player_statistics.flg_f_cbet_opp) AND ((cash_hand_summary.cnt_players > 2 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) or (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when(cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_f_bet AND cash_hand_player_statistics.flg_f_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_f from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and cash_hand_player_statistics.flg_f_has_position and cash_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' AND cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XC') then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XF') then  1 else  0 end))), (sum((case when( not(cash_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and cash_hand_player_statistics.flg_f_open_opp AND cash_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XR') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position OR cash_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action LIKE 'B_%') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_bet AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position OR cash_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.flg_f_open_opp AND char_length(cash_hand_summary.str_aggressors_p) = 2 AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and cash_hand_player_statistics.flg_f_has_position and cash_hand_player_statistics.flg_f_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_open_opp and not(cash_hand_player_statistics.flg_p_face_raise) and cash_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_f_raise)), (sum((case when(cash_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand AND cash_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.id_hand > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(cash_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'C%') OR lookup_actions_p.action SIMILAR TO '(C|X)C%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(cash_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'F') OR lookup_actions_p.action SIMILAR TO '(C|X)F')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.enum_p_3bet_action = 'C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int > cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.enum_p_3bet_action='F' AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int < cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int > cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 3 and cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 3 for 1)) end)::int < cash_hand_player_statistics.position) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet_opp AND ((cash_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet_opp AND ((cash_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet_opp and cash_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_player_statistics.flg_won_hand and not(cash_hand_player_statistics.flg_f_saw) and not(cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='C') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet AND ((cash_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 2 and cash_hand_player_statistics.flg_p_3bet AND ((cash_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (cash_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (cash_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(cash_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet and cash_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet and lookup_actions_p.action LIKE 'R%' and not(cash_hand_player_statistics.flg_p_first_raise) and not(cash_hand_player_statistics.flg_p_3bet)) then  1 else  0 end))), (sum((case when(not(cash_hand_player_statistics.flg_p_limp) and not(cash_hand_player_statistics.flg_p_open_opp) and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0 and (cash_hand_player_statistics.amt_p_3bet_facing > 0 or cash_hand_player_statistics.amt_p_4bet_facing > 0) and cash_hand_player_statistics.flg_p_4bet_opp ) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_p_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet AND cash_hand_player_statistics.enum_p_4bet_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_3bet AND cash_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_def_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp AND cash_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when( char_length(cash_hand_summary.str_aggressors_p) >= 4 AND (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int != cash_hand_player_statistics.position AND cash_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 5 AND cash_hand_player_statistics.flg_p_4bet_def_opp AND cash_hand_player_statistics.enum_folded = 'P' AND (cash_hand_player_statistics.flg_p_4bet OR  NOT(((10 + cash_hand_player_statistics.position -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))  ), (sum((case when(char_length(cash_hand_summary.str_aggressors_p) >= 5 AND cash_hand_player_statistics.flg_p_4bet_def_opp AND (cash_hand_player_statistics.flg_p_4bet OR   NOT(((10 + cash_hand_player_statistics.position -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(cash_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(cash_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(cash_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_4bet_opp and ((not cash_hand_player_statistics.flg_p_3bet_def_opp) OR (cash_hand_player_statistics.enum_p_3bet_action SIMILAR TO '(C|R)' AND cash_hand_player_statistics.flg_p_4bet_def_opp))) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9 AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='C' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.position=8 AND cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='F' AND cash_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_p_call )), (sum((case when(lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%' AND cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%' AND cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_ccall and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when( (cash_hand_player_statistics.enum_p_3bet_action = 'C' and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0) OR (cash_hand_player_statistics.amt_p_3bet_facing = 0 and cash_hand_player_statistics.enum_p_4bet_action = 'C' and not(cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when( (cash_hand_player_statistics.flg_p_3bet_def_opp and not(cash_hand_player_statistics.flg_p_first_raise) and cash_hand_player_statistics.amt_p_2bet_facing = 0) or (cash_hand_player_statistics.amt_p_3bet_facing = 0 and cash_hand_player_statistics.flg_p_4bet_def_opp and not(cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_p_2bet_facing > 0 and cash_hand_player_statistics.amt_blind = 0 and not(cash_hand_player_statistics.flg_p_limp)) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.cnt_p_face_limpers > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_fold) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and cash_hand_summary.str_aggressors_p LIKE '80%' and cash_hand_summary.str_actors_p LIKE '0%' and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and cash_hand_summary.str_aggressors_p LIKE '81%' and cash_hand_summary.str_actors_p LIKE '1%' and cash_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CC%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND cash_hand_player_statistics.flg_p_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action = 'CF') then  1 else  0 end))), (sum((case when(((NOT cash_hand_player_statistics.flg_p_face_raise) OR (cash_hand_player_statistics.flg_p_limp) OR (cash_hand_player_statistics.flg_p_first_raise)) AND NOT (cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_db)) then 1 else 0 end))), (sum((case when( cash_hand_player_statistics.cnt_p_face_limpers > 0 AND NOT (cash_hand_player_statistics.flg_blind_b OR cash_hand_player_statistics.flg_blind_db)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CR%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.position = 0 and cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp AND ((cash_hand_summary.cnt_players between 4 and 6 and cash_hand_player_statistics.position between 3 and 5) OR (cash_hand_summary.cnt_players between 7 and 8 and cash_hand_player_statistics.position between 4 and 7) OR (cash_hand_summary.cnt_players between 9 and 10 and cash_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_p_raise )), (sum((case when(cash_hand_player_statistics.enum_p_3bet_action = 'R' AND cash_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND NOT cash_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.position = 0) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_first_raise AND cash_hand_player_statistics.flg_p_open_opp and ((cash_hand_summary.cnt_players between 4 and 6 and cash_hand_player_statistics.position between 3 and 5) OR (cash_hand_summary.cnt_players between 7 and 8 and cash_hand_player_statistics.position between 4 and 7) OR (cash_hand_summary.cnt_players between 9 and 10 and cash_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_def_opp AND cash_hand_player_statistics.enum_p_squeeze_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_squeeze_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_p_raise > 0) then  1 else  0 end))), (sum((case when( lookup_actions_p.action LIKE '__%' OR (lookup_actions_p.action LIKE '_' AND (cash_hand_player_statistics.amt_before > (cash_limit.amt_bb + cash_hand_player_statistics.amt_ante)) AND (cash_hand_player_statistics.amt_p_raise_facing < (cash_hand_player_statistics.amt_before - (cash_hand_player_statistics.amt_blind + cash_hand_player_statistics.amt_ante))) AND (cash_hand_player_statistics.flg_p_open_opp OR cash_hand_player_statistics.cnt_p_face_limpers > 0 OR cash_hand_player_statistics.flg_p_3bet_opp OR cash_hand_player_statistics.flg_p_4bet_opp) )) then  1 else  0 end))), (sum(cash_hand_summary.cnt_players)), (sum((case when(cash_hand_player_statistics.flg_p_open = false AND cash_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp AND ((cash_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp AND ((cash_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_r_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_r_call )), (sum((case when(cash_hand_player_statistics.cnt_r_call > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND cash_hand_player_statistics.flg_r_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND cash_hand_player_statistics.flg_r_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND lookup_actions_r.action LIKE 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet OR cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_cbet AND NOT(cash_hand_player_statistics.flg_r_face_raise) AND NOT(cash_hand_player_statistics.flg_showdown)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_check AND (cash_hand_player_statistics.cnt_r_raise > 0 OR cash_hand_player_statistics.cnt_r_call > 0 OR cash_hand_player_statistics.flg_r_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp or cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.enum_r_donk_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_donk_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_r_bet AND cash_hand_player_statistics.flg_r_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_r from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='F') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_r_float_action='R') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_float_opp and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b)) AND (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_r_bet_facing > 0 and cash_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(cash_hand_player_statistics.flg_r_open_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND lookup_actions_r.action LIKE 'B_%' AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action = 'BF' AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND cash_hand_player_statistics.flg_f_check AND cash_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (cash_hand_player_statistics.flg_f_face_raise) AND ((cash_hand_summary.cnt_players >= 3 AND cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_b)) AND (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_r_raise)), (sum((case when(cash_hand_player_statistics.cnt_r_raise > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_r_raise > 0 AND cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_r_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp ) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att and cash_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.flg_p_first_raise and cash_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp and cash_hand_summary.str_aggressors_p NOT LIKE '89%' AND cash_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%' and cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F' AND cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_def_opp and cash_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_opp and cash_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_p_open_opp and cash_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp AND cash_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND cash_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_steal_att AND NOT (cash_hand_player_statistics.flg_f_saw) AND NOT (cash_hand_player_statistics.flg_p_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp AND ((cash_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(C|XC|BC)%') OR (cash_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp AND ((cash_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(F|XF|BF)%') OR (cash_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_3bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_3bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_3bet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_4bet_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_4bet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_4bet_opp) then  1 else  0 end))), (sum( (case when(cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum((case when(cash_hand_player_statistics.flg_t_bet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_t_call )), (sum((case when(cash_hand_player_statistics.flg_t_cbet) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='C') then 1 else 0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND cash_hand_player_statistics.flg_t_face_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND cash_hand_player_statistics.flg_t_face_raise and (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND lookup_actions_t.action LIKE 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet_opp AND (cash_hand_player_statistics.flg_p_3bet or cash_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_cbet AND NOT (cash_hand_player_statistics.flg_r_saw) AND NOT (cash_hand_player_statistics.flg_t_face_raise)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check_raise) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_check AND (cash_hand_player_statistics.cnt_t_raise > 0 OR cash_hand_player_statistics.cnt_t_call > 0 OR cash_hand_player_statistics.flg_t_fold)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='F') then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp or cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.enum_t_donk_action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_donk_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) and cash_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when((cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp) AND cash_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'C' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'F' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'R' AND cash_hand_player_statistics.flg_t_bet AND cash_hand_player_statistics.flg_t_face_raise AND ((cash_hand_summary.cnt_players > 2 AND (case when(char_length(cash_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(cash_hand_summary.str_aggressors_t from 2 for 1)) end)::int > cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 AND cash_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='C') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.enum_t_float_action='R') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_def_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_opp) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_float_opp and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_fold) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'C%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action = 'F') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'R%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.amt_t_bet_facing > 0 and cash_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(cash_hand_player_statistics.flg_t_open_opp)) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_summary.cnt_players >= 3 and cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND cash_hand_player_statistics.flg_p_face_raise AND ((cash_hand_player_statistics.val_p_raise_aggressor_pos < cash_hand_player_statistics.position AND cash_hand_summary.cnt_players >= 3) OR (cash_hand_summary.cnt_players = 2 and cash_hand_player_statistics.flg_blind_b)) and (cash_hand_player_statistics.flg_p_3bet_def_opp OR cash_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(cash_hand_player_statistics.cnt_t_raise)), (sum((case when(cash_hand_player_statistics.cnt_t_raise > 0 AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_t_raise > 0 AND cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_t_saw) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_blind_b = false AND cash_hand_player_statistics.flg_blind_s AND cash_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = '') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.enum_allin<>'N') then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown and cash_hand_player_statistics.amt_bet_ttl > 5 * cash_limit.amt_bb) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown AND cash_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.flg_showdown and cash_hand_player_statistics.flg_won_hand and cash_hand_player_statistics.amt_bet_ttl > 5 * cash_limit.amt_bb) then  1 else  0 end))), (sum((case when(cash_hand_player_statistics.cnt_r_call > 0 AND cash_hand_player_statistics.flg_won_hand AND cash_hand_player_statistics.flg_showdown) then  1 else  0 end))), (cash_limit.limit_currency), (sum((case when( cash_hand_player_statistics.enum_allin='P' OR cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p' OR  cash_hand_player_statistics.enum_allin='F' OR cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f' OR  cash_hand_player_statistics.enum_allin='T' OR cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t' OR  cash_hand_player_statistics.enum_allin='R' OR cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r' ) then    ( (case when(cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND  cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND  cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F')) then  cash_hand_player_statistics.val_equity else  0 end) )   else  0 end))), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='F' OR ((cash_hand_player_statistics.enum_face_allin='F' OR cash_hand_player_statistics.enum_face_allin='f') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='P' OR ((cash_hand_player_statistics.enum_face_allin='P' OR cash_hand_player_statistics.enum_face_allin='p') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='R' OR ((cash_hand_player_statistics.enum_face_allin='R' OR cash_hand_player_statistics.enum_face_allin='r') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(cash_hand_player_statistics.val_equity>0 AND (cash_hand_player_statistics.enum_allin='T' OR ((cash_hand_player_statistics.enum_face_allin='T' OR cash_hand_player_statistics.enum_face_allin='t') AND cash_hand_player_statistics.enum_face_allin_action<>'F'))) then  cash_hand_player_statistics.val_equity else  0 end) )) FROM	 cash_hand_player_statistics , cash_hand_summary, cash_limit, lookup_actions lookup_actions_f, lookup_actions lookup_actions_p, lookup_actions lookup_actions_r, lookup_actions lookup_actions_t, lookup_positions WHERE (cash_hand_summary.id_hand = cash_hand_player_statistics.id_hand AND cash_hand_summary.id_limit = cash_hand_player_statistics.id_limit)  AND (cash_limit.id_limit = cash_hand_player_statistics.id_limit)  AND (lookup_actions_f.id_action=cash_hand_player_statistics.id_action_f)  AND (lookup_actions_p.id_action=cash_hand_player_statistics.id_action_p)  AND (lookup_actions_r.id_action=cash_hand_player_statistics.id_action_r)  AND (lookup_actions_t.id_action=cash_hand_player_statistics.id_action_t)  AND (lookup_positions."position"=cash_hand_player_statistics."position" AND lookup_positions.cnt_players=cash_hand_player_statistics.cnt_players_lookup_position)  AND (cash_limit.id_limit = cash_hand_summary.id_limit)   AND ((cash_hand_player_statistics.id_player >= $1 AND cash_hand_player_statistics.id_player <= $2))  GROUP BY cash_hand_player_statistics.id_player, cash_hand_player_statistics.id_gametype, cash_hand_player_statistics.id_limit, cash_hand_summary.cnt_players,  ((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)),  (cash_hand_player_statistics.flg_f_has_position),  (cash_hand_player_statistics.flg_t_has_position),  (cash_hand_player_statistics.flg_r_has_position),  (CAST ( ((date_part('year',  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  cash_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )),  (cash_limit.limit_currency) 

  LOOP  
    <<insertCashPlayerDataToCache>>
    BEGIN
      INSERT INTO cash_cache VALUES(playerdata.id_player, playerdata.id_gametype, playerdata.id_limit, playerdata.cnt_players,playerdata.position_type::integer,playerdata.flg_has_position_f::boolean,playerdata.flg_has_position_t::boolean,playerdata.flg_has_position_r::boolean,playerdata.date_played_year_week::integer,playerdata.amt_bb_won::numeric(14,2),playerdata.amt_bb_won_inc_payout::numeric(14,2),playerdata.amt_blind::numeric(14,2),playerdata.amt_blind_curr_conv::numeric(14,2),playerdata.amt_expected_bb_won::numeric(14,2),playerdata.amt_expected_won::numeric(14,2),playerdata.amt_expected_won_curr_conv::numeric(14,2),playerdata.amt_jackpot_taken::numeric(14,2),playerdata.amt_jackpot_taken_curr_conv::numeric(14,2),playerdata.amt_payout::numeric(14,2),playerdata.amt_payout_curr_conv::numeric(14,2),playerdata.amt_payout_fee::numeric(14,2),playerdata.amt_payout_fee_curr_conv::numeric(14,2),playerdata.amt_r_call::numeric(14,2),playerdata.amt_r_call_won::numeric(14,2),playerdata.amt_rake_attributed::numeric(14,2),playerdata.amt_rake_attributed_curr_conv::numeric(14,2),playerdata.amt_rake_share::numeric(14,2),playerdata.amt_rake_share_curr_conv::numeric(14,2),playerdata.amt_rake_taken::numeric(14,2),playerdata.amt_rake_taken_curr_conv::numeric(14,2),playerdata.amt_rake_weighted_contributed::numeric(14,2),playerdata.amt_rake_weighted_contributed_curr_conv::numeric(14,2),playerdata.amt_straddle::numeric(14,2),playerdata.amt_straddle_curr_conv::numeric(14,2),playerdata.amt_won::numeric(14,2),playerdata.amt_won_curr_conv::numeric(14,2),playerdata.amt_won_inc_payout::numeric(14,2),playerdata.amt_won_inc_payout_curr_conv::numeric(14,2),playerdata.cnt_blind::integer,playerdata.cnt_f_2bet_def_action_call::integer,playerdata.cnt_f_2bet_def_action_fold::integer,playerdata.cnt_f_3bet::integer,playerdata.cnt_f_3bet_def_action_call::integer,playerdata.cnt_f_3bet_def_action_fold::integer,playerdata.cnt_f_3bet_def_opp::integer,playerdata.cnt_f_3bet_opp::integer,playerdata.cnt_f_4bet::integer,playerdata.cnt_f_4bet_def_action_call::integer,playerdata.cnt_f_4bet_def_action_fold::integer,playerdata.cnt_f_4bet_def_opp::integer,playerdata.cnt_f_4bet_opp::integer,playerdata.cnt_f_allin::integer,playerdata.cnt_f_allin_valid::integer,playerdata.cnt_f_bet::integer,playerdata.cnt_f_bet_def_action_call::integer,playerdata.cnt_f_bet_def_action_fold::integer,playerdata.cnt_f_bet_def_action_raise::integer,playerdata.cnt_f_bet_def_opp::integer,playerdata.cnt_f_bet_limp_pot::integer,playerdata.cnt_f_call::integer,playerdata.cnt_f_cbet::integer,playerdata.cnt_f_cbet_3bet_pot::integer,playerdata.cnt_f_cbet_def_action_call::integer,playerdata.cnt_f_cbet_def_action_call_in_pos::integer,playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_fold::integer,playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_raise::integer,playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,playerdata.cnt_f_cbet_def_opp::integer,playerdata.cnt_f_cbet_face_raise::integer,playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,playerdata.cnt_f_cbet_fold_to_raise::integer,playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_f_cbet_opp::integer,playerdata.cnt_f_cbet_opp_3bet_pot::integer,playerdata.cnt_f_cbet_success::integer,playerdata.cnt_f_check::integer,playerdata.cnt_f_check_raise::integer,playerdata.cnt_f_check_raise_opp::integer,playerdata.cnt_f_donk::integer,playerdata.cnt_f_donk_3bet_pot::integer,playerdata.cnt_f_donk_def_opp::integer,playerdata.cnt_f_donk_def_opp_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_call::integer,playerdata.cnt_f_donk_def_opp_action_fold::integer,playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_raise::integer,playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,playerdata.cnt_f_donk_face_raise::integer,playerdata.cnt_f_donk_fold::integer,playerdata.cnt_f_donk_opp::integer,playerdata.cnt_f_donk_opp_3bet_pot::integer,playerdata.cnt_f_face_xr::integer,playerdata.cnt_f_face_xr_call::integer,playerdata.cnt_f_face_xr_fold::integer,playerdata.cnt_f_face_xr_raise::integer,playerdata.cnt_f_float::integer,playerdata.cnt_f_float_3bet_pot::integer,playerdata.cnt_f_float_def_opp::integer,playerdata.cnt_f_float_def_opp_action_call::integer,playerdata.cnt_f_float_def_opp_action_fold::integer,playerdata.cnt_f_float_def_opp_action_raise::integer,playerdata.cnt_f_float_face_raise::integer,playerdata.cnt_f_float_fold::integer,playerdata.cnt_f_float_opp::integer,playerdata.cnt_f_float_opp_3bet_pot::integer,playerdata.cnt_f_fold::integer,playerdata.cnt_f_open_opp_limp_pot::integer,playerdata.cnt_f_raise::integer,playerdata.cnt_f_raise_def_opp::integer,playerdata.cnt_f_saw::integer,playerdata.cnt_f_saw_won::integer,playerdata.cnt_hands::integer,playerdata.cnt_hands_won::integer,playerdata.cnt_p_2bet_def_action_call::integer,playerdata.cnt_p_2bet_def_action_fold::integer,playerdata.cnt_p_2bet_def_opp::integer,playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,playerdata.cnt_p_3bet::integer,playerdata.cnt_p_3bet_def_action_call::integer,playerdata.cnt_p_3bet_def_action_call_after_2b::integer,playerdata.cnt_p_3bet_def_action_fold::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,playerdata.cnt_p_3bet_def_opp::integer,playerdata.cnt_p_3bet_def_opp_after_2b::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_f_cbet_def_opp::integer,playerdata.cnt_p_3bet_opp::integer,playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_open::integer,playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,playerdata.cnt_p_3bet_opp_vs_co_open::integer,playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_r_cbet_def_opp::integer,playerdata.cnt_p_3bet_success::integer,playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_t_cbet_def_opp::integer,playerdata.cnt_p_3bet_vs_bb_2bet::integer,playerdata.cnt_p_3bet_vs_btn_2bet::integer,playerdata.cnt_p_3bet_vs_btn_open::integer,playerdata.cnt_p_3bet_vs_co_2bet::integer,playerdata.cnt_p_3bet_vs_co_open::integer,playerdata.cnt_p_3bet_vs_ep_2bet::integer,playerdata.cnt_p_3bet_vs_mp_2bet::integer,playerdata.cnt_p_3bet_vs_sb_2bet::integer,playerdata.cnt_p_4bet::integer,playerdata.cnt_p_4bet_after_raising::integer,playerdata.cnt_p_4bet_cold::integer,playerdata.cnt_p_4bet_cold_opp::integer,playerdata.cnt_p_4bet_def_action_call::integer,playerdata.cnt_p_4bet_def_action_fold::integer,playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,playerdata.cnt_p_4bet_def_opp::integer,playerdata.cnt_p_4bet_def_opp_after_3b::integer,playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,playerdata.cnt_p_4bet_opp::integer,playerdata.cnt_p_4bet_opp_when_open_raised::integer,playerdata.cnt_p_5bet::integer,playerdata.cnt_p_5bet_def_action_fold::integer,playerdata.cnt_p_5bet_def_opp::integer,playerdata.cnt_p_5bet_opp::integer,playerdata.cnt_p_allin::integer,playerdata.cnt_p_allin_valid::integer,playerdata.cnt_p_bb_v_sb_3bet::integer,playerdata.cnt_p_bb_v_sb_3bet_opp::integer,playerdata.cnt_p_bb_v_sb_call::integer,playerdata.cnt_p_bb_v_sb_fold::integer,playerdata.cnt_p_call::integer,playerdata.cnt_p_call_vs_btn_open::integer,playerdata.cnt_p_call_vs_co_open::integer,playerdata.cnt_p_ccall::integer,playerdata.cnt_p_ccall_3bet::integer,playerdata.cnt_p_ccall_3bet_opp::integer,playerdata.cnt_p_ccall_opp::integer,playerdata.cnt_p_facing_limpers::integer,playerdata.cnt_p_fold::integer,playerdata.cnt_p_fold_vs_btn_open::integer,playerdata.cnt_p_fold_vs_co_open::integer,playerdata.cnt_p_limp::integer,playerdata.cnt_p_limp_call::integer,playerdata.cnt_p_limp_faceraise::integer,playerdata.cnt_p_limp_fold::integer,playerdata.cnt_p_limp_opp::integer,playerdata.cnt_p_limp_opp_facing_limpers::integer,playerdata.cnt_p_limp_raise::integer,playerdata.cnt_p_open_opp::integer,playerdata.cnt_p_open_opp_btn::integer,playerdata.cnt_p_open_opp_ep::integer,playerdata.cnt_p_raise::integer,playerdata.cnt_p_raise_3bet::integer,playerdata.cnt_p_raise_first_in::integer,playerdata.cnt_p_raise_limpers::integer,playerdata.cnt_p_rfi_btn::integer,playerdata.cnt_p_rfi_ep::integer,playerdata.cnt_p_squeeze::integer,playerdata.cnt_p_squeeze_def_call::integer,playerdata.cnt_p_squeeze_def_fold::integer,playerdata.cnt_p_squeeze_def_opp::integer,playerdata.cnt_p_squeeze_def_raise::integer,playerdata.cnt_p_squeeze_opp::integer,playerdata.cnt_pfr::integer,playerdata.cnt_pfr_opp::integer,playerdata.cnt_players_ttl::integer,playerdata.cnt_prev_callers_limp::integer,playerdata.cnt_r_2bet_def_action_call::integer,playerdata.cnt_r_2bet_def_action_fold::integer,playerdata.cnt_r_3bet::integer,playerdata.cnt_r_3bet_def_action_call::integer,playerdata.cnt_r_3bet_def_action_fold::integer,playerdata.cnt_r_3bet_def_opp::integer,playerdata.cnt_r_3bet_opp::integer,playerdata.cnt_r_4bet::integer,playerdata.cnt_r_4bet_def_action_call::integer,playerdata.cnt_r_4bet_def_action_fold::integer,playerdata.cnt_r_4bet_def_opp::integer,playerdata.cnt_r_4bet_opp::integer,playerdata.cnt_r_allin::integer,playerdata.cnt_r_allin_valid::integer,playerdata.cnt_r_bet::integer,playerdata.cnt_r_bet_def_action_call::integer,playerdata.cnt_r_bet_def_action_fold::integer,playerdata.cnt_r_bet_def_action_raise::integer,playerdata.cnt_r_bet_def_opp::integer,playerdata.cnt_r_call::integer,playerdata.cnt_r_call_hands::integer,playerdata.cnt_r_cbet::integer,playerdata.cnt_r_cbet_3bet_pot::integer,playerdata.cnt_r_cbet_def_action_call::integer,playerdata.cnt_r_cbet_def_action_fold::integer,playerdata.cnt_r_cbet_def_action_raise::integer,playerdata.cnt_r_cbet_def_opp::integer,playerdata.cnt_r_cbet_face_raise::integer,playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,playerdata.cnt_r_cbet_fold_to_raise::integer,playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_r_cbet_opp::integer,playerdata.cnt_r_cbet_opp_3bet_pot::integer,playerdata.cnt_r_cbet_success::integer,playerdata.cnt_r_check::integer,playerdata.cnt_r_check_raise::integer,playerdata.cnt_r_check_raise_opp::integer,playerdata.cnt_r_donk::integer,playerdata.cnt_r_donk_3bet_pot::integer,playerdata.cnt_r_donk_def_action_call::integer,playerdata.cnt_r_donk_def_action_fold::integer,playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_r_donk_def_action_raise::integer,playerdata.cnt_r_donk_def_opp::integer,playerdata.cnt_r_donk_def_opp_3bet_pot::integer,playerdata.cnt_r_donk_face_raise::integer,playerdata.cnt_r_donk_fold::integer,playerdata.cnt_r_donk_opp::integer,playerdata.cnt_r_donk_opp_3bet_pot::integer,playerdata.cnt_r_face_xr::integer,playerdata.cnt_r_face_xr_call::integer,playerdata.cnt_r_face_xr_fold::integer,playerdata.cnt_r_face_xr_raise::integer,playerdata.cnt_r_float::integer,playerdata.cnt_r_float_3bet_pot::integer,playerdata.cnt_r_float_def_action_call::integer,playerdata.cnt_r_float_def_action_fold::integer,playerdata.cnt_r_float_def_action_raise::integer,playerdata.cnt_r_float_def_opp::integer,playerdata.cnt_r_float_face_raise::integer,playerdata.cnt_r_float_fold::integer,playerdata.cnt_r_float_opp::integer,playerdata.cnt_r_float_opp_3bet_pot::integer,playerdata.cnt_r_fold::integer,playerdata.cnt_r_probe::integer,playerdata.cnt_r_probe_3bet_pot::integer,playerdata.cnt_r_probe_def_action_call::integer,playerdata.cnt_r_probe_def_action_fold::integer,playerdata.cnt_r_probe_def_action_raise::integer,playerdata.cnt_r_probe_def_opp::integer,playerdata.cnt_r_probe_face_raise::integer,playerdata.cnt_r_probe_fold::integer,playerdata.cnt_r_probe_opp::integer,playerdata.cnt_r_probe_opp_3bet_pot::integer,playerdata.cnt_r_raise::integer,playerdata.cnt_r_raise_wtsd::integer,playerdata.cnt_r_raise_wtsd_won::integer,playerdata.cnt_r_saw::integer,playerdata.cnt_steal_3bet_def_action_fold::integer,playerdata.cnt_steal_3bet_def_opp::integer,playerdata.cnt_steal_att::integer,playerdata.cnt_steal_att_lp::integer,playerdata.cnt_steal_att_sb::integer,playerdata.cnt_steal_def_3bet_opp::integer,playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,playerdata.cnt_steal_def_action_call::integer,playerdata.cnt_steal_def_action_call_vs_lp::integer,playerdata.cnt_steal_def_action_fold::integer,playerdata.cnt_steal_def_action_fold_vs_lp::integer,playerdata.cnt_steal_def_action_raise::integer,playerdata.cnt_steal_def_action_raise_vs_lp::integer,playerdata.cnt_steal_def_opp::integer,playerdata.cnt_steal_def_opp_vs_lp::integer,playerdata.cnt_steal_opp::integer,playerdata.cnt_steal_opp_lp::integer,playerdata.cnt_steal_opp_sb::integer,playerdata.cnt_steal_reraise_def_action_fold::integer,playerdata.cnt_steal_reraise_def_opp::integer,playerdata.cnt_steal_success::integer,playerdata.cnt_t_2bet_def_action_call::integer,playerdata.cnt_t_2bet_def_action_fold::integer,playerdata.cnt_t_3bet::integer,playerdata.cnt_t_3bet_def_action_call::integer,playerdata.cnt_t_3bet_def_action_fold::integer,playerdata.cnt_t_3bet_def_opp::integer,playerdata.cnt_t_3bet_opp::integer,playerdata.cnt_t_4bet::integer,playerdata.cnt_t_4bet_def_action_call::integer,playerdata.cnt_t_4bet_def_action_fold::integer,playerdata.cnt_t_4bet_def_opp::integer,playerdata.cnt_t_4bet_opp::integer,playerdata.cnt_t_allin::integer,playerdata.cnt_t_allin_valid::integer,playerdata.cnt_t_bet::integer,playerdata.cnt_t_bet_def_action_call::integer,playerdata.cnt_t_bet_def_action_fold::integer,playerdata.cnt_t_bet_def_action_raise::integer,playerdata.cnt_t_bet_def_opp::integer,playerdata.cnt_t_call::integer,playerdata.cnt_t_cbet::integer,playerdata.cnt_t_cbet_3bet_pot::integer,playerdata.cnt_t_cbet_def_action_call::integer,playerdata.cnt_t_cbet_def_action_fold::integer,playerdata.cnt_t_cbet_def_action_raise::integer,playerdata.cnt_t_cbet_def_opp::integer,playerdata.cnt_t_cbet_face_raise::integer,playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,playerdata.cnt_t_cbet_fold_to_raise::integer,playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_t_cbet_opp::integer,playerdata.cnt_t_cbet_opp_3bet_pot::integer,playerdata.cnt_t_cbet_success::integer,playerdata.cnt_t_check::integer,playerdata.cnt_t_check_raise::integer,playerdata.cnt_t_check_raise_opp::integer,playerdata.cnt_t_donk::integer,playerdata.cnt_t_donk_3bet_pot::integer,playerdata.cnt_t_donk_def_action_call::integer,playerdata.cnt_t_donk_def_action_fold::integer,playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_t_donk_def_action_raise::integer,playerdata.cnt_t_donk_def_opp::integer,playerdata.cnt_t_donk_def_opp_3bet_pot::integer,playerdata.cnt_t_donk_face_raise::integer,playerdata.cnt_t_donk_fold::integer,playerdata.cnt_t_donk_opp::integer,playerdata.cnt_t_donk_opp_3bet_pot::integer,playerdata.cnt_t_face_xr::integer,playerdata.cnt_t_face_xr_call::integer,playerdata.cnt_t_face_xr_fold::integer,playerdata.cnt_t_face_xr_raise::integer,playerdata.cnt_t_float::integer,playerdata.cnt_t_float_3bet_pot::integer,playerdata.cnt_t_float_def_action_call::integer,playerdata.cnt_t_float_def_action_fold::integer,playerdata.cnt_t_float_def_action_raise::integer,playerdata.cnt_t_float_def_opp::integer,playerdata.cnt_t_float_face_raise::integer,playerdata.cnt_t_float_fold::integer,playerdata.cnt_t_float_opp::integer,playerdata.cnt_t_float_opp_3bet_pot::integer,playerdata.cnt_t_fold::integer,playerdata.cnt_t_probe::integer,playerdata.cnt_t_probe_3bet_pot::integer,playerdata.cnt_t_probe_def_action_call::integer,playerdata.cnt_t_probe_def_action_fold::integer,playerdata.cnt_t_probe_def_action_raise::integer,playerdata.cnt_t_probe_def_opp::integer,playerdata.cnt_t_probe_face_raise::integer,playerdata.cnt_t_probe_fold::integer,playerdata.cnt_t_probe_opp::integer,playerdata.cnt_t_probe_opp_3bet_pot::integer,playerdata.cnt_t_raise::integer,playerdata.cnt_t_raise_wtsd::integer,playerdata.cnt_t_raise_wtsd_won::integer,playerdata.cnt_t_saw::integer,playerdata.cnt_vpip::integer,playerdata.cnt_vpip_sb::integer,playerdata.cnt_walks::integer,playerdata.cnt_won_hand::integer,playerdata.cnt_wtsd::integer,playerdata.cnt_wtsd_allin::integer,playerdata.cnt_wtsd_non_small::integer,playerdata.cnt_wtsd_won::integer,playerdata.cnt_wtsd_won_non_small::integer,playerdata.cnt_wtsd_won_when_r_call::integer,playerdata.limit_currency::text,playerdata.val_equity::numeric(14,2),playerdata.val_f_equity::numeric(14,2),playerdata.val_p_equity::numeric(14,2),playerdata.val_r_equity::numeric(14,2),playerdata.val_t_equity::numeric(14,2));
      CONTINUE;
    END insertCashPlayerDataToCache;
    
  END LOOP getCashPlayersDataToCache;
  
  RETURN;
END;
$_$;


ALTER FUNCTION public.update_cash_cache_playerrange(integer, integer) OWNER TO %USERNAME%;

--
-- TOC entry 225 (class 1255 OID 17402)
-- Name: update_cash_custom_cache(); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_cash_custom_cache() RETURNS void
    LANGUAGE plpgsql
    AS $$

BEGIN
  -- There are no elements to cache so do nothing
  RETURN;
END;
$$;


ALTER FUNCTION public.update_cash_custom_cache() OWNER TO %USERNAME%;

--
-- TOC entry 228 (class 1255 OID 17405)
-- Name: update_cash_custom_cache_date(integer, text); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_cash_custom_cache_date(integer, text) RETURNS void
    LANGUAGE plpgsql
    AS $$

BEGIN
  -- There are no elements to cache so do nothing
  RETURN;
END;
$$;


ALTER FUNCTION public.update_cash_custom_cache_date(integer, text) OWNER TO %USERNAME%;

--
-- TOC entry 226 (class 1255 OID 17403)
-- Name: update_cash_custom_cache_player(integer); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_cash_custom_cache_player(integer) RETURNS void
    LANGUAGE plpgsql
    AS $$

BEGIN
  -- There are no elements to cache so do nothing
  RETURN;
END;
$$;


ALTER FUNCTION public.update_cash_custom_cache_player(integer) OWNER TO %USERNAME%;

--
-- TOC entry 227 (class 1255 OID 17404)
-- Name: update_cash_custom_cache_playerrange(integer, integer); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_cash_custom_cache_playerrange(integer, integer) RETURNS void
    LANGUAGE plpgsql
    AS $$

BEGIN
  -- There are no elements to cache so do nothing
  RETURN;
END;
$$;


ALTER FUNCTION public.update_cash_custom_cache_playerrange(integer, integer) OWNER TO %USERNAME%;

--
-- TOC entry 229 (class 1255 OID 17412)
-- Name: update_tourney_cache(); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_tourney_cache() RETURNS void
    LANGUAGE plpgsql
    AS $$

DECLARE
  dbsetting integer;
  playerdata tourney_cache%ROWTYPE;

BEGIN
  <<getCashPlayersDataToCache>>
  FOR playerdata IN 
    SELECT chps.id_player, chps.id_gametype, chps.id_blinds, chs.cnt_players,((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)), (chps.flg_f_has_position), (chps.flg_t_has_position), (chps.flg_r_has_position), (CAST ( ((date_part('year',  timezone('UTC',  chps.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  chps.date_played  + INTERVAL '0 HOURS')))) AS integer )), (sum( (CASE WHEN ( tourney_blinds.amt_bb) <> 0 THEN ((chps.amt_won * 1.0 )/( tourney_blinds.amt_bb)) ELSE 0 END) )), (sum(chps.amt_blind)), (sum(chps.amt_won)), (sum( (CASE WHEN ( tourney_blinds.amt_bb) <> 0 THEN ((chps.amt_expected_won * 1.0 )/( tourney_blinds.amt_bb)) ELSE 0 END) )), (sum(chps.amt_expected_won)), (sum( (case when( chps.cnt_r_call > 0 AND (chps.amt_r_bet_made + chps.amt_r_raise_made) = 0) then  chps.amt_bet_r else  0  end))), (sum( (case when( chps.cnt_r_call > 0 AND (chps.amt_r_bet_made + chps.amt_r_raise_made) = 0 AND chps.flg_won_hand) then  chps.amt_won + chps.amt_bet_ttl else  0  end))), (sum((case when(chps.flg_blind_b OR chps.flg_blind_s) then  1 else  0 end))), (sum((case when(chps.flg_f_3bet_opp AND ((chps.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(C|XC|BC)%') OR (chps.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(chps.flg_f_3bet_opp AND ((chps.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(F|XF|BF)%') OR (chps.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(chps.flg_f_3bet) then  1 else  0 end))), (sum((case when(chps.enum_f_3bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_f_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_f_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_4bet) then  1 else  0 end))), (sum((case when(chps.enum_f_4bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_f_4bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_f_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_4bet_opp) then  1 else  0 end))), (sum( (case when(chps.enum_allin='F' OR ((chps.enum_face_allin='F' OR chps.enum_face_allin='f') AND chps.enum_face_allin_action<>'N' AND chps.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(chps.val_equity>0 AND (char_length(lookup_actions_f.action) != 0 AND char_length(lookup_actions_t.action) = 0)) then  1 else  0 end) )), (sum((case when(chps.flg_f_bet) then  1 else  0 end))), (sum((case when(chps.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(chps.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(F|XF)')) then  1 else  0 end))), (sum((case when(chps.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(chps.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when(chps.flg_f_bet and NOT(chps.flg_p_face_raise) and chps.cnt_p_raise = 0) then  1 else  0 end))), (sum(chps.cnt_f_call )), (sum((case when(chps.flg_f_cbet) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.enum_f_cbet_action='C') then 1 else 0 end))), (sum((case when( not(chps.flg_f_check) AND chps.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(chps.flg_f_check AND chps.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(not(chps.flg_f_check) AND chps.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_f_check AND chps.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(chps.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(not(chps.flg_f_check) AND chps.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(chps.flg_f_check AND chps.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(chps.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND chps.flg_f_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND chps.flg_f_face_raise and (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND (chps.flg_p_3bet OR chps.flg_p_4bet) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_f_cbet_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet_opp AND (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_f_cbet AND NOT (chps.flg_t_saw) AND NOT (chps.flg_f_face_raise)) then  1 else  0 end))), (sum((case when(chps.flg_f_check) then  1 else  0 end))), (sum((case when(chps.flg_f_check_raise) then  1 else  0 end))), (sum((case when(chps.flg_f_check AND (chps.cnt_f_raise > 0 OR chps.cnt_f_call > 0 OR chps.flg_f_fold)) then  1 else  0 end))), (sum((case when(chps.flg_p_face_raise AND NOT (chps.flg_p_3bet OR chps.flg_p_4bet) AND chps.flg_f_bet AND NOT (chps.flg_f_cbet_opp) AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) or (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND NOT (chps.flg_p_3bet OR chps.flg_p_4bet) AND chps.flg_f_bet AND NOT (chps.flg_f_cbet_opp) AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) or (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and (chps.flg_p_3bet or chps.flg_p_4bet) and chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'C') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (chps.flg_p_3bet OR chps.flg_p_4bet) and chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (chps.flg_p_3bet OR chps.flg_p_4bet) and chps.amt_f_bet_facing > 0 AND NOT (chps.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(chps.flg_p_face_raise AND NOT(chps.flg_p_3bet OR chps.flg_p_4bet) AND lookup_actions_f.action SIMILAR TO 'B_%' AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b))) then 1 else 0 end))), (sum((case when(chps.flg_p_face_raise AND NOT(chps.flg_p_3bet OR chps.flg_p_4bet) AND lookup_actions_f.action = 'BF' AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b))) then 1 else 0 end))), (sum((case when(chps.flg_p_face_raise AND NOT (chps.flg_p_3bet OR chps.flg_p_4bet) AND (chps.flg_f_open_opp) AND NOT (chps.flg_f_cbet_opp) AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) or (chs.cnt_players = 2 AND chps.flg_blind_b))) then  1 else  0  end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND NOT (chps.flg_p_3bet OR chps.flg_p_4bet) AND (chps.flg_f_open_opp) AND NOT (chps.flg_f_cbet_opp) AND ((chs.cnt_players > 2 AND chps.val_p_raise_aggressor_pos < chps.position) or (chs.cnt_players = 2 AND chps.flg_blind_b))) then  1 else  0  end))), (sum((case when(chps.flg_f_bet AND chps.flg_f_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_f) < 2) then '-1' else (substring(chs.str_aggressors_f from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'C' AND chps.flg_f_bet AND chps.flg_f_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_f) < 2) then '-1' else (substring(chs.str_aggressors_f from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'F' AND chps.flg_f_bet AND chps.flg_f_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_f) < 2) then '-1' else (substring(chs.str_aggressors_f from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'R' AND chps.flg_f_bet AND chps.flg_f_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_f) < 2) then '-1' else (substring(chs.str_aggressors_f from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND chps.flg_p_face_raise AND chps.flg_f_bet AND char_length(chs.str_aggressors_p) = 2 AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_f_has_position))) then  1 else  0 end))), (sum((case when( chps.flg_p_first_raise and lookup_actions_p.action = 'RC' and chps.flg_f_has_position and chps.flg_f_bet) then  1 else  0 end))), (sum((case when( not(chps.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' AND chps.flg_f_open_opp AND chps.flg_f_check AND chps.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when( not(chps.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and chps.flg_f_open_opp AND chps.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XC') then  1 else  0 end))), (sum((case when( not(chps.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and chps.flg_f_open_opp AND chps.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XF') then  1 else  0 end))), (sum((case when( not(chps.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and chps.flg_f_open_opp AND chps.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XR') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND chps.flg_p_face_raise AND chps.flg_f_bet AND char_length(chs.str_aggressors_p) = 2 AND ((case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int > chps.position OR chps.flg_f_has_position) and lookup_actions_f.action LIKE 'B_%') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND chps.flg_p_face_raise AND chps.flg_f_bet AND char_length(chs.str_aggressors_p) = 2 AND ((case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int > chps.position OR chps.flg_f_has_position) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND chps.flg_p_face_raise AND chps.flg_f_open_opp AND char_length(chs.str_aggressors_p) = 2 AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_f_has_position))) then  1 else  0 end))), (sum((case when( chps.flg_p_first_raise and lookup_actions_p.action = 'RC' and chps.flg_f_has_position and chps.flg_f_open_opp) then  1 else  0 end))), (sum((case when(chps.flg_f_fold) then  1 else  0 end))), (sum((case when(chps.flg_f_open_opp and not(chps.flg_p_face_raise) and chps.cnt_p_raise = 0) then  1 else  0 end))), (sum(chps.cnt_f_raise)), (sum((case when(chps.flg_f_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_f_saw) then  1 else  0 end))), (sum((case when(chps.flg_won_hand AND chps.flg_f_saw) then  1 else  0 end))), (sum((case when(chps.id_hand > 0) then  1 else  0 end))), (sum((case when(chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 AND ((NOT(chps.flg_p_limp) AND lookup_actions_p.action LIKE 'C%') OR lookup_actions_p.action SIMILAR TO '(C|X)C%')) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 AND ((NOT(chps.flg_p_limp) AND lookup_actions_p.action LIKE 'F') OR lookup_actions_p.action SIMILAR TO '(C|X)F')) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet) then  1 else  0 end))), (sum((case when(chps.enum_p_3bet_action='C') then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise and chps.enum_p_3bet_action = 'C') then  1 else  0 end))), (sum((case when(chps.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.enum_p_3bet_action='F' AND chps.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 3 and chps.enum_p_3bet_action='F' AND chps.flg_p_first_raise AND (case when(char_length(chs.str_aggressors_p) < 3) then '-1' else (substring(chs.str_aggressors_p from 3 for 1)) end)::int > chps.position) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 3 and chps.enum_p_3bet_action='F' AND chps.flg_p_first_raise AND (case when(char_length(chs.str_aggressors_p) < 3) then '-1' else (substring(chs.str_aggressors_p from 3 for 1)) end)::int < chps.position) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise and chps.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_def_opp AND chps.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 3 and chps.flg_p_3bet_def_opp AND chps.flg_p_first_raise AND (case when(char_length(chs.str_aggressors_p) < 3) then '-1' else (substring(chs.str_aggressors_p from 3 for 1)) end)::int > chps.position) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 3 and chps.flg_p_3bet_def_opp AND chps.flg_p_first_raise AND (case when(char_length(chs.str_aggressors_p) < 3) then '-1' else (substring(chs.str_aggressors_p from 3 for 1)) end)::int < chps.position) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 2 and chps.flg_p_3bet_opp AND ((chs.cnt_players BETWEEN 4 and 6 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (chs.cnt_players BETWEEN 7 and 8 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (chs.cnt_players BETWEEN 9 and 10 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 2 and chps.flg_p_3bet_opp AND ((chs.cnt_players BETWEEN 3 and 6 and (case when(char_length(chs.str_aggressors_p) < 2) then '' else (substring(chs.str_aggressors_p from 2 for 1)) end) = '2') OR (chs.cnt_players BETWEEN 7 and 8 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (chs.cnt_players BETWEEN 9 and 10 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet_opp and chs.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_r_cbet_action='C') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chps.flg_won_hand and not(chps.flg_f_saw) and not(chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_t_cbet_action='C') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 2 and chps.flg_p_3bet AND ((chs.cnt_players BETWEEN 4 and 6 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (chs.cnt_players BETWEEN 7 and 8 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (chs.cnt_players BETWEEN 9 and 10 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 2 and chps.flg_p_3bet AND ((chs.cnt_players BETWEEN 3 and 6 and (case when(char_length(chs.str_aggressors_p) < 2) then '' else (substring(chs.str_aggressors_p from 2 for 1)) end) = '2') OR (chs.cnt_players BETWEEN 7 and 8 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (chs.cnt_players BETWEEN 9 and 10 and (case when(char_length(chs.str_aggressors_p) < 2) then '-1' else (substring(chs.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet and chs.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_p_4bet) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise and chps.flg_p_4bet) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet and lookup_actions_p.action LIKE 'R%' and not(chps.flg_p_first_raise) and not(chps.flg_p_3bet)) then  1 else  0 end))), (sum((case when(not(chps.flg_p_limp) and not(chps.flg_p_open_opp) and not(chps.flg_p_first_raise) and chps.amt_p_2bet_facing = 0 and (chps.amt_p_3bet_facing > 0 or chps.amt_p_4bet_facing > 0) and chps.flg_p_4bet_opp ) then  1 else  0 end))), (sum((case when(chps.enum_p_4bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_p_4bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_p_3bet AND chps.enum_p_4bet_action = 'F') then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_3bet AND chps.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_def_opp AND chps.flg_p_first_raise) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_opp AND chps.flg_p_first_raise) then  1 else  0 end))), (sum((case when( char_length(chs.str_aggressors_p) >= 4 AND (case when(char_length(chs.str_aggressors_p) < 4) then '-1' else (substring(chs.str_aggressors_p from 4 for 1)) end)::int != chps.position AND chps.flg_p_4bet) then  1 else  0 end))), (sum((case when(char_length(chs.str_aggressors_p) >= 5 AND chps.flg_p_4bet_def_opp AND chps.enum_folded = 'P' AND (chps.flg_p_4bet OR  NOT(((10 + chps.position -  substring(chs.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(chs.str_aggressors_p) < 4) then '-1' else (substring(chs.str_aggressors_p from 4 for 1)) end)::int -  substring(chs.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))  ), (sum((case when(char_length(chs.str_aggressors_p) >= 5 AND chps.flg_p_4bet_def_opp AND (chps.flg_p_4bet OR   NOT(((10 + chps.position -  substring(chs.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(chs.str_aggressors_p) < 4) then '-1' else (substring(chs.str_aggressors_p from 4 for 1)) end)::int -  substring(chs.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))), (sum((case when(chps.flg_p_4bet_opp and ((not chps.flg_p_3bet_def_opp) OR (chps.enum_p_3bet_action SIMILAR TO '(C|R)' AND chps.flg_p_4bet_def_opp))) then  1 else  0 end))), (sum( (case when(chps.enum_allin='P' OR ((chps.enum_face_allin='P' OR chps.enum_face_allin='p') AND chps.enum_face_allin_action<>'N' AND chps.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(chps.val_equity>0 AND (char_length(lookup_actions_f.action) = 0)) then  1 else  0 end) )), (sum((case when(chps.position=8 AND chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND chps.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(chps.position=8 AND chps.flg_blind_def_opp AND chps.val_p_raise_aggressor_pos=9 AND chps.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(chps.position=8 AND chps.flg_blind_def_opp AND lookup_actions_p.action='C' AND chps.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(chps.position=8 AND chps.flg_blind_def_opp AND lookup_actions_p.action='F' AND chps.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum(chps.cnt_p_call )), (sum((case when(lookup_actions_p.action LIKE 'C%' and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%' AND chps.amt_p_2bet_facing > 0) then  1 else  0 end)) ), (sum((case when(lookup_actions_p.action LIKE 'C%' and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%' AND chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(chps.flg_p_ccall) then  1 else  0 end))), (sum((case when( (chps.enum_p_3bet_action = 'C' and not(chps.flg_p_first_raise) and chps.amt_p_2bet_facing = 0) OR (chps.amt_p_3bet_facing = 0 and chps.enum_p_4bet_action = 'C' and not(chps.flg_p_3bet or chps.flg_p_4bet))) then  1 else  0 end))), (sum((case when( (chps.flg_p_3bet_def_opp and not(chps.flg_p_first_raise) and chps.amt_p_2bet_facing = 0) or (chps.amt_p_3bet_facing = 0 and chps.flg_p_4bet_def_opp and not(chps.flg_p_3bet or chps.flg_p_4bet))) then  1 else  0 end))), (sum((case when(chps.amt_p_2bet_facing > 0 and chps.amt_blind = 0 and not(chps.flg_p_limp)) then  1 else  0 end))), (sum((case when( chps.cnt_p_face_limpers > 0) then  1 else  0 end))), (sum((case when(chps.flg_p_fold) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and chs.str_aggressors_p LIKE '80%' and chs.str_actors_p LIKE '0%' and chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and chs.str_aggressors_p LIKE '81%' and chs.str_actors_p LIKE '1%' and chps.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(chps.flg_p_limp) then  1 else  0 end))), (sum((case when(chps.flg_p_limp AND lookup_actions_p.action LIKE 'CC%') then  1 else  0 end))), (sum((case when(chps.flg_p_limp AND chps.flg_p_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_p_limp AND lookup_actions_p.action = 'CF') then  1 else  0 end))), (sum( (case when( (NOT(chps.flg_p_face_raise) OR (chps.flg_p_limp) OR (chps.flg_p_first_raise)) AND NOT(chps.flg_blind_b)) then  1  else  0  end) )), (sum((case when( chps.cnt_p_face_limpers > 0 AND NOT (chps.flg_blind_b)) then  1 else  0 end))), (sum((case when(chps.flg_p_limp AND lookup_actions_p.action LIKE 'CR%') then  1 else  0 end))), (sum((case when(chps.flg_p_open_opp) then  1 else  0 end))), (sum((case when( chps.position = 0 and chps.flg_p_open_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_open_opp AND ((chs.cnt_players between 4 and 6 and chps.position between 3 and 5) OR (chs.cnt_players between 7 and 8 and chps.position between 4 and 7) OR (chs.cnt_players between 9 and 10 and chps.position between 5 and 7))) then  1 else  0 end))), (sum(chps.cnt_p_raise )), (sum((case when(chps.enum_p_3bet_action = 'R' AND chps.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise AND chps.flg_p_open_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise AND NOT chps.flg_p_open_opp) then  1 else  0 end))), (sum((case when( chps.flg_p_first_raise and chps.flg_p_open_opp and chps.position = 0) then  1 else  0 end))), (sum((case when(chps.flg_p_first_raise AND chps.flg_p_open_opp and ((chs.cnt_players between 4 and 6 and chps.position between 3 and 5) OR (chs.cnt_players between 7 and 8 and chps.position between 4 and 7) OR (chs.cnt_players between 9 and 10 and chps.position between 5 and 7))) then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze) then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_def_opp AND chps.enum_p_squeeze_action='C') then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_def_opp AND chps.enum_p_squeeze_action='F') then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_def_opp AND chps.enum_p_squeeze_action='R') then  1 else  0 end))), (sum((case when(chps.flg_p_squeeze_opp) then  1 else  0 end))), (sum((case when(chps.cnt_p_raise > 0) then  1 else  0 end))), (sum((case when( lookup_actions_p.action LIKE '__%' OR (lookup_actions_p.action LIKE '_' AND (chps.amt_before > (tourney_blinds.amt_bb + chps.amt_ante)) AND (chps.amt_p_raise_facing < (chps.amt_before - (chps.amt_blind + chps.amt_ante))) AND (chps.flg_p_open_opp OR chps.cnt_p_face_limpers > 0 OR chps.flg_p_3bet_opp OR chps.flg_p_4bet_opp) )) then  1 else  0 end))), (sum((case when(chps.flg_p_open = false AND chps.flg_p_limp) then  1 else  0 end))), (sum((case when(chps.flg_r_3bet_opp AND ((chps.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(C|XC|BC)%') OR (chps.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(chps.flg_r_3bet_opp AND ((chps.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(F|XF|BF)%') OR (chps.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(chps.flg_r_3bet) then  1 else  0 end))), (sum((case when(chps.enum_r_3bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_r_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_r_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_4bet) then  1 else  0 end))), (sum((case when(chps.enum_r_4bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_r_4bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_r_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_4bet_opp) then  1 else  0 end))), (sum( (case when(chps.enum_allin='R' OR ((chps.enum_face_allin='R' OR chps.enum_face_allin='r') AND chps.enum_face_allin_action<>'N' AND chps.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(chps.val_equity>0 AND ( char_length(lookup_actions_r.action) != 0)) then  1 else  0 end) )), (sum((case when(chps.flg_r_bet) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0) then  1 else  0 end))), (sum(chps.cnt_r_call )), (sum((case when(chps.cnt_r_call > 0 AND chps.flg_showdown) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND (chps.flg_p_3bet OR chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.enum_r_cbet_action='C') then 1 else 0 end))), (sum((case when(chps.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when(chps.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when(chps.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND chps.flg_r_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND chps.flg_r_face_raise and (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND lookup_actions_r.action LIKE 'BF') then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND (chps.flg_p_3bet or chps.flg_p_4bet) and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_r_cbet_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet_opp AND (chps.flg_p_3bet OR chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_r_cbet AND NOT(chps.flg_r_face_raise) AND NOT(chps.flg_showdown)) then  1 else  0 end))), (sum((case when(chps.flg_r_check) then  1 else  0 end))), (sum((case when(chps.flg_r_check_raise) then  1 else  0 end))), (sum((case when(chps.flg_r_check AND (chps.cnt_r_raise > 0 OR chps.cnt_r_call > 0 OR chps.flg_r_fold)) then  1 else  0 end))), (sum((case when(chps.flg_r_donk) then  1 else  0 end))), (sum((case when(chps.flg_r_donk and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.enum_r_donk_action='C') then  1 else  0 end))), (sum((case when(chps.enum_r_donk_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp or chps.flg_p_4bet_def_opp) and chps.enum_r_donk_action = 'F') then  1 else  0 end))), (sum((case when(chps.enum_r_donk_action='R') then  1 else  0 end))), (sum((case when(chps.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) and chps.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_donk and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_r_donk and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_r_donk_opp) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_r_donk_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND chps.flg_r_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_r) < 2) then '-1' else (substring(chs.str_aggressors_r from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'C' AND chps.flg_r_bet AND chps.flg_r_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_r) < 2) then '-1' else (substring(chs.str_aggressors_r from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'F' AND chps.flg_r_bet AND chps.flg_r_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_r) < 2) then '-1' else (substring(chs.str_aggressors_r from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'R' AND chps.flg_r_bet AND chps.flg_r_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_r) < 2) then '-1' else (substring(chs.str_aggressors_r from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when(chps.flg_r_float) then  1 else  0 end))), (sum((case when(chps.flg_r_float and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.enum_r_float_action='C') then 1 else 0 end))), (sum((case when(chps.enum_r_float_action='F') then 1 else 0 end))), (sum((case when(chps.enum_r_float_action='R') then 1 else 0 end))), (sum((case when(chps.flg_r_float_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_float and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_r_float and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_r_float_opp) then  1 else  0 end))), (sum((case when(chps.flg_r_float_opp and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.flg_r_fold) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND chps.enum_f_cbet_action = 'C' AND ((chs.cnt_players >= 3 and chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND chps.flg_f_check AND chps.enum_f_cbet_action = 'C' AND NOT (chps.flg_f_face_raise) AND ((chs.cnt_players >= 3 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b)) AND (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 and chps.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(chps.flg_r_open_opp) and lookup_actions_r.action LIKE 'C%') then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 and chps.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(chps.flg_r_open_opp) and lookup_actions_r.action = 'F') then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 and chps.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(chps.flg_r_open_opp) and lookup_actions_r.action LIKE 'R%') then  1 else  0 end))), (sum((case when(chps.amt_r_bet_facing > 0 and chps.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(chps.flg_r_open_opp)) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND chps.enum_f_cbet_action = 'C' AND NOT (chps.flg_f_face_raise) and lookup_actions_r.action LIKE 'B_%' AND ((chs.cnt_players >= 3 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND chps.enum_f_cbet_action = 'C' AND NOT (chps.flg_f_face_raise) and lookup_actions_r.action = 'BF' AND ((chs.cnt_players >= 3 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND chps.enum_f_cbet_action = 'C' AND ((chs.cnt_players >= 3 and chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND chps.flg_f_check AND chps.enum_f_cbet_action = 'C' AND NOT (chps.flg_f_face_raise) AND ((chs.cnt_players >= 3 AND chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_b)) AND (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(chps.cnt_r_raise)), (sum((case when(chps.cnt_r_raise > 0 AND chps.flg_showdown) then  1 else  0 end))), (sum((case when(chps.cnt_r_raise > 0 AND chps.flg_showdown AND chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.flg_r_saw) then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND chps.flg_p_3bet_def_opp AND chps.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND chps.flg_p_3bet_def_opp ) then  1 else  0 end))), (sum((case when(chps.flg_steal_att) then  1 else  0 end))), (sum((case when(chps.flg_steal_att and chps.position <= 1) then  1 else  0 end))), (sum((case when(chps.flg_p_open_opp and chps.flg_p_first_raise and chps.position = 9) then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND chps.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp and chs.str_aggressors_p NOT LIKE '89%' AND chps.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%' and chs.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action = 'F') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action = 'F' AND chs.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND chs.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_blind_def_opp and chs.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(chps.flg_steal_opp) then  1 else  0 end))), (sum((case when(chps.flg_steal_opp and chps.position <= 1) then  1 else  0 end))), (sum((case when(chps.flg_p_open_opp and chps.position = 9) then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND chps.flg_p_3bet_def_opp AND chps.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND chps.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_steal_att AND NOT (chps.flg_f_saw) AND NOT (chps.flg_p_face_raise)) then  1 else  0 end))), (sum((case when(chps.flg_t_3bet_opp AND ((chps.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(C|XC|BC)%') OR (chps.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(chps.flg_t_3bet_opp AND ((chps.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(F|XF|BF)%') OR (chps.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(chps.flg_t_3bet) then  1 else  0 end))), (sum((case when(chps.enum_t_3bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_t_3bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_t_3bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_3bet_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_4bet) then  1 else  0 end))), (sum((case when(chps.enum_t_4bet_action='C') then  1 else  0 end))), (sum((case when(chps.enum_t_4bet_action='F') then  1 else  0 end))), (sum((case when(chps.flg_t_4bet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_4bet_opp) then  1 else  0 end))), (sum( (case when(chps.enum_allin='T' OR ((chps.enum_face_allin='T' OR chps.enum_face_allin='t') AND chps.enum_face_allin_action<>'N' AND chps.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(chps.flg_showdown AND ( chps.enum_allin='T' OR ((chps.enum_face_allin='T' OR chps.enum_face_allin='t') AND chps.enum_face_allin_action<>'N' AND chps.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum( (case when(chps.val_equity>0 AND ( char_length(lookup_actions_t.action) != 0 AND char_length(lookup_actions_r.action) = 0)) then  1 else  0 end) )), (sum((case when(chps.flg_t_bet) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0) then  1 else  0 end))), (sum(chps.cnt_t_call )), (sum((case when(chps.flg_t_cbet) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.enum_t_cbet_action='C') then 1 else 0 end))), (sum((case when(chps.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when(chps.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when(chps.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND chps.flg_t_face_raise) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND chps.flg_t_face_raise and (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND lookup_actions_t.action LIKE 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND (chps.flg_p_3bet or chps.flg_p_4bet) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_cbet_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet_opp AND (chps.flg_p_3bet or chps.flg_p_4bet)) then  1 else  0 end))), (sum((case when(chps.flg_t_cbet AND NOT (chps.flg_r_saw) AND NOT (chps.flg_t_face_raise)) then  1 else  0 end))), (sum((case when(chps.flg_t_check) then  1 else  0 end))), (sum((case when(chps.flg_t_check_raise) then  1 else  0 end))), (sum((case when(chps.flg_t_check AND (chps.cnt_t_raise > 0 OR chps.cnt_t_call > 0 OR chps.flg_t_fold)) then  1 else  0 end))), (sum((case when(chps.flg_t_donk) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) and chps.flg_t_donk) then  1 else  0 end))), (sum((case when(chps.enum_t_donk_action='C') then  1 else  0 end))), (sum((case when(chps.enum_t_donk_action='F') then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp or chps.flg_p_4bet_def_opp) and chps.enum_t_donk_action = 'F') then  1 else  0 end))), (sum((case when(chps.enum_t_donk_action='R') then  1 else  0 end))), (sum((case when(chps.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) and chps.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_donk and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_t_donk and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_donk_opp) then  1 else  0 end))), (sum((case when((chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp) AND chps.flg_t_donk_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND chps.flg_t_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_t) < 2) then '-1' else (substring(chs.str_aggressors_t from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'C' AND chps.flg_t_bet AND chps.flg_t_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_t) < 2) then '-1' else (substring(chs.str_aggressors_t from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'F' AND chps.flg_t_bet AND chps.flg_t_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_t) < 2) then '-1' else (substring(chs.str_aggressors_t from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'R' AND chps.flg_t_bet AND chps.flg_t_face_raise AND ((chs.cnt_players > 2 AND (case when(char_length(chs.str_aggressors_t) < 2) then '-1' else (substring(chs.str_aggressors_t from 2 for 1)) end)::int > chps.position) OR (chs.cnt_players = 2 AND chps.flg_blind_s))) then  1 else  0 end))), (sum((case when(chps.flg_t_float) then  1 else  0 end))), (sum((case when(chps.flg_t_float and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.enum_t_float_action='C') then  1 else  0 end))), (sum((case when(chps.enum_t_float_action='F') then  1 else  0 end))), (sum((case when(chps.enum_t_float_action='R') then  1 else  0 end))), (sum((case when(chps.flg_t_float_def_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_float and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_t_float and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_float_opp) then  1 else  0 end))), (sum((case when(chps.flg_t_float_opp and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.flg_t_fold) then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chs.cnt_players >= 3 and chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chps.val_p_raise_aggressor_pos < chps.position AND chs.cnt_players >= 3) OR (chs.cnt_players = 2 and chps.flg_blind_b)) and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 and chps.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(chps.flg_t_open_opp) and lookup_actions_t.action LIKE 'C%') then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 and chps.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(chps.flg_t_open_opp) and lookup_actions_t.action = 'F') then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 and chps.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(chps.flg_t_open_opp) and lookup_actions_t.action LIKE 'R%') then  1 else  0 end))), (sum((case when(chps.amt_t_bet_facing > 0 and chps.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(chps.flg_t_open_opp)) then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chps.val_p_raise_aggressor_pos < chps.position AND chs.cnt_players >= 3) OR (chs.cnt_players = 2 and chps.flg_blind_b)) and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(chps.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chps.val_p_raise_aggressor_pos < chps.position AND chs.cnt_players >= 3) OR (chs.cnt_players = 2 and chps.flg_blind_b)) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(chps.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chs.cnt_players >= 3 and chps.val_p_raise_aggressor_pos < chps.position) OR (chs.cnt_players = 2 and chps.flg_blind_b))) then  1 else  0 end))), (sum((case when(chps.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND chps.flg_p_face_raise AND ((chps.val_p_raise_aggressor_pos < chps.position AND chs.cnt_players >= 3) OR (chs.cnt_players = 2 and chps.flg_blind_b)) and (chps.flg_p_3bet_def_opp OR chps.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(chps.cnt_t_raise)), (sum((case when(chps.cnt_t_raise > 0 AND chps.flg_showdown) then  1 else  0 end))), (sum((case when(chps.cnt_t_raise > 0 AND chps.flg_showdown AND chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.flg_t_saw) then  1 else  0 end))), (sum((case when(chps.flg_vpip) then  1 else  0 end))), (sum((case when(chps.flg_blind_b = false AND chps.flg_blind_s AND chps.flg_vpip) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = '') then  1 else  0 end))), (sum((case when(chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.flg_showdown) then  1 else  0 end))), (sum((case when(chps.flg_showdown and chps.amt_bet_ttl > 5 * tourney_blinds.amt_bb) then  1 else  0 end))), (sum((case when(chps.flg_showdown AND chps.flg_won_hand) then  1 else  0 end))), (sum((case when(chps.flg_showdown and chps.flg_won_hand and chps.amt_bet_ttl > 5 * tourney_blinds.amt_bb) then  1 else  0 end))), (sum((case when(chps.cnt_r_call > 0 AND chps.flg_won_hand AND chps.flg_showdown) then  1 else  0 end))), (sum((case when( chps.enum_allin='P' OR chps.enum_face_allin='P' OR chps.enum_face_allin='p' OR  chps.enum_allin='F' OR chps.enum_face_allin='F' OR chps.enum_face_allin='f' OR  chps.enum_allin='T' OR chps.enum_face_allin='T' OR chps.enum_face_allin='t' OR  chps.enum_allin='R' OR chps.enum_face_allin='R' OR chps.enum_face_allin='r' ) then    ( (case when(chps.enum_allin='P' OR ((chps.enum_face_allin='P' OR chps.enum_face_allin='p') AND  chps.enum_face_allin_action<>'F')) then  chps.val_equity else  0 end) ) +  ( (case when(chps.enum_allin='F' OR ((chps.enum_face_allin='F' OR chps.enum_face_allin='f') AND chps.enum_face_allin_action<>'F')) then  chps.val_equity else  0 end) ) +  ( (case when(chps.enum_allin='T' OR ((chps.enum_face_allin='T' OR chps.enum_face_allin='t') AND  chps.enum_face_allin_action<>'F')) then  chps.val_equity else  0 end) ) +  ( (case when(chps.enum_allin='R' OR ((chps.enum_face_allin='R' OR chps.enum_face_allin='r') AND chps.enum_face_allin_action<>'F')) then  chps.val_equity else  0 end) )   else  0 end))), (sum( (case when(chps.val_equity>0 AND (char_length(lookup_actions_f.action) != 0 AND char_length(lookup_actions_t.action) = 0 AND char_length(lookup_actions_r.action) = 0)) then  chps.val_equity else  0 end) )), (sum( (case when(chps.val_equity>0 AND char_length(lookup_actions_f.action) = 0) then  chps.val_equity else  0 end) )), (sum( (case when(chps.val_equity>0 AND  char_length(lookup_actions_r.action) != 0) then  chps.val_equity else  0 end) )), (sum( (case when(chps.val_equity>0  AND char_length(lookup_actions_t.action) != 0 AND char_length(lookup_actions_r.action) = 0) then  chps.val_equity else  0 end) )) FROM	                 (SELECT * FROM tourney_hand_player_statistics WHERE id_hand > (SELECT CASE WHEN setting_value IS NULL THEN 0 ELSE setting_value::integer END FROM settings WHERE setting_name = 'cache_update:tourney')) as chps , (SELECT * FROM tourney_hand_summary WHERE id_hand > (SELECT CASE WHEN setting_value IS NULL THEN 0 ELSE setting_value::integer END FROM settings WHERE setting_name = 'cache_update:tourney')) as chs, lookup_actions lookup_actions_f, lookup_actions lookup_actions_t, tourney_blinds, lookup_actions lookup_actions_p, lookup_actions lookup_actions_r, lookup_positions WHERE (chs.id_hand = chps.id_hand AND chs.id_blinds = chps.id_blinds)  AND (lookup_actions_f.id_action=chps.id_action_f)  AND (lookup_actions_t.id_action=chps.id_action_t)  AND (tourney_blinds.id_blinds = chps.id_blinds)  AND (lookup_actions_p.id_action=chps.id_action_p)  AND (lookup_actions_r.id_action=chps.id_action_r)  AND (lookup_positions."position"=chps."position" AND lookup_positions.cnt_players=chps.cnt_players_lookup_position)  AND (tourney_blinds.id_blinds = chs.id_blinds)     GROUP BY chps.id_player, chps.id_gametype, chps.id_blinds, chs.cnt_players,  ((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)),  (chps.flg_f_has_position),  (chps.flg_t_has_position),  (chps.flg_r_has_position),  (CAST ( ((date_part('year',  timezone('UTC',  chps.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  chps.date_played  + INTERVAL '0 HOURS')))) AS integer )) 

  LOOP  
    <<updateCashPlayersDataInCache>>
    BEGIN
      UPDATE tourney_cache SET amt_bb_won=amt_bb_won+playerdata.amt_bb_won::numeric(14,2),amt_blind=amt_blind+playerdata.amt_blind::numeric(14,2),amt_chips_won=amt_chips_won+playerdata.amt_chips_won::numeric(14,2),amt_expected_bb_won=amt_expected_bb_won+playerdata.amt_expected_bb_won::numeric(14,2),amt_expected_won=amt_expected_won+playerdata.amt_expected_won::numeric(14,2),amt_r_call=amt_r_call+playerdata.amt_r_call::numeric(14,2),amt_r_call_won=amt_r_call_won+playerdata.amt_r_call_won::numeric(14,2),cnt_blind=cnt_blind+playerdata.cnt_blind::integer,cnt_f_2bet_def_action_call=cnt_f_2bet_def_action_call+playerdata.cnt_f_2bet_def_action_call::integer,cnt_f_2bet_def_action_fold=cnt_f_2bet_def_action_fold+playerdata.cnt_f_2bet_def_action_fold::integer,cnt_f_3bet=cnt_f_3bet+playerdata.cnt_f_3bet::integer,cnt_f_3bet_def_action_call=cnt_f_3bet_def_action_call+playerdata.cnt_f_3bet_def_action_call::integer,cnt_f_3bet_def_action_fold=cnt_f_3bet_def_action_fold+playerdata.cnt_f_3bet_def_action_fold::integer,cnt_f_3bet_def_opp=cnt_f_3bet_def_opp+playerdata.cnt_f_3bet_def_opp::integer,cnt_f_3bet_opp=cnt_f_3bet_opp+playerdata.cnt_f_3bet_opp::integer,cnt_f_4bet=cnt_f_4bet+playerdata.cnt_f_4bet::integer,cnt_f_4bet_def_action_call=cnt_f_4bet_def_action_call+playerdata.cnt_f_4bet_def_action_call::integer,cnt_f_4bet_def_action_fold=cnt_f_4bet_def_action_fold+playerdata.cnt_f_4bet_def_action_fold::integer,cnt_f_4bet_def_opp=cnt_f_4bet_def_opp+playerdata.cnt_f_4bet_def_opp::integer,cnt_f_4bet_opp=cnt_f_4bet_opp+playerdata.cnt_f_4bet_opp::integer,cnt_f_allin=cnt_f_allin+playerdata.cnt_f_allin::integer,cnt_f_allin_valid=cnt_f_allin_valid+playerdata.cnt_f_allin_valid::integer,cnt_f_bet=cnt_f_bet+playerdata.cnt_f_bet::integer,cnt_f_bet_def_action_call=cnt_f_bet_def_action_call+playerdata.cnt_f_bet_def_action_call::integer,cnt_f_bet_def_action_fold=cnt_f_bet_def_action_fold+playerdata.cnt_f_bet_def_action_fold::integer,cnt_f_bet_def_action_raise=cnt_f_bet_def_action_raise+playerdata.cnt_f_bet_def_action_raise::integer,cnt_f_bet_def_opp=cnt_f_bet_def_opp+playerdata.cnt_f_bet_def_opp::integer,cnt_f_bet_limp_pot=cnt_f_bet_limp_pot+playerdata.cnt_f_bet_limp_pot::integer,cnt_f_call=cnt_f_call+playerdata.cnt_f_call::integer,cnt_f_cbet=cnt_f_cbet+playerdata.cnt_f_cbet::integer,cnt_f_cbet_3bet_pot=cnt_f_cbet_3bet_pot+playerdata.cnt_f_cbet_3bet_pot::integer,cnt_f_cbet_def_action_call=cnt_f_cbet_def_action_call+playerdata.cnt_f_cbet_def_action_call::integer,cnt_f_cbet_def_action_call_in_pos=cnt_f_cbet_def_action_call_in_pos+playerdata.cnt_f_cbet_def_action_call_in_pos::integer,cnt_f_cbet_def_action_call_out_of_pos=cnt_f_cbet_def_action_call_out_of_pos+playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,cnt_f_cbet_def_action_fold=cnt_f_cbet_def_action_fold+playerdata.cnt_f_cbet_def_action_fold::integer,cnt_f_cbet_def_action_fold_in_pos=cnt_f_cbet_def_action_fold_in_pos+playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,cnt_f_cbet_def_action_fold_out_of_pos=cnt_f_cbet_def_action_fold_out_of_pos+playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,cnt_f_cbet_def_action_raise=cnt_f_cbet_def_action_raise+playerdata.cnt_f_cbet_def_action_raise::integer,cnt_f_cbet_def_action_raise_in_pos=cnt_f_cbet_def_action_raise_in_pos+playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,cnt_f_cbet_def_action_raise_out_of_pos=cnt_f_cbet_def_action_raise_out_of_pos+playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,cnt_f_cbet_def_opp=cnt_f_cbet_def_opp+playerdata.cnt_f_cbet_def_opp::integer,cnt_f_cbet_face_raise=cnt_f_cbet_face_raise+playerdata.cnt_f_cbet_face_raise::integer,cnt_f_cbet_face_raise_3bet_pot=cnt_f_cbet_face_raise_3bet_pot+playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,cnt_f_cbet_fold_to_raise=cnt_f_cbet_fold_to_raise+playerdata.cnt_f_cbet_fold_to_raise::integer,cnt_f_cbet_fold_to_raise_3bet_pot=cnt_f_cbet_fold_to_raise_3bet_pot+playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,cnt_f_cbet_opp=cnt_f_cbet_opp+playerdata.cnt_f_cbet_opp::integer,cnt_f_cbet_opp_3bet_pot=cnt_f_cbet_opp_3bet_pot+playerdata.cnt_f_cbet_opp_3bet_pot::integer,cnt_f_cbet_success=cnt_f_cbet_success+playerdata.cnt_f_cbet_success::integer,cnt_f_check=cnt_f_check+playerdata.cnt_f_check::integer,cnt_f_check_raise=cnt_f_check_raise+playerdata.cnt_f_check_raise::integer,cnt_f_check_raise_opp=cnt_f_check_raise_opp+playerdata.cnt_f_check_raise_opp::integer,cnt_f_donk=cnt_f_donk+playerdata.cnt_f_donk::integer,cnt_f_donk_3bet_pot=cnt_f_donk_3bet_pot+playerdata.cnt_f_donk_3bet_pot::integer,cnt_f_donk_def_opp=cnt_f_donk_def_opp+playerdata.cnt_f_donk_def_opp::integer,cnt_f_donk_def_opp_3bet_pot=cnt_f_donk_def_opp_3bet_pot+playerdata.cnt_f_donk_def_opp_3bet_pot::integer,cnt_f_donk_def_opp_action_call=cnt_f_donk_def_opp_action_call+playerdata.cnt_f_donk_def_opp_action_call::integer,cnt_f_donk_def_opp_action_fold=cnt_f_donk_def_opp_action_fold+playerdata.cnt_f_donk_def_opp_action_fold::integer,cnt_f_donk_def_opp_action_fold_3bet_pot=cnt_f_donk_def_opp_action_fold_3bet_pot+playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,cnt_f_donk_def_opp_action_raise=cnt_f_donk_def_opp_action_raise+playerdata.cnt_f_donk_def_opp_action_raise::integer,cnt_f_donk_def_opp_action_raise_3bet_pot=cnt_f_donk_def_opp_action_raise_3bet_pot+playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,cnt_f_donk_face_raise=cnt_f_donk_face_raise+playerdata.cnt_f_donk_face_raise::integer,cnt_f_donk_fold=cnt_f_donk_fold+playerdata.cnt_f_donk_fold::integer,cnt_f_donk_opp=cnt_f_donk_opp+playerdata.cnt_f_donk_opp::integer,cnt_f_donk_opp_3bet_pot=cnt_f_donk_opp_3bet_pot+playerdata.cnt_f_donk_opp_3bet_pot::integer,cnt_f_face_xr=cnt_f_face_xr+playerdata.cnt_f_face_xr::integer,cnt_f_face_xr_call=cnt_f_face_xr_call+playerdata.cnt_f_face_xr_call::integer,cnt_f_face_xr_fold=cnt_f_face_xr_fold+playerdata.cnt_f_face_xr_fold::integer,cnt_f_face_xr_raise=cnt_f_face_xr_raise+playerdata.cnt_f_face_xr_raise::integer,cnt_f_float=cnt_f_float+playerdata.cnt_f_float::integer,cnt_f_float_3bet_pot=cnt_f_float_3bet_pot+playerdata.cnt_f_float_3bet_pot::integer,cnt_f_float_def_opp=cnt_f_float_def_opp+playerdata.cnt_f_float_def_opp::integer,cnt_f_float_def_opp_action_call=cnt_f_float_def_opp_action_call+playerdata.cnt_f_float_def_opp_action_call::integer,cnt_f_float_def_opp_action_fold=cnt_f_float_def_opp_action_fold+playerdata.cnt_f_float_def_opp_action_fold::integer,cnt_f_float_def_opp_action_raise=cnt_f_float_def_opp_action_raise+playerdata.cnt_f_float_def_opp_action_raise::integer,cnt_f_float_face_raise=cnt_f_float_face_raise+playerdata.cnt_f_float_face_raise::integer,cnt_f_float_fold=cnt_f_float_fold+playerdata.cnt_f_float_fold::integer,cnt_f_float_opp=cnt_f_float_opp+playerdata.cnt_f_float_opp::integer,cnt_f_float_opp_3bet_pot=cnt_f_float_opp_3bet_pot+playerdata.cnt_f_float_opp_3bet_pot::integer,cnt_f_fold=cnt_f_fold+playerdata.cnt_f_fold::integer,cnt_f_open_opp_limp_pot=cnt_f_open_opp_limp_pot+playerdata.cnt_f_open_opp_limp_pot::integer,cnt_f_raise=cnt_f_raise+playerdata.cnt_f_raise::integer,cnt_f_raise_def_opp=cnt_f_raise_def_opp+playerdata.cnt_f_raise_def_opp::integer,cnt_f_saw=cnt_f_saw+playerdata.cnt_f_saw::integer,cnt_f_saw_won=cnt_f_saw_won+playerdata.cnt_f_saw_won::integer,cnt_hands=cnt_hands+playerdata.cnt_hands::integer,cnt_hands_won=cnt_hands_won+playerdata.cnt_hands_won::integer,cnt_p_2bet_def_action_call=cnt_p_2bet_def_action_call+playerdata.cnt_p_2bet_def_action_call::integer,cnt_p_2bet_def_action_fold=cnt_p_2bet_def_action_fold+playerdata.cnt_p_2bet_def_action_fold::integer,cnt_p_2bet_def_opp=cnt_p_2bet_def_opp+playerdata.cnt_p_2bet_def_opp::integer,cnt_p_2bet_def_opp_vs_btn_open=cnt_p_2bet_def_opp_vs_btn_open+playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,cnt_p_2bet_def_opp_vs_co_open=cnt_p_2bet_def_opp_vs_co_open+playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,cnt_p_3bet=cnt_p_3bet+playerdata.cnt_p_3bet::integer,cnt_p_3bet_def_action_call=cnt_p_3bet_def_action_call+playerdata.cnt_p_3bet_def_action_call::integer,cnt_p_3bet_def_action_call_after_2b=cnt_p_3bet_def_action_call_after_2b+playerdata.cnt_p_3bet_def_action_call_after_2b::integer,cnt_p_3bet_def_action_fold=cnt_p_3bet_def_action_fold+playerdata.cnt_p_3bet_def_action_fold::integer,cnt_p_3bet_def_action_fold_when_open_raised=cnt_p_3bet_def_action_fold_when_open_raised+playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,cnt_p_3bet_def_action_fold_when_open_raised_ip=cnt_p_3bet_def_action_fold_when_open_raised_ip+playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,cnt_p_3bet_def_action_fold_when_open_raised_oop=cnt_p_3bet_def_action_fold_when_open_raised_oop+playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,cnt_p_3bet_def_opp=cnt_p_3bet_def_opp+playerdata.cnt_p_3bet_def_opp::integer,cnt_p_3bet_def_opp_after_2b=cnt_p_3bet_def_opp_after_2b+playerdata.cnt_p_3bet_def_opp_after_2b::integer,cnt_p_3bet_def_opp_when_open_raised=cnt_p_3bet_def_opp_when_open_raised+playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,cnt_p_3bet_def_opp_when_open_raised_ip=cnt_p_3bet_def_opp_when_open_raised_ip+playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,cnt_p_3bet_def_opp_when_open_raised_oop=cnt_p_3bet_def_opp_when_open_raised_oop+playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,cnt_p_3bet_f_cbet_def_action_call=cnt_p_3bet_f_cbet_def_action_call+playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,cnt_p_3bet_f_cbet_def_action_fold=cnt_p_3bet_f_cbet_def_action_fold+playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,cnt_p_3bet_f_cbet_def_action_raise=cnt_p_3bet_f_cbet_def_action_raise+playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,cnt_p_3bet_f_cbet_def_opp=cnt_p_3bet_f_cbet_def_opp+playerdata.cnt_p_3bet_f_cbet_def_opp::integer,cnt_p_3bet_opp=cnt_p_3bet_opp+playerdata.cnt_p_3bet_opp::integer,cnt_p_3bet_opp_vs_bb_2bet=cnt_p_3bet_opp_vs_bb_2bet+playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,cnt_p_3bet_opp_vs_btn_2bet=cnt_p_3bet_opp_vs_btn_2bet+playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,cnt_p_3bet_opp_vs_btn_open=cnt_p_3bet_opp_vs_btn_open+playerdata.cnt_p_3bet_opp_vs_btn_open::integer,cnt_p_3bet_opp_vs_co_2bet=cnt_p_3bet_opp_vs_co_2bet+playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,cnt_p_3bet_opp_vs_co_open=cnt_p_3bet_opp_vs_co_open+playerdata.cnt_p_3bet_opp_vs_co_open::integer,cnt_p_3bet_opp_vs_ep_2bet=cnt_p_3bet_opp_vs_ep_2bet+playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,cnt_p_3bet_opp_vs_mp_2bet=cnt_p_3bet_opp_vs_mp_2bet+playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,cnt_p_3bet_opp_vs_sb_2bet=cnt_p_3bet_opp_vs_sb_2bet+playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,cnt_p_3bet_r_cbet_def_action_call=cnt_p_3bet_r_cbet_def_action_call+playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,cnt_p_3bet_r_cbet_def_action_fold=cnt_p_3bet_r_cbet_def_action_fold+playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,cnt_p_3bet_r_cbet_def_action_raise=cnt_p_3bet_r_cbet_def_action_raise+playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,cnt_p_3bet_r_cbet_def_opp=cnt_p_3bet_r_cbet_def_opp+playerdata.cnt_p_3bet_r_cbet_def_opp::integer,cnt_p_3bet_success=cnt_p_3bet_success+playerdata.cnt_p_3bet_success::integer,cnt_p_3bet_t_cbet_def_action_call=cnt_p_3bet_t_cbet_def_action_call+playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,cnt_p_3bet_t_cbet_def_action_fold=cnt_p_3bet_t_cbet_def_action_fold+playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,cnt_p_3bet_t_cbet_def_action_raise=cnt_p_3bet_t_cbet_def_action_raise+playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,cnt_p_3bet_t_cbet_def_opp=cnt_p_3bet_t_cbet_def_opp+playerdata.cnt_p_3bet_t_cbet_def_opp::integer,cnt_p_3bet_vs_bb_2bet=cnt_p_3bet_vs_bb_2bet+playerdata.cnt_p_3bet_vs_bb_2bet::integer,cnt_p_3bet_vs_btn_2bet=cnt_p_3bet_vs_btn_2bet+playerdata.cnt_p_3bet_vs_btn_2bet::integer,cnt_p_3bet_vs_btn_open=cnt_p_3bet_vs_btn_open+playerdata.cnt_p_3bet_vs_btn_open::integer,cnt_p_3bet_vs_co_2bet=cnt_p_3bet_vs_co_2bet+playerdata.cnt_p_3bet_vs_co_2bet::integer,cnt_p_3bet_vs_co_open=cnt_p_3bet_vs_co_open+playerdata.cnt_p_3bet_vs_co_open::integer,cnt_p_3bet_vs_ep_2bet=cnt_p_3bet_vs_ep_2bet+playerdata.cnt_p_3bet_vs_ep_2bet::integer,cnt_p_3bet_vs_mp_2bet=cnt_p_3bet_vs_mp_2bet+playerdata.cnt_p_3bet_vs_mp_2bet::integer,cnt_p_3bet_vs_sb_2bet=cnt_p_3bet_vs_sb_2bet+playerdata.cnt_p_3bet_vs_sb_2bet::integer,cnt_p_4bet=cnt_p_4bet+playerdata.cnt_p_4bet::integer,cnt_p_4bet_after_raising=cnt_p_4bet_after_raising+playerdata.cnt_p_4bet_after_raising::integer,cnt_p_4bet_cold=cnt_p_4bet_cold+playerdata.cnt_p_4bet_cold::integer,cnt_p_4bet_cold_opp=cnt_p_4bet_cold_opp+playerdata.cnt_p_4bet_cold_opp::integer,cnt_p_4bet_def_action_call=cnt_p_4bet_def_action_call+playerdata.cnt_p_4bet_def_action_call::integer,cnt_p_4bet_def_action_fold=cnt_p_4bet_def_action_fold+playerdata.cnt_p_4bet_def_action_fold::integer,cnt_p_4bet_def_action_fold_after_3b=cnt_p_4bet_def_action_fold_after_3b+playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,cnt_p_4bet_def_opp=cnt_p_4bet_def_opp+playerdata.cnt_p_4bet_def_opp::integer,cnt_p_4bet_def_opp_after_3b=cnt_p_4bet_def_opp_after_3b+playerdata.cnt_p_4bet_def_opp_after_3b::integer,cnt_p_4bet_def_opp_when_open_raised=cnt_p_4bet_def_opp_when_open_raised+playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,cnt_p_4bet_opp=cnt_p_4bet_opp+playerdata.cnt_p_4bet_opp::integer,cnt_p_4bet_opp_when_open_raised=cnt_p_4bet_opp_when_open_raised+playerdata.cnt_p_4bet_opp_when_open_raised::integer,cnt_p_5bet=cnt_p_5bet+playerdata.cnt_p_5bet::integer,cnt_p_5bet_def_action_fold=cnt_p_5bet_def_action_fold+playerdata.cnt_p_5bet_def_action_fold::integer,cnt_p_5bet_def_opp=cnt_p_5bet_def_opp+playerdata.cnt_p_5bet_def_opp::integer,cnt_p_5bet_opp=cnt_p_5bet_opp+playerdata.cnt_p_5bet_opp::integer,cnt_p_allin=cnt_p_allin+playerdata.cnt_p_allin::integer,cnt_p_allin_valid=cnt_p_allin_valid+playerdata.cnt_p_allin_valid::integer,cnt_p_bb_v_sb_3bet=cnt_p_bb_v_sb_3bet+playerdata.cnt_p_bb_v_sb_3bet::integer,cnt_p_bb_v_sb_3bet_opp=cnt_p_bb_v_sb_3bet_opp+playerdata.cnt_p_bb_v_sb_3bet_opp::integer,cnt_p_bb_v_sb_call=cnt_p_bb_v_sb_call+playerdata.cnt_p_bb_v_sb_call::integer,cnt_p_bb_v_sb_fold=cnt_p_bb_v_sb_fold+playerdata.cnt_p_bb_v_sb_fold::integer,cnt_p_call=cnt_p_call+playerdata.cnt_p_call::integer,cnt_p_call_vs_btn_open=cnt_p_call_vs_btn_open+playerdata.cnt_p_call_vs_btn_open::integer,cnt_p_call_vs_co_open=cnt_p_call_vs_co_open+playerdata.cnt_p_call_vs_co_open::integer,cnt_p_ccall=cnt_p_ccall+playerdata.cnt_p_ccall::integer,cnt_p_ccall_3bet=cnt_p_ccall_3bet+playerdata.cnt_p_ccall_3bet::integer,cnt_p_ccall_3bet_opp=cnt_p_ccall_3bet_opp+playerdata.cnt_p_ccall_3bet_opp::integer,cnt_p_ccall_opp=cnt_p_ccall_opp+playerdata.cnt_p_ccall_opp::integer,cnt_p_facing_limpers=cnt_p_facing_limpers+playerdata.cnt_p_facing_limpers::integer,cnt_p_fold=cnt_p_fold+playerdata.cnt_p_fold::integer,cnt_p_fold_vs_btn_open=cnt_p_fold_vs_btn_open+playerdata.cnt_p_fold_vs_btn_open::integer,cnt_p_fold_vs_co_open=cnt_p_fold_vs_co_open+playerdata.cnt_p_fold_vs_co_open::integer,cnt_p_limp=cnt_p_limp+playerdata.cnt_p_limp::integer,cnt_p_limp_call=cnt_p_limp_call+playerdata.cnt_p_limp_call::integer,cnt_p_limp_faceraise=cnt_p_limp_faceraise+playerdata.cnt_p_limp_faceraise::integer,cnt_p_limp_fold=cnt_p_limp_fold+playerdata.cnt_p_limp_fold::integer,cnt_p_limp_opp=cnt_p_limp_opp+playerdata.cnt_p_limp_opp::integer,cnt_p_limp_opp_facing_limpers=cnt_p_limp_opp_facing_limpers+playerdata.cnt_p_limp_opp_facing_limpers::integer,cnt_p_limp_raise=cnt_p_limp_raise+playerdata.cnt_p_limp_raise::integer,cnt_p_open_opp=cnt_p_open_opp+playerdata.cnt_p_open_opp::integer,cnt_p_open_opp_btn=cnt_p_open_opp_btn+playerdata.cnt_p_open_opp_btn::integer,cnt_p_open_opp_ep=cnt_p_open_opp_ep+playerdata.cnt_p_open_opp_ep::integer,cnt_p_raise=cnt_p_raise+playerdata.cnt_p_raise::integer,cnt_p_raise_3bet=cnt_p_raise_3bet+playerdata.cnt_p_raise_3bet::integer,cnt_p_raise_first_in=cnt_p_raise_first_in+playerdata.cnt_p_raise_first_in::integer,cnt_p_raise_limpers=cnt_p_raise_limpers+playerdata.cnt_p_raise_limpers::integer,cnt_p_rfi_btn=cnt_p_rfi_btn+playerdata.cnt_p_rfi_btn::integer,cnt_p_rfi_ep=cnt_p_rfi_ep+playerdata.cnt_p_rfi_ep::integer,cnt_p_squeeze=cnt_p_squeeze+playerdata.cnt_p_squeeze::integer,cnt_p_squeeze_def_call=cnt_p_squeeze_def_call+playerdata.cnt_p_squeeze_def_call::integer,cnt_p_squeeze_def_fold=cnt_p_squeeze_def_fold+playerdata.cnt_p_squeeze_def_fold::integer,cnt_p_squeeze_def_opp=cnt_p_squeeze_def_opp+playerdata.cnt_p_squeeze_def_opp::integer,cnt_p_squeeze_def_raise=cnt_p_squeeze_def_raise+playerdata.cnt_p_squeeze_def_raise::integer,cnt_p_squeeze_opp=cnt_p_squeeze_opp+playerdata.cnt_p_squeeze_opp::integer,cnt_pfr=cnt_pfr+playerdata.cnt_pfr::integer,cnt_pfr_opp=cnt_pfr_opp+playerdata.cnt_pfr_opp::integer,cnt_prev_callers_limp=cnt_prev_callers_limp+playerdata.cnt_prev_callers_limp::integer,cnt_r_2bet_def_action_call=cnt_r_2bet_def_action_call+playerdata.cnt_r_2bet_def_action_call::integer,cnt_r_2bet_def_action_fold=cnt_r_2bet_def_action_fold+playerdata.cnt_r_2bet_def_action_fold::integer,cnt_r_3bet=cnt_r_3bet+playerdata.cnt_r_3bet::integer,cnt_r_3bet_def_action_call=cnt_r_3bet_def_action_call+playerdata.cnt_r_3bet_def_action_call::integer,cnt_r_3bet_def_action_fold=cnt_r_3bet_def_action_fold+playerdata.cnt_r_3bet_def_action_fold::integer,cnt_r_3bet_def_opp=cnt_r_3bet_def_opp+playerdata.cnt_r_3bet_def_opp::integer,cnt_r_3bet_opp=cnt_r_3bet_opp+playerdata.cnt_r_3bet_opp::integer,cnt_r_4bet=cnt_r_4bet+playerdata.cnt_r_4bet::integer,cnt_r_4bet_def_action_call=cnt_r_4bet_def_action_call+playerdata.cnt_r_4bet_def_action_call::integer,cnt_r_4bet_def_action_fold=cnt_r_4bet_def_action_fold+playerdata.cnt_r_4bet_def_action_fold::integer,cnt_r_4bet_def_opp=cnt_r_4bet_def_opp+playerdata.cnt_r_4bet_def_opp::integer,cnt_r_4bet_opp=cnt_r_4bet_opp+playerdata.cnt_r_4bet_opp::integer,cnt_r_allin=cnt_r_allin+playerdata.cnt_r_allin::integer,cnt_r_allin_valid=cnt_r_allin_valid+playerdata.cnt_r_allin_valid::integer,cnt_r_bet=cnt_r_bet+playerdata.cnt_r_bet::integer,cnt_r_bet_def_action_call=cnt_r_bet_def_action_call+playerdata.cnt_r_bet_def_action_call::integer,cnt_r_bet_def_action_fold=cnt_r_bet_def_action_fold+playerdata.cnt_r_bet_def_action_fold::integer,cnt_r_bet_def_action_raise=cnt_r_bet_def_action_raise+playerdata.cnt_r_bet_def_action_raise::integer,cnt_r_bet_def_opp=cnt_r_bet_def_opp+playerdata.cnt_r_bet_def_opp::integer,cnt_r_call=cnt_r_call+playerdata.cnt_r_call::integer,cnt_r_call_hands=cnt_r_call_hands+playerdata.cnt_r_call_hands::integer,cnt_r_cbet=cnt_r_cbet+playerdata.cnt_r_cbet::integer,cnt_r_cbet_3bet_pot=cnt_r_cbet_3bet_pot+playerdata.cnt_r_cbet_3bet_pot::integer,cnt_r_cbet_def_action_call=cnt_r_cbet_def_action_call+playerdata.cnt_r_cbet_def_action_call::integer,cnt_r_cbet_def_action_fold=cnt_r_cbet_def_action_fold+playerdata.cnt_r_cbet_def_action_fold::integer,cnt_r_cbet_def_action_raise=cnt_r_cbet_def_action_raise+playerdata.cnt_r_cbet_def_action_raise::integer,cnt_r_cbet_def_opp=cnt_r_cbet_def_opp+playerdata.cnt_r_cbet_def_opp::integer,cnt_r_cbet_face_raise=cnt_r_cbet_face_raise+playerdata.cnt_r_cbet_face_raise::integer,cnt_r_cbet_face_raise_3bet_pot=cnt_r_cbet_face_raise_3bet_pot+playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,cnt_r_cbet_fold_to_raise=cnt_r_cbet_fold_to_raise+playerdata.cnt_r_cbet_fold_to_raise::integer,cnt_r_cbet_fold_to_raise_3bet_pot=cnt_r_cbet_fold_to_raise_3bet_pot+playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,cnt_r_cbet_opp=cnt_r_cbet_opp+playerdata.cnt_r_cbet_opp::integer,cnt_r_cbet_opp_3bet_pot=cnt_r_cbet_opp_3bet_pot+playerdata.cnt_r_cbet_opp_3bet_pot::integer,cnt_r_cbet_success=cnt_r_cbet_success+playerdata.cnt_r_cbet_success::integer,cnt_r_check=cnt_r_check+playerdata.cnt_r_check::integer,cnt_r_check_raise=cnt_r_check_raise+playerdata.cnt_r_check_raise::integer,cnt_r_check_raise_opp=cnt_r_check_raise_opp+playerdata.cnt_r_check_raise_opp::integer,cnt_r_donk=cnt_r_donk+playerdata.cnt_r_donk::integer,cnt_r_donk_3bet_pot=cnt_r_donk_3bet_pot+playerdata.cnt_r_donk_3bet_pot::integer,cnt_r_donk_def_action_call=cnt_r_donk_def_action_call+playerdata.cnt_r_donk_def_action_call::integer,cnt_r_donk_def_action_fold=cnt_r_donk_def_action_fold+playerdata.cnt_r_donk_def_action_fold::integer,cnt_r_donk_def_action_fold_3bet_pot=cnt_r_donk_def_action_fold_3bet_pot+playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,cnt_r_donk_def_action_raise=cnt_r_donk_def_action_raise+playerdata.cnt_r_donk_def_action_raise::integer,cnt_r_donk_def_opp=cnt_r_donk_def_opp+playerdata.cnt_r_donk_def_opp::integer,cnt_r_donk_def_opp_3bet_pot=cnt_r_donk_def_opp_3bet_pot+playerdata.cnt_r_donk_def_opp_3bet_pot::integer,cnt_r_donk_face_raise=cnt_r_donk_face_raise+playerdata.cnt_r_donk_face_raise::integer,cnt_r_donk_fold=cnt_r_donk_fold+playerdata.cnt_r_donk_fold::integer,cnt_r_donk_opp=cnt_r_donk_opp+playerdata.cnt_r_donk_opp::integer,cnt_r_donk_opp_3bet_pot=cnt_r_donk_opp_3bet_pot+playerdata.cnt_r_donk_opp_3bet_pot::integer,cnt_r_face_xr=cnt_r_face_xr+playerdata.cnt_r_face_xr::integer,cnt_r_face_xr_call=cnt_r_face_xr_call+playerdata.cnt_r_face_xr_call::integer,cnt_r_face_xr_fold=cnt_r_face_xr_fold+playerdata.cnt_r_face_xr_fold::integer,cnt_r_face_xr_raise=cnt_r_face_xr_raise+playerdata.cnt_r_face_xr_raise::integer,cnt_r_float=cnt_r_float+playerdata.cnt_r_float::integer,cnt_r_float_3bet_pot=cnt_r_float_3bet_pot+playerdata.cnt_r_float_3bet_pot::integer,cnt_r_float_def_action_call=cnt_r_float_def_action_call+playerdata.cnt_r_float_def_action_call::integer,cnt_r_float_def_action_fold=cnt_r_float_def_action_fold+playerdata.cnt_r_float_def_action_fold::integer,cnt_r_float_def_action_raise=cnt_r_float_def_action_raise+playerdata.cnt_r_float_def_action_raise::integer,cnt_r_float_def_opp=cnt_r_float_def_opp+playerdata.cnt_r_float_def_opp::integer,cnt_r_float_face_raise=cnt_r_float_face_raise+playerdata.cnt_r_float_face_raise::integer,cnt_r_float_fold=cnt_r_float_fold+playerdata.cnt_r_float_fold::integer,cnt_r_float_opp=cnt_r_float_opp+playerdata.cnt_r_float_opp::integer,cnt_r_float_opp_3bet_pot=cnt_r_float_opp_3bet_pot+playerdata.cnt_r_float_opp_3bet_pot::integer,cnt_r_fold=cnt_r_fold+playerdata.cnt_r_fold::integer,cnt_r_probe=cnt_r_probe+playerdata.cnt_r_probe::integer,cnt_r_probe_3bet_pot=cnt_r_probe_3bet_pot+playerdata.cnt_r_probe_3bet_pot::integer,cnt_r_probe_def_action_call=cnt_r_probe_def_action_call+playerdata.cnt_r_probe_def_action_call::integer,cnt_r_probe_def_action_fold=cnt_r_probe_def_action_fold+playerdata.cnt_r_probe_def_action_fold::integer,cnt_r_probe_def_action_raise=cnt_r_probe_def_action_raise+playerdata.cnt_r_probe_def_action_raise::integer,cnt_r_probe_def_opp=cnt_r_probe_def_opp+playerdata.cnt_r_probe_def_opp::integer,cnt_r_probe_face_raise=cnt_r_probe_face_raise+playerdata.cnt_r_probe_face_raise::integer,cnt_r_probe_fold=cnt_r_probe_fold+playerdata.cnt_r_probe_fold::integer,cnt_r_probe_opp=cnt_r_probe_opp+playerdata.cnt_r_probe_opp::integer,cnt_r_probe_opp_3bet_pot=cnt_r_probe_opp_3bet_pot+playerdata.cnt_r_probe_opp_3bet_pot::integer,cnt_r_raise=cnt_r_raise+playerdata.cnt_r_raise::integer,cnt_r_raise_wtsd=cnt_r_raise_wtsd+playerdata.cnt_r_raise_wtsd::integer,cnt_r_raise_wtsd_won=cnt_r_raise_wtsd_won+playerdata.cnt_r_raise_wtsd_won::integer,cnt_r_saw=cnt_r_saw+playerdata.cnt_r_saw::integer,cnt_steal_3bet_def_action_fold=cnt_steal_3bet_def_action_fold+playerdata.cnt_steal_3bet_def_action_fold::integer,cnt_steal_3bet_def_opp=cnt_steal_3bet_def_opp+playerdata.cnt_steal_3bet_def_opp::integer,cnt_steal_att=cnt_steal_att+playerdata.cnt_steal_att::integer,cnt_steal_att_lp=cnt_steal_att_lp+playerdata.cnt_steal_att_lp::integer,cnt_steal_att_sb=cnt_steal_att_sb+playerdata.cnt_steal_att_sb::integer,cnt_steal_def_3bet_opp=cnt_steal_def_3bet_opp+playerdata.cnt_steal_def_3bet_opp::integer,cnt_steal_def_3bet_opp_vs_lp=cnt_steal_def_3bet_opp_vs_lp+playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,cnt_steal_def_action_call=cnt_steal_def_action_call+playerdata.cnt_steal_def_action_call::integer,cnt_steal_def_action_call_vs_lp=cnt_steal_def_action_call_vs_lp+playerdata.cnt_steal_def_action_call_vs_lp::integer,cnt_steal_def_action_fold=cnt_steal_def_action_fold+playerdata.cnt_steal_def_action_fold::integer,cnt_steal_def_action_fold_vs_lp=cnt_steal_def_action_fold_vs_lp+playerdata.cnt_steal_def_action_fold_vs_lp::integer,cnt_steal_def_action_raise=cnt_steal_def_action_raise+playerdata.cnt_steal_def_action_raise::integer,cnt_steal_def_action_raise_vs_lp=cnt_steal_def_action_raise_vs_lp+playerdata.cnt_steal_def_action_raise_vs_lp::integer,cnt_steal_def_opp=cnt_steal_def_opp+playerdata.cnt_steal_def_opp::integer,cnt_steal_def_opp_vs_lp=cnt_steal_def_opp_vs_lp+playerdata.cnt_steal_def_opp_vs_lp::integer,cnt_steal_opp=cnt_steal_opp+playerdata.cnt_steal_opp::integer,cnt_steal_opp_lp=cnt_steal_opp_lp+playerdata.cnt_steal_opp_lp::integer,cnt_steal_opp_sb=cnt_steal_opp_sb+playerdata.cnt_steal_opp_sb::integer,cnt_steal_reraise_def_action_fold=cnt_steal_reraise_def_action_fold+playerdata.cnt_steal_reraise_def_action_fold::integer,cnt_steal_reraise_def_opp=cnt_steal_reraise_def_opp+playerdata.cnt_steal_reraise_def_opp::integer,cnt_steal_success=cnt_steal_success+playerdata.cnt_steal_success::integer,cnt_t_2bet_def_action_call=cnt_t_2bet_def_action_call+playerdata.cnt_t_2bet_def_action_call::integer,cnt_t_2bet_def_action_fold=cnt_t_2bet_def_action_fold+playerdata.cnt_t_2bet_def_action_fold::integer,cnt_t_3bet=cnt_t_3bet+playerdata.cnt_t_3bet::integer,cnt_t_3bet_def_action_call=cnt_t_3bet_def_action_call+playerdata.cnt_t_3bet_def_action_call::integer,cnt_t_3bet_def_action_fold=cnt_t_3bet_def_action_fold+playerdata.cnt_t_3bet_def_action_fold::integer,cnt_t_3bet_def_opp=cnt_t_3bet_def_opp+playerdata.cnt_t_3bet_def_opp::integer,cnt_t_3bet_opp=cnt_t_3bet_opp+playerdata.cnt_t_3bet_opp::integer,cnt_t_4bet=cnt_t_4bet+playerdata.cnt_t_4bet::integer,cnt_t_4bet_def_action_call=cnt_t_4bet_def_action_call+playerdata.cnt_t_4bet_def_action_call::integer,cnt_t_4bet_def_action_fold=cnt_t_4bet_def_action_fold+playerdata.cnt_t_4bet_def_action_fold::integer,cnt_t_4bet_def_opp=cnt_t_4bet_def_opp+playerdata.cnt_t_4bet_def_opp::integer,cnt_t_4bet_opp=cnt_t_4bet_opp+playerdata.cnt_t_4bet_opp::integer,cnt_t_allin=cnt_t_allin+playerdata.cnt_t_allin::integer,cnt_t_allin_showdown=cnt_t_allin_showdown+playerdata.cnt_t_allin_showdown::integer,cnt_t_allin_valid=cnt_t_allin_valid+playerdata.cnt_t_allin_valid::integer,cnt_t_bet=cnt_t_bet+playerdata.cnt_t_bet::integer,cnt_t_bet_def_action_call=cnt_t_bet_def_action_call+playerdata.cnt_t_bet_def_action_call::integer,cnt_t_bet_def_action_fold=cnt_t_bet_def_action_fold+playerdata.cnt_t_bet_def_action_fold::integer,cnt_t_bet_def_action_raise=cnt_t_bet_def_action_raise+playerdata.cnt_t_bet_def_action_raise::integer,cnt_t_bet_def_opp=cnt_t_bet_def_opp+playerdata.cnt_t_bet_def_opp::integer,cnt_t_call=cnt_t_call+playerdata.cnt_t_call::integer,cnt_t_cbet=cnt_t_cbet+playerdata.cnt_t_cbet::integer,cnt_t_cbet_3bet_pot=cnt_t_cbet_3bet_pot+playerdata.cnt_t_cbet_3bet_pot::integer,cnt_t_cbet_def_action_call=cnt_t_cbet_def_action_call+playerdata.cnt_t_cbet_def_action_call::integer,cnt_t_cbet_def_action_fold=cnt_t_cbet_def_action_fold+playerdata.cnt_t_cbet_def_action_fold::integer,cnt_t_cbet_def_action_raise=cnt_t_cbet_def_action_raise+playerdata.cnt_t_cbet_def_action_raise::integer,cnt_t_cbet_def_opp=cnt_t_cbet_def_opp+playerdata.cnt_t_cbet_def_opp::integer,cnt_t_cbet_face_raise=cnt_t_cbet_face_raise+playerdata.cnt_t_cbet_face_raise::integer,cnt_t_cbet_face_raise_3bet_pot=cnt_t_cbet_face_raise_3bet_pot+playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,cnt_t_cbet_fold_to_raise=cnt_t_cbet_fold_to_raise+playerdata.cnt_t_cbet_fold_to_raise::integer,cnt_t_cbet_fold_to_raise_3bet_pot=cnt_t_cbet_fold_to_raise_3bet_pot+playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,cnt_t_cbet_opp=cnt_t_cbet_opp+playerdata.cnt_t_cbet_opp::integer,cnt_t_cbet_opp_3bet_pot=cnt_t_cbet_opp_3bet_pot+playerdata.cnt_t_cbet_opp_3bet_pot::integer,cnt_t_cbet_success=cnt_t_cbet_success+playerdata.cnt_t_cbet_success::integer,cnt_t_check=cnt_t_check+playerdata.cnt_t_check::integer,cnt_t_check_raise=cnt_t_check_raise+playerdata.cnt_t_check_raise::integer,cnt_t_check_raise_opp=cnt_t_check_raise_opp+playerdata.cnt_t_check_raise_opp::integer,cnt_t_donk=cnt_t_donk+playerdata.cnt_t_donk::integer,cnt_t_donk_3bet_pot=cnt_t_donk_3bet_pot+playerdata.cnt_t_donk_3bet_pot::integer,cnt_t_donk_def_action_call=cnt_t_donk_def_action_call+playerdata.cnt_t_donk_def_action_call::integer,cnt_t_donk_def_action_fold=cnt_t_donk_def_action_fold+playerdata.cnt_t_donk_def_action_fold::integer,cnt_t_donk_def_action_fold_3bet_pot=cnt_t_donk_def_action_fold_3bet_pot+playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,cnt_t_donk_def_action_raise=cnt_t_donk_def_action_raise+playerdata.cnt_t_donk_def_action_raise::integer,cnt_t_donk_def_opp=cnt_t_donk_def_opp+playerdata.cnt_t_donk_def_opp::integer,cnt_t_donk_def_opp_3bet_pot=cnt_t_donk_def_opp_3bet_pot+playerdata.cnt_t_donk_def_opp_3bet_pot::integer,cnt_t_donk_face_raise=cnt_t_donk_face_raise+playerdata.cnt_t_donk_face_raise::integer,cnt_t_donk_fold=cnt_t_donk_fold+playerdata.cnt_t_donk_fold::integer,cnt_t_donk_opp=cnt_t_donk_opp+playerdata.cnt_t_donk_opp::integer,cnt_t_donk_opp_3bet_pot=cnt_t_donk_opp_3bet_pot+playerdata.cnt_t_donk_opp_3bet_pot::integer,cnt_t_face_xr=cnt_t_face_xr+playerdata.cnt_t_face_xr::integer,cnt_t_face_xr_call=cnt_t_face_xr_call+playerdata.cnt_t_face_xr_call::integer,cnt_t_face_xr_fold=cnt_t_face_xr_fold+playerdata.cnt_t_face_xr_fold::integer,cnt_t_face_xr_raise=cnt_t_face_xr_raise+playerdata.cnt_t_face_xr_raise::integer,cnt_t_float=cnt_t_float+playerdata.cnt_t_float::integer,cnt_t_float_3bet_pot=cnt_t_float_3bet_pot+playerdata.cnt_t_float_3bet_pot::integer,cnt_t_float_def_action_call=cnt_t_float_def_action_call+playerdata.cnt_t_float_def_action_call::integer,cnt_t_float_def_action_fold=cnt_t_float_def_action_fold+playerdata.cnt_t_float_def_action_fold::integer,cnt_t_float_def_action_raise=cnt_t_float_def_action_raise+playerdata.cnt_t_float_def_action_raise::integer,cnt_t_float_def_opp=cnt_t_float_def_opp+playerdata.cnt_t_float_def_opp::integer,cnt_t_float_face_raise=cnt_t_float_face_raise+playerdata.cnt_t_float_face_raise::integer,cnt_t_float_fold=cnt_t_float_fold+playerdata.cnt_t_float_fold::integer,cnt_t_float_opp=cnt_t_float_opp+playerdata.cnt_t_float_opp::integer,cnt_t_float_opp_3bet_pot=cnt_t_float_opp_3bet_pot+playerdata.cnt_t_float_opp_3bet_pot::integer,cnt_t_fold=cnt_t_fold+playerdata.cnt_t_fold::integer,cnt_t_probe=cnt_t_probe+playerdata.cnt_t_probe::integer,cnt_t_probe_3bet_pot=cnt_t_probe_3bet_pot+playerdata.cnt_t_probe_3bet_pot::integer,cnt_t_probe_def_action_call=cnt_t_probe_def_action_call+playerdata.cnt_t_probe_def_action_call::integer,cnt_t_probe_def_action_fold=cnt_t_probe_def_action_fold+playerdata.cnt_t_probe_def_action_fold::integer,cnt_t_probe_def_action_raise=cnt_t_probe_def_action_raise+playerdata.cnt_t_probe_def_action_raise::integer,cnt_t_probe_def_opp=cnt_t_probe_def_opp+playerdata.cnt_t_probe_def_opp::integer,cnt_t_probe_face_raise=cnt_t_probe_face_raise+playerdata.cnt_t_probe_face_raise::integer,cnt_t_probe_fold=cnt_t_probe_fold+playerdata.cnt_t_probe_fold::integer,cnt_t_probe_opp=cnt_t_probe_opp+playerdata.cnt_t_probe_opp::integer,cnt_t_probe_opp_3bet_pot=cnt_t_probe_opp_3bet_pot+playerdata.cnt_t_probe_opp_3bet_pot::integer,cnt_t_raise=cnt_t_raise+playerdata.cnt_t_raise::integer,cnt_t_raise_wtsd=cnt_t_raise_wtsd+playerdata.cnt_t_raise_wtsd::integer,cnt_t_raise_wtsd_won=cnt_t_raise_wtsd_won+playerdata.cnt_t_raise_wtsd_won::integer,cnt_t_saw=cnt_t_saw+playerdata.cnt_t_saw::integer,cnt_vpip=cnt_vpip+playerdata.cnt_vpip::integer,cnt_vpip_sb=cnt_vpip_sb+playerdata.cnt_vpip_sb::integer,cnt_walks=cnt_walks+playerdata.cnt_walks::integer,cnt_won_hand=cnt_won_hand+playerdata.cnt_won_hand::integer,cnt_wtsd=cnt_wtsd+playerdata.cnt_wtsd::integer,cnt_wtsd_non_small=cnt_wtsd_non_small+playerdata.cnt_wtsd_non_small::integer,cnt_wtsd_won=cnt_wtsd_won+playerdata.cnt_wtsd_won::integer,cnt_wtsd_won_non_small=cnt_wtsd_won_non_small+playerdata.cnt_wtsd_won_non_small::integer,cnt_wtsd_won_when_r_call=cnt_wtsd_won_when_r_call+playerdata.cnt_wtsd_won_when_r_call::integer,val_equity=val_equity+playerdata.val_equity::numeric(14,2),val_f_equity=val_f_equity+playerdata.val_f_equity::numeric(14,2),val_p_equity=val_p_equity+playerdata.val_p_equity::numeric(14,2),val_r_equity=val_r_equity+playerdata.val_r_equity::numeric(14,2),val_t_equity=val_t_equity+playerdata.val_t_equity::numeric(14,2) WHERE id_player = playerdata.id_player AND id_gametype = playerdata.id_gametype AND id_blinds = playerdata.id_blinds AND cnt_players = playerdata.cnt_players AND position_type = playerdata.position_type AND flg_has_position_f = playerdata.flg_has_position_f AND flg_has_position_t = playerdata.flg_has_position_t AND flg_has_position_r = playerdata.flg_has_position_r AND date_played_year_week = playerdata.date_played_year_week;
      IF found THEN
        CONTINUE;
      END IF;
    END updateCashPlayersDataInCache;      
    
    -- If cache update fails or we are rebuilding the player's cache then insert the data
    <<insertCashPlayerDataToCache>>
    BEGIN
      INSERT INTO tourney_cache VALUES(playerdata.id_player, playerdata.id_gametype, playerdata.id_blinds, playerdata.cnt_players,playerdata.position_type::integer,playerdata.flg_has_position_f::boolean,playerdata.flg_has_position_t::boolean,playerdata.flg_has_position_r::boolean,playerdata.date_played_year_week::integer,playerdata.amt_bb_won::numeric(14,2),playerdata.amt_blind::numeric(14,2),playerdata.amt_chips_won::numeric(14,2),playerdata.amt_expected_bb_won::numeric(14,2),playerdata.amt_expected_won::numeric(14,2),playerdata.amt_r_call::numeric(14,2),playerdata.amt_r_call_won::numeric(14,2),playerdata.cnt_blind::integer,playerdata.cnt_f_2bet_def_action_call::integer,playerdata.cnt_f_2bet_def_action_fold::integer,playerdata.cnt_f_3bet::integer,playerdata.cnt_f_3bet_def_action_call::integer,playerdata.cnt_f_3bet_def_action_fold::integer,playerdata.cnt_f_3bet_def_opp::integer,playerdata.cnt_f_3bet_opp::integer,playerdata.cnt_f_4bet::integer,playerdata.cnt_f_4bet_def_action_call::integer,playerdata.cnt_f_4bet_def_action_fold::integer,playerdata.cnt_f_4bet_def_opp::integer,playerdata.cnt_f_4bet_opp::integer,playerdata.cnt_f_allin::integer,playerdata.cnt_f_allin_valid::integer,playerdata.cnt_f_bet::integer,playerdata.cnt_f_bet_def_action_call::integer,playerdata.cnt_f_bet_def_action_fold::integer,playerdata.cnt_f_bet_def_action_raise::integer,playerdata.cnt_f_bet_def_opp::integer,playerdata.cnt_f_bet_limp_pot::integer,playerdata.cnt_f_call::integer,playerdata.cnt_f_cbet::integer,playerdata.cnt_f_cbet_3bet_pot::integer,playerdata.cnt_f_cbet_def_action_call::integer,playerdata.cnt_f_cbet_def_action_call_in_pos::integer,playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_fold::integer,playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_raise::integer,playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,playerdata.cnt_f_cbet_def_opp::integer,playerdata.cnt_f_cbet_face_raise::integer,playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,playerdata.cnt_f_cbet_fold_to_raise::integer,playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_f_cbet_opp::integer,playerdata.cnt_f_cbet_opp_3bet_pot::integer,playerdata.cnt_f_cbet_success::integer,playerdata.cnt_f_check::integer,playerdata.cnt_f_check_raise::integer,playerdata.cnt_f_check_raise_opp::integer,playerdata.cnt_f_donk::integer,playerdata.cnt_f_donk_3bet_pot::integer,playerdata.cnt_f_donk_def_opp::integer,playerdata.cnt_f_donk_def_opp_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_call::integer,playerdata.cnt_f_donk_def_opp_action_fold::integer,playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_raise::integer,playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,playerdata.cnt_f_donk_face_raise::integer,playerdata.cnt_f_donk_fold::integer,playerdata.cnt_f_donk_opp::integer,playerdata.cnt_f_donk_opp_3bet_pot::integer,playerdata.cnt_f_face_xr::integer,playerdata.cnt_f_face_xr_call::integer,playerdata.cnt_f_face_xr_fold::integer,playerdata.cnt_f_face_xr_raise::integer,playerdata.cnt_f_float::integer,playerdata.cnt_f_float_3bet_pot::integer,playerdata.cnt_f_float_def_opp::integer,playerdata.cnt_f_float_def_opp_action_call::integer,playerdata.cnt_f_float_def_opp_action_fold::integer,playerdata.cnt_f_float_def_opp_action_raise::integer,playerdata.cnt_f_float_face_raise::integer,playerdata.cnt_f_float_fold::integer,playerdata.cnt_f_float_opp::integer,playerdata.cnt_f_float_opp_3bet_pot::integer,playerdata.cnt_f_fold::integer,playerdata.cnt_f_open_opp_limp_pot::integer,playerdata.cnt_f_raise::integer,playerdata.cnt_f_raise_def_opp::integer,playerdata.cnt_f_saw::integer,playerdata.cnt_f_saw_won::integer,playerdata.cnt_hands::integer,playerdata.cnt_hands_won::integer,playerdata.cnt_p_2bet_def_action_call::integer,playerdata.cnt_p_2bet_def_action_fold::integer,playerdata.cnt_p_2bet_def_opp::integer,playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,playerdata.cnt_p_3bet::integer,playerdata.cnt_p_3bet_def_action_call::integer,playerdata.cnt_p_3bet_def_action_call_after_2b::integer,playerdata.cnt_p_3bet_def_action_fold::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,playerdata.cnt_p_3bet_def_opp::integer,playerdata.cnt_p_3bet_def_opp_after_2b::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_f_cbet_def_opp::integer,playerdata.cnt_p_3bet_opp::integer,playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_open::integer,playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,playerdata.cnt_p_3bet_opp_vs_co_open::integer,playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_r_cbet_def_opp::integer,playerdata.cnt_p_3bet_success::integer,playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_t_cbet_def_opp::integer,playerdata.cnt_p_3bet_vs_bb_2bet::integer,playerdata.cnt_p_3bet_vs_btn_2bet::integer,playerdata.cnt_p_3bet_vs_btn_open::integer,playerdata.cnt_p_3bet_vs_co_2bet::integer,playerdata.cnt_p_3bet_vs_co_open::integer,playerdata.cnt_p_3bet_vs_ep_2bet::integer,playerdata.cnt_p_3bet_vs_mp_2bet::integer,playerdata.cnt_p_3bet_vs_sb_2bet::integer,playerdata.cnt_p_4bet::integer,playerdata.cnt_p_4bet_after_raising::integer,playerdata.cnt_p_4bet_cold::integer,playerdata.cnt_p_4bet_cold_opp::integer,playerdata.cnt_p_4bet_def_action_call::integer,playerdata.cnt_p_4bet_def_action_fold::integer,playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,playerdata.cnt_p_4bet_def_opp::integer,playerdata.cnt_p_4bet_def_opp_after_3b::integer,playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,playerdata.cnt_p_4bet_opp::integer,playerdata.cnt_p_4bet_opp_when_open_raised::integer,playerdata.cnt_p_5bet::integer,playerdata.cnt_p_5bet_def_action_fold::integer,playerdata.cnt_p_5bet_def_opp::integer,playerdata.cnt_p_5bet_opp::integer,playerdata.cnt_p_allin::integer,playerdata.cnt_p_allin_valid::integer,playerdata.cnt_p_bb_v_sb_3bet::integer,playerdata.cnt_p_bb_v_sb_3bet_opp::integer,playerdata.cnt_p_bb_v_sb_call::integer,playerdata.cnt_p_bb_v_sb_fold::integer,playerdata.cnt_p_call::integer,playerdata.cnt_p_call_vs_btn_open::integer,playerdata.cnt_p_call_vs_co_open::integer,playerdata.cnt_p_ccall::integer,playerdata.cnt_p_ccall_3bet::integer,playerdata.cnt_p_ccall_3bet_opp::integer,playerdata.cnt_p_ccall_opp::integer,playerdata.cnt_p_facing_limpers::integer,playerdata.cnt_p_fold::integer,playerdata.cnt_p_fold_vs_btn_open::integer,playerdata.cnt_p_fold_vs_co_open::integer,playerdata.cnt_p_limp::integer,playerdata.cnt_p_limp_call::integer,playerdata.cnt_p_limp_faceraise::integer,playerdata.cnt_p_limp_fold::integer,playerdata.cnt_p_limp_opp::integer,playerdata.cnt_p_limp_opp_facing_limpers::integer,playerdata.cnt_p_limp_raise::integer,playerdata.cnt_p_open_opp::integer,playerdata.cnt_p_open_opp_btn::integer,playerdata.cnt_p_open_opp_ep::integer,playerdata.cnt_p_raise::integer,playerdata.cnt_p_raise_3bet::integer,playerdata.cnt_p_raise_first_in::integer,playerdata.cnt_p_raise_limpers::integer,playerdata.cnt_p_rfi_btn::integer,playerdata.cnt_p_rfi_ep::integer,playerdata.cnt_p_squeeze::integer,playerdata.cnt_p_squeeze_def_call::integer,playerdata.cnt_p_squeeze_def_fold::integer,playerdata.cnt_p_squeeze_def_opp::integer,playerdata.cnt_p_squeeze_def_raise::integer,playerdata.cnt_p_squeeze_opp::integer,playerdata.cnt_pfr::integer,playerdata.cnt_pfr_opp::integer,playerdata.cnt_prev_callers_limp::integer,playerdata.cnt_r_2bet_def_action_call::integer,playerdata.cnt_r_2bet_def_action_fold::integer,playerdata.cnt_r_3bet::integer,playerdata.cnt_r_3bet_def_action_call::integer,playerdata.cnt_r_3bet_def_action_fold::integer,playerdata.cnt_r_3bet_def_opp::integer,playerdata.cnt_r_3bet_opp::integer,playerdata.cnt_r_4bet::integer,playerdata.cnt_r_4bet_def_action_call::integer,playerdata.cnt_r_4bet_def_action_fold::integer,playerdata.cnt_r_4bet_def_opp::integer,playerdata.cnt_r_4bet_opp::integer,playerdata.cnt_r_allin::integer,playerdata.cnt_r_allin_valid::integer,playerdata.cnt_r_bet::integer,playerdata.cnt_r_bet_def_action_call::integer,playerdata.cnt_r_bet_def_action_fold::integer,playerdata.cnt_r_bet_def_action_raise::integer,playerdata.cnt_r_bet_def_opp::integer,playerdata.cnt_r_call::integer,playerdata.cnt_r_call_hands::integer,playerdata.cnt_r_cbet::integer,playerdata.cnt_r_cbet_3bet_pot::integer,playerdata.cnt_r_cbet_def_action_call::integer,playerdata.cnt_r_cbet_def_action_fold::integer,playerdata.cnt_r_cbet_def_action_raise::integer,playerdata.cnt_r_cbet_def_opp::integer,playerdata.cnt_r_cbet_face_raise::integer,playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,playerdata.cnt_r_cbet_fold_to_raise::integer,playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_r_cbet_opp::integer,playerdata.cnt_r_cbet_opp_3bet_pot::integer,playerdata.cnt_r_cbet_success::integer,playerdata.cnt_r_check::integer,playerdata.cnt_r_check_raise::integer,playerdata.cnt_r_check_raise_opp::integer,playerdata.cnt_r_donk::integer,playerdata.cnt_r_donk_3bet_pot::integer,playerdata.cnt_r_donk_def_action_call::integer,playerdata.cnt_r_donk_def_action_fold::integer,playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_r_donk_def_action_raise::integer,playerdata.cnt_r_donk_def_opp::integer,playerdata.cnt_r_donk_def_opp_3bet_pot::integer,playerdata.cnt_r_donk_face_raise::integer,playerdata.cnt_r_donk_fold::integer,playerdata.cnt_r_donk_opp::integer,playerdata.cnt_r_donk_opp_3bet_pot::integer,playerdata.cnt_r_face_xr::integer,playerdata.cnt_r_face_xr_call::integer,playerdata.cnt_r_face_xr_fold::integer,playerdata.cnt_r_face_xr_raise::integer,playerdata.cnt_r_float::integer,playerdata.cnt_r_float_3bet_pot::integer,playerdata.cnt_r_float_def_action_call::integer,playerdata.cnt_r_float_def_action_fold::integer,playerdata.cnt_r_float_def_action_raise::integer,playerdata.cnt_r_float_def_opp::integer,playerdata.cnt_r_float_face_raise::integer,playerdata.cnt_r_float_fold::integer,playerdata.cnt_r_float_opp::integer,playerdata.cnt_r_float_opp_3bet_pot::integer,playerdata.cnt_r_fold::integer,playerdata.cnt_r_probe::integer,playerdata.cnt_r_probe_3bet_pot::integer,playerdata.cnt_r_probe_def_action_call::integer,playerdata.cnt_r_probe_def_action_fold::integer,playerdata.cnt_r_probe_def_action_raise::integer,playerdata.cnt_r_probe_def_opp::integer,playerdata.cnt_r_probe_face_raise::integer,playerdata.cnt_r_probe_fold::integer,playerdata.cnt_r_probe_opp::integer,playerdata.cnt_r_probe_opp_3bet_pot::integer,playerdata.cnt_r_raise::integer,playerdata.cnt_r_raise_wtsd::integer,playerdata.cnt_r_raise_wtsd_won::integer,playerdata.cnt_r_saw::integer,playerdata.cnt_steal_3bet_def_action_fold::integer,playerdata.cnt_steal_3bet_def_opp::integer,playerdata.cnt_steal_att::integer,playerdata.cnt_steal_att_lp::integer,playerdata.cnt_steal_att_sb::integer,playerdata.cnt_steal_def_3bet_opp::integer,playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,playerdata.cnt_steal_def_action_call::integer,playerdata.cnt_steal_def_action_call_vs_lp::integer,playerdata.cnt_steal_def_action_fold::integer,playerdata.cnt_steal_def_action_fold_vs_lp::integer,playerdata.cnt_steal_def_action_raise::integer,playerdata.cnt_steal_def_action_raise_vs_lp::integer,playerdata.cnt_steal_def_opp::integer,playerdata.cnt_steal_def_opp_vs_lp::integer,playerdata.cnt_steal_opp::integer,playerdata.cnt_steal_opp_lp::integer,playerdata.cnt_steal_opp_sb::integer,playerdata.cnt_steal_reraise_def_action_fold::integer,playerdata.cnt_steal_reraise_def_opp::integer,playerdata.cnt_steal_success::integer,playerdata.cnt_t_2bet_def_action_call::integer,playerdata.cnt_t_2bet_def_action_fold::integer,playerdata.cnt_t_3bet::integer,playerdata.cnt_t_3bet_def_action_call::integer,playerdata.cnt_t_3bet_def_action_fold::integer,playerdata.cnt_t_3bet_def_opp::integer,playerdata.cnt_t_3bet_opp::integer,playerdata.cnt_t_4bet::integer,playerdata.cnt_t_4bet_def_action_call::integer,playerdata.cnt_t_4bet_def_action_fold::integer,playerdata.cnt_t_4bet_def_opp::integer,playerdata.cnt_t_4bet_opp::integer,playerdata.cnt_t_allin::integer,playerdata.cnt_t_allin_showdown::integer,playerdata.cnt_t_allin_valid::integer,playerdata.cnt_t_bet::integer,playerdata.cnt_t_bet_def_action_call::integer,playerdata.cnt_t_bet_def_action_fold::integer,playerdata.cnt_t_bet_def_action_raise::integer,playerdata.cnt_t_bet_def_opp::integer,playerdata.cnt_t_call::integer,playerdata.cnt_t_cbet::integer,playerdata.cnt_t_cbet_3bet_pot::integer,playerdata.cnt_t_cbet_def_action_call::integer,playerdata.cnt_t_cbet_def_action_fold::integer,playerdata.cnt_t_cbet_def_action_raise::integer,playerdata.cnt_t_cbet_def_opp::integer,playerdata.cnt_t_cbet_face_raise::integer,playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,playerdata.cnt_t_cbet_fold_to_raise::integer,playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_t_cbet_opp::integer,playerdata.cnt_t_cbet_opp_3bet_pot::integer,playerdata.cnt_t_cbet_success::integer,playerdata.cnt_t_check::integer,playerdata.cnt_t_check_raise::integer,playerdata.cnt_t_check_raise_opp::integer,playerdata.cnt_t_donk::integer,playerdata.cnt_t_donk_3bet_pot::integer,playerdata.cnt_t_donk_def_action_call::integer,playerdata.cnt_t_donk_def_action_fold::integer,playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_t_donk_def_action_raise::integer,playerdata.cnt_t_donk_def_opp::integer,playerdata.cnt_t_donk_def_opp_3bet_pot::integer,playerdata.cnt_t_donk_face_raise::integer,playerdata.cnt_t_donk_fold::integer,playerdata.cnt_t_donk_opp::integer,playerdata.cnt_t_donk_opp_3bet_pot::integer,playerdata.cnt_t_face_xr::integer,playerdata.cnt_t_face_xr_call::integer,playerdata.cnt_t_face_xr_fold::integer,playerdata.cnt_t_face_xr_raise::integer,playerdata.cnt_t_float::integer,playerdata.cnt_t_float_3bet_pot::integer,playerdata.cnt_t_float_def_action_call::integer,playerdata.cnt_t_float_def_action_fold::integer,playerdata.cnt_t_float_def_action_raise::integer,playerdata.cnt_t_float_def_opp::integer,playerdata.cnt_t_float_face_raise::integer,playerdata.cnt_t_float_fold::integer,playerdata.cnt_t_float_opp::integer,playerdata.cnt_t_float_opp_3bet_pot::integer,playerdata.cnt_t_fold::integer,playerdata.cnt_t_probe::integer,playerdata.cnt_t_probe_3bet_pot::integer,playerdata.cnt_t_probe_def_action_call::integer,playerdata.cnt_t_probe_def_action_fold::integer,playerdata.cnt_t_probe_def_action_raise::integer,playerdata.cnt_t_probe_def_opp::integer,playerdata.cnt_t_probe_face_raise::integer,playerdata.cnt_t_probe_fold::integer,playerdata.cnt_t_probe_opp::integer,playerdata.cnt_t_probe_opp_3bet_pot::integer,playerdata.cnt_t_raise::integer,playerdata.cnt_t_raise_wtsd::integer,playerdata.cnt_t_raise_wtsd_won::integer,playerdata.cnt_t_saw::integer,playerdata.cnt_vpip::integer,playerdata.cnt_vpip_sb::integer,playerdata.cnt_walks::integer,playerdata.cnt_won_hand::integer,playerdata.cnt_wtsd::integer,playerdata.cnt_wtsd_non_small::integer,playerdata.cnt_wtsd_won::integer,playerdata.cnt_wtsd_won_non_small::integer,playerdata.cnt_wtsd_won_when_r_call::integer,playerdata.val_equity::numeric(14,2),playerdata.val_f_equity::numeric(14,2),playerdata.val_p_equity::numeric(14,2),playerdata.val_r_equity::numeric(14,2),playerdata.val_t_equity::numeric(14,2));
      CONTINUE;
    END insertCashPlayerDataToCache;
    
  END LOOP getCashPlayersDataToCache;
  
  <<updateLastIdHandCached>>
  BEGIN
    UPDATE settings SET setting_value = ( SELECT CASE WHEN max(id_hand) IS NULL THEN 0 ELSE max(id_hand) END FROM tourney_hand_player_statistics ) WHERE setting_name = 'cache_update:tourney';
    IF NOT FOUND THEN
      INSERT INTO settings (setting_name, setting_value) VALUES ( 'cache_update:tourney', ( SELECT CASE WHEN max(id_hand) IS NULL THEN 0 ELSE max(id_hand) END FROM tourney_hand_player_statistics ) );
    END IF;
  END updateLastIdHandCached;
  
  RETURN;
END;
$$;


ALTER FUNCTION public.update_tourney_cache() OWNER TO %USERNAME%;

--
-- TOC entry 232 (class 1255 OID 17418)
-- Name: update_tourney_cache_date(integer, integer[]); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_tourney_cache_date(integer, integer[]) RETURNS void
    LANGUAGE plpgsql
    AS $_$

DECLARE
  playerdata tourney_cache%ROWTYPE;

BEGIN
  <<deletePlayersCache>>
  BEGIN
    DELETE FROM tourney_cache WHERE id_player = $1 AND date_played_year_week = ANY ($2);
  END deletePlayersCache;

  <<getCashPlayersDataToCache>>
  FOR playerdata IN 
    SELECT tourney_hand_player_statistics.id_player, tourney_hand_player_statistics.id_gametype, tourney_hand_player_statistics.id_blinds, tourney_hand_summary.cnt_players,((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)), (tourney_hand_player_statistics.flg_f_has_position), (tourney_hand_player_statistics.flg_t_has_position), (tourney_hand_player_statistics.flg_r_has_position), (CAST ( ((date_part('year',  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )), (sum( (CASE WHEN ( tourney_blinds.amt_bb) <> 0 THEN ((tourney_hand_player_statistics.amt_won * 1.0 )/( tourney_blinds.amt_bb)) ELSE 0 END) )), (sum(tourney_hand_player_statistics.amt_blind)), (sum(tourney_hand_player_statistics.amt_won)), (sum( (CASE WHEN ( tourney_blinds.amt_bb) <> 0 THEN ((tourney_hand_player_statistics.amt_expected_won * 1.0 )/( tourney_blinds.amt_bb)) ELSE 0 END) )), (sum(tourney_hand_player_statistics.amt_expected_won)), (sum( (case when( tourney_hand_player_statistics.cnt_r_call > 0 AND (tourney_hand_player_statistics.amt_r_bet_made + tourney_hand_player_statistics.amt_r_raise_made) = 0) then  tourney_hand_player_statistics.amt_bet_r else  0  end))), (sum( (case when( tourney_hand_player_statistics.cnt_r_call > 0 AND (tourney_hand_player_statistics.amt_r_bet_made + tourney_hand_player_statistics.amt_r_raise_made) = 0 AND tourney_hand_player_statistics.flg_won_hand) then  tourney_hand_player_statistics.amt_won + tourney_hand_player_statistics.amt_bet_ttl else  0  end))), (sum((case when(tourney_hand_player_statistics.flg_blind_b OR tourney_hand_player_statistics.flg_blind_s) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp AND ((tourney_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp AND ((tourney_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='F' OR ((tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) != 0 AND char_length(lookup_actions_t.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(F|XF)')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_bet and NOT(tourney_hand_player_statistics.flg_p_face_raise) and tourney_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_f_call )), (sum((case when(tourney_hand_player_statistics.flg_f_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='C') then 1 else 0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND tourney_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND tourney_hand_player_statistics.flg_f_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND NOT (tourney_hand_player_statistics.flg_t_saw) AND NOT (tourney_hand_player_statistics.flg_f_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND (tourney_hand_player_statistics.cnt_f_raise > 0 OR tourney_hand_player_statistics.cnt_f_call > 0 OR tourney_hand_player_statistics.flg_f_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND tourney_hand_player_statistics.flg_f_bet AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND tourney_hand_player_statistics.flg_f_bet AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'C') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT(tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action SIMILAR TO 'B_%' AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT(tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action = 'BF' AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND (tourney_hand_player_statistics.flg_f_open_opp) AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND (tourney_hand_player_statistics.flg_f_open_opp) AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when(tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and tourney_hand_player_statistics.flg_f_has_position and tourney_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XC') then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XF') then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XR') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position OR tourney_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action LIKE 'B_%') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position OR tourney_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_open_opp AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and tourney_hand_player_statistics.flg_f_has_position and tourney_hand_player_statistics.flg_f_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_open_opp and not(tourney_hand_player_statistics.flg_p_face_raise) and tourney_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_f_raise)), (sum((case when(tourney_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand AND tourney_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.id_hand > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(tourney_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'C%') OR lookup_actions_p.action SIMILAR TO '(C|X)C%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(tourney_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'F') OR lookup_actions_p.action SIMILAR TO '(C|X)F')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.enum_p_3bet_action = 'C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int > tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int < tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int > tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int < tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet_opp AND ((tourney_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet_opp AND ((tourney_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_player_statistics.flg_won_hand and not(tourney_hand_player_statistics.flg_f_saw) and not(tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet AND ((tourney_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet AND ((tourney_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet and lookup_actions_p.action LIKE 'R%' and not(tourney_hand_player_statistics.flg_p_first_raise) and not(tourney_hand_player_statistics.flg_p_3bet)) then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_p_limp) and not(tourney_hand_player_statistics.flg_p_open_opp) and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0 and (tourney_hand_player_statistics.amt_p_3bet_facing > 0 or tourney_hand_player_statistics.amt_p_4bet_facing > 0) and tourney_hand_player_statistics.flg_p_4bet_opp ) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet AND tourney_hand_player_statistics.enum_p_4bet_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet AND tourney_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when( char_length(tourney_hand_summary.str_aggressors_p) >= 4 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int != tourney_hand_player_statistics.position AND tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 5 AND tourney_hand_player_statistics.flg_p_4bet_def_opp AND tourney_hand_player_statistics.enum_folded = 'P' AND (tourney_hand_player_statistics.flg_p_4bet OR  NOT(((10 + tourney_hand_player_statistics.position -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))  ), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 5 AND tourney_hand_player_statistics.flg_p_4bet_def_opp AND (tourney_hand_player_statistics.flg_p_4bet OR   NOT(((10 + tourney_hand_player_statistics.position -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp and ((not tourney_hand_player_statistics.flg_p_3bet_def_opp) OR (tourney_hand_player_statistics.enum_p_3bet_action SIMILAR TO '(C|R)' AND tourney_hand_player_statistics.flg_p_4bet_def_opp))) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='P' OR ((tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9 AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='C' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='F' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_p_call )), (sum((case when(lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%' AND tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end)) ), (sum((case when(lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%' AND tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_ccall) then  1 else  0 end))), (sum((case when( (tourney_hand_player_statistics.enum_p_3bet_action = 'C' and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0) OR (tourney_hand_player_statistics.amt_p_3bet_facing = 0 and tourney_hand_player_statistics.enum_p_4bet_action = 'C' and not(tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when( (tourney_hand_player_statistics.flg_p_3bet_def_opp and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0) or (tourney_hand_player_statistics.amt_p_3bet_facing = 0 and tourney_hand_player_statistics.flg_p_4bet_def_opp and not(tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_player_statistics.amt_blind = 0 and not(tourney_hand_player_statistics.flg_p_limp)) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.cnt_p_face_limpers > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_fold) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%' and tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%' and tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CC%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND tourney_hand_player_statistics.flg_p_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action = 'CF') then  1 else  0 end))), (sum( (case when( (NOT(tourney_hand_player_statistics.flg_p_face_raise) OR (tourney_hand_player_statistics.flg_p_limp) OR (tourney_hand_player_statistics.flg_p_first_raise)) AND NOT(tourney_hand_player_statistics.flg_blind_b)) then  1  else  0  end) )), (sum((case when( tourney_hand_player_statistics.cnt_p_face_limpers > 0 AND NOT (tourney_hand_player_statistics.flg_blind_b)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CR%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.position = 0 and tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp AND ((tourney_hand_summary.cnt_players between 4 and 6 and tourney_hand_player_statistics.position between 3 and 5) OR (tourney_hand_summary.cnt_players between 7 and 8 and tourney_hand_player_statistics.position between 4 and 7) OR (tourney_hand_summary.cnt_players between 9 and 10 and tourney_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_p_raise )), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action = 'R' AND tourney_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND NOT tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.position = 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND tourney_hand_player_statistics.flg_p_open_opp and ((tourney_hand_summary.cnt_players between 4 and 6 and tourney_hand_player_statistics.position between 3 and 5) OR (tourney_hand_summary.cnt_players between 7 and 8 and tourney_hand_player_statistics.position between 4 and 7) OR (tourney_hand_summary.cnt_players between 9 and 10 and tourney_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_p_raise > 0) then  1 else  0 end))), (sum((case when( lookup_actions_p.action LIKE '__%' OR (lookup_actions_p.action LIKE '_' AND (tourney_hand_player_statistics.amt_before > (tourney_blinds.amt_bb + tourney_hand_player_statistics.amt_ante)) AND (tourney_hand_player_statistics.amt_p_raise_facing < (tourney_hand_player_statistics.amt_before - (tourney_hand_player_statistics.amt_blind + tourney_hand_player_statistics.amt_ante))) AND (tourney_hand_player_statistics.flg_p_open_opp OR tourney_hand_player_statistics.cnt_p_face_limpers > 0 OR tourney_hand_player_statistics.flg_p_3bet_opp OR tourney_hand_player_statistics.flg_p_4bet_opp) )) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open = false AND tourney_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp AND ((tourney_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp AND ((tourney_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='R' OR ((tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND ( char_length(lookup_actions_r.action) != 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_r_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_r_call )), (sum((case when(tourney_hand_player_statistics.cnt_r_call > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND tourney_hand_player_statistics.flg_r_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND tourney_hand_player_statistics.flg_r_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND lookup_actions_r.action LIKE 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND NOT(tourney_hand_player_statistics.flg_r_face_raise) AND NOT(tourney_hand_player_statistics.flg_showdown)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check AND (tourney_hand_player_statistics.cnt_r_raise > 0 OR tourney_hand_player_statistics.cnt_r_call > 0 OR tourney_hand_player_statistics.flg_r_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp or tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.enum_r_donk_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='F') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='R') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_opp and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b)) AND (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action LIKE 'B_%' AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action = 'BF' AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b)) AND (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_r_raise)), (sum((case when(tourney_hand_player_statistics.cnt_r_raise > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_r_raise > 0 AND tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp ) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att and tourney_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp and tourney_hand_summary.str_aggressors_p NOT LIKE '89%' AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F' AND tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp and tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_opp and tourney_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND NOT (tourney_hand_player_statistics.flg_f_saw) AND NOT (tourney_hand_player_statistics.flg_p_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp AND ((tourney_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp AND ((tourney_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.flg_showdown AND ( tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND ( char_length(lookup_actions_t.action) != 0 AND char_length(lookup_actions_r.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_t_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_t_call )), (sum((case when(tourney_hand_player_statistics.flg_t_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND tourney_hand_player_statistics.flg_t_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND tourney_hand_player_statistics.flg_t_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND lookup_actions_t.action LIKE 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND NOT (tourney_hand_player_statistics.flg_r_saw) AND NOT (tourney_hand_player_statistics.flg_t_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check AND (tourney_hand_player_statistics.cnt_t_raise > 0 OR tourney_hand_player_statistics.cnt_t_call > 0 OR tourney_hand_player_statistics.flg_t_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp or tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.enum_t_donk_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_opp and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_t_raise)), (sum((case when(tourney_hand_player_statistics.cnt_t_raise > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_t_raise > 0 AND tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_b = false AND tourney_hand_player_statistics.flg_blind_s AND tourney_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = '') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown and tourney_hand_player_statistics.amt_bet_ttl > 5 * tourney_blinds.amt_bb) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown and tourney_hand_player_statistics.flg_won_hand and tourney_hand_player_statistics.amt_bet_ttl > 5 * tourney_blinds.amt_bb) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_r_call > 0 AND tourney_hand_player_statistics.flg_won_hand AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.enum_allin='P' OR tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p' OR  tourney_hand_player_statistics.enum_allin='F' OR tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f' OR  tourney_hand_player_statistics.enum_allin='T' OR tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t' OR  tourney_hand_player_statistics.enum_allin='R' OR tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r' ) then    ( (case when(tourney_hand_player_statistics.enum_allin='P' OR ((tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p') AND  tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='F' OR ((tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f') AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND  tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='R' OR ((tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r') AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) )   else  0 end))), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) != 0 AND char_length(lookup_actions_t.action) = 0 AND char_length(lookup_actions_r.action) = 0)) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND char_length(lookup_actions_f.action) = 0) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND  char_length(lookup_actions_r.action) != 0) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0  AND char_length(lookup_actions_t.action) != 0 AND char_length(lookup_actions_r.action) = 0) then  tourney_hand_player_statistics.val_equity else  0 end) )) FROM	                 tourney_hand_player_statistics , tourney_hand_summary, lookup_actions lookup_actions_f, lookup_actions lookup_actions_t, tourney_blinds, lookup_actions lookup_actions_p, lookup_actions lookup_actions_r, lookup_positions WHERE (tourney_hand_summary.id_hand = tourney_hand_player_statistics.id_hand AND tourney_hand_summary.id_blinds = tourney_hand_player_statistics.id_blinds)  AND (lookup_actions_f.id_action=tourney_hand_player_statistics.id_action_f)  AND (lookup_actions_t.id_action=tourney_hand_player_statistics.id_action_t)  AND (tourney_blinds.id_blinds = tourney_hand_player_statistics.id_blinds)  AND (lookup_actions_p.id_action=tourney_hand_player_statistics.id_action_p)  AND (lookup_actions_r.id_action=tourney_hand_player_statistics.id_action_r)  AND (lookup_positions."position"=tourney_hand_player_statistics."position" AND lookup_positions.cnt_players=tourney_hand_player_statistics.cnt_players_lookup_position)  AND (tourney_blinds.id_blinds = tourney_hand_summary.id_blinds)     AND ((tourney_hand_player_statistics.id_player = $1))  AND ((CAST ( ((date_part('year',  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )) = ANY ($2))  GROUP BY tourney_hand_player_statistics.id_player, tourney_hand_player_statistics.id_gametype, tourney_hand_player_statistics.id_blinds, tourney_hand_summary.cnt_players,  ((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)),  (tourney_hand_player_statistics.flg_f_has_position),  (tourney_hand_player_statistics.flg_t_has_position),  (tourney_hand_player_statistics.flg_r_has_position),  (CAST ( ((date_part('year',  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )) 

  LOOP  
    <<insertCashPlayerDataToCache>>
    BEGIN
      INSERT INTO tourney_cache VALUES(playerdata.id_player, playerdata.id_gametype, playerdata.id_blinds, playerdata.cnt_players,playerdata.position_type::integer,playerdata.flg_has_position_f::boolean,playerdata.flg_has_position_t::boolean,playerdata.flg_has_position_r::boolean,playerdata.date_played_year_week::integer,playerdata.amt_bb_won::numeric(14,2),playerdata.amt_blind::numeric(14,2),playerdata.amt_chips_won::numeric(14,2),playerdata.amt_expected_bb_won::numeric(14,2),playerdata.amt_expected_won::numeric(14,2),playerdata.amt_r_call::numeric(14,2),playerdata.amt_r_call_won::numeric(14,2),playerdata.cnt_blind::integer,playerdata.cnt_f_2bet_def_action_call::integer,playerdata.cnt_f_2bet_def_action_fold::integer,playerdata.cnt_f_3bet::integer,playerdata.cnt_f_3bet_def_action_call::integer,playerdata.cnt_f_3bet_def_action_fold::integer,playerdata.cnt_f_3bet_def_opp::integer,playerdata.cnt_f_3bet_opp::integer,playerdata.cnt_f_4bet::integer,playerdata.cnt_f_4bet_def_action_call::integer,playerdata.cnt_f_4bet_def_action_fold::integer,playerdata.cnt_f_4bet_def_opp::integer,playerdata.cnt_f_4bet_opp::integer,playerdata.cnt_f_allin::integer,playerdata.cnt_f_allin_valid::integer,playerdata.cnt_f_bet::integer,playerdata.cnt_f_bet_def_action_call::integer,playerdata.cnt_f_bet_def_action_fold::integer,playerdata.cnt_f_bet_def_action_raise::integer,playerdata.cnt_f_bet_def_opp::integer,playerdata.cnt_f_bet_limp_pot::integer,playerdata.cnt_f_call::integer,playerdata.cnt_f_cbet::integer,playerdata.cnt_f_cbet_3bet_pot::integer,playerdata.cnt_f_cbet_def_action_call::integer,playerdata.cnt_f_cbet_def_action_call_in_pos::integer,playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_fold::integer,playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_raise::integer,playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,playerdata.cnt_f_cbet_def_opp::integer,playerdata.cnt_f_cbet_face_raise::integer,playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,playerdata.cnt_f_cbet_fold_to_raise::integer,playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_f_cbet_opp::integer,playerdata.cnt_f_cbet_opp_3bet_pot::integer,playerdata.cnt_f_cbet_success::integer,playerdata.cnt_f_check::integer,playerdata.cnt_f_check_raise::integer,playerdata.cnt_f_check_raise_opp::integer,playerdata.cnt_f_donk::integer,playerdata.cnt_f_donk_3bet_pot::integer,playerdata.cnt_f_donk_def_opp::integer,playerdata.cnt_f_donk_def_opp_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_call::integer,playerdata.cnt_f_donk_def_opp_action_fold::integer,playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_raise::integer,playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,playerdata.cnt_f_donk_face_raise::integer,playerdata.cnt_f_donk_fold::integer,playerdata.cnt_f_donk_opp::integer,playerdata.cnt_f_donk_opp_3bet_pot::integer,playerdata.cnt_f_face_xr::integer,playerdata.cnt_f_face_xr_call::integer,playerdata.cnt_f_face_xr_fold::integer,playerdata.cnt_f_face_xr_raise::integer,playerdata.cnt_f_float::integer,playerdata.cnt_f_float_3bet_pot::integer,playerdata.cnt_f_float_def_opp::integer,playerdata.cnt_f_float_def_opp_action_call::integer,playerdata.cnt_f_float_def_opp_action_fold::integer,playerdata.cnt_f_float_def_opp_action_raise::integer,playerdata.cnt_f_float_face_raise::integer,playerdata.cnt_f_float_fold::integer,playerdata.cnt_f_float_opp::integer,playerdata.cnt_f_float_opp_3bet_pot::integer,playerdata.cnt_f_fold::integer,playerdata.cnt_f_open_opp_limp_pot::integer,playerdata.cnt_f_raise::integer,playerdata.cnt_f_raise_def_opp::integer,playerdata.cnt_f_saw::integer,playerdata.cnt_f_saw_won::integer,playerdata.cnt_hands::integer,playerdata.cnt_hands_won::integer,playerdata.cnt_p_2bet_def_action_call::integer,playerdata.cnt_p_2bet_def_action_fold::integer,playerdata.cnt_p_2bet_def_opp::integer,playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,playerdata.cnt_p_3bet::integer,playerdata.cnt_p_3bet_def_action_call::integer,playerdata.cnt_p_3bet_def_action_call_after_2b::integer,playerdata.cnt_p_3bet_def_action_fold::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,playerdata.cnt_p_3bet_def_opp::integer,playerdata.cnt_p_3bet_def_opp_after_2b::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_f_cbet_def_opp::integer,playerdata.cnt_p_3bet_opp::integer,playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_open::integer,playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,playerdata.cnt_p_3bet_opp_vs_co_open::integer,playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_r_cbet_def_opp::integer,playerdata.cnt_p_3bet_success::integer,playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_t_cbet_def_opp::integer,playerdata.cnt_p_3bet_vs_bb_2bet::integer,playerdata.cnt_p_3bet_vs_btn_2bet::integer,playerdata.cnt_p_3bet_vs_btn_open::integer,playerdata.cnt_p_3bet_vs_co_2bet::integer,playerdata.cnt_p_3bet_vs_co_open::integer,playerdata.cnt_p_3bet_vs_ep_2bet::integer,playerdata.cnt_p_3bet_vs_mp_2bet::integer,playerdata.cnt_p_3bet_vs_sb_2bet::integer,playerdata.cnt_p_4bet::integer,playerdata.cnt_p_4bet_after_raising::integer,playerdata.cnt_p_4bet_cold::integer,playerdata.cnt_p_4bet_cold_opp::integer,playerdata.cnt_p_4bet_def_action_call::integer,playerdata.cnt_p_4bet_def_action_fold::integer,playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,playerdata.cnt_p_4bet_def_opp::integer,playerdata.cnt_p_4bet_def_opp_after_3b::integer,playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,playerdata.cnt_p_4bet_opp::integer,playerdata.cnt_p_4bet_opp_when_open_raised::integer,playerdata.cnt_p_5bet::integer,playerdata.cnt_p_5bet_def_action_fold::integer,playerdata.cnt_p_5bet_def_opp::integer,playerdata.cnt_p_5bet_opp::integer,playerdata.cnt_p_allin::integer,playerdata.cnt_p_allin_valid::integer,playerdata.cnt_p_bb_v_sb_3bet::integer,playerdata.cnt_p_bb_v_sb_3bet_opp::integer,playerdata.cnt_p_bb_v_sb_call::integer,playerdata.cnt_p_bb_v_sb_fold::integer,playerdata.cnt_p_call::integer,playerdata.cnt_p_call_vs_btn_open::integer,playerdata.cnt_p_call_vs_co_open::integer,playerdata.cnt_p_ccall::integer,playerdata.cnt_p_ccall_3bet::integer,playerdata.cnt_p_ccall_3bet_opp::integer,playerdata.cnt_p_ccall_opp::integer,playerdata.cnt_p_facing_limpers::integer,playerdata.cnt_p_fold::integer,playerdata.cnt_p_fold_vs_btn_open::integer,playerdata.cnt_p_fold_vs_co_open::integer,playerdata.cnt_p_limp::integer,playerdata.cnt_p_limp_call::integer,playerdata.cnt_p_limp_faceraise::integer,playerdata.cnt_p_limp_fold::integer,playerdata.cnt_p_limp_opp::integer,playerdata.cnt_p_limp_opp_facing_limpers::integer,playerdata.cnt_p_limp_raise::integer,playerdata.cnt_p_open_opp::integer,playerdata.cnt_p_open_opp_btn::integer,playerdata.cnt_p_open_opp_ep::integer,playerdata.cnt_p_raise::integer,playerdata.cnt_p_raise_3bet::integer,playerdata.cnt_p_raise_first_in::integer,playerdata.cnt_p_raise_limpers::integer,playerdata.cnt_p_rfi_btn::integer,playerdata.cnt_p_rfi_ep::integer,playerdata.cnt_p_squeeze::integer,playerdata.cnt_p_squeeze_def_call::integer,playerdata.cnt_p_squeeze_def_fold::integer,playerdata.cnt_p_squeeze_def_opp::integer,playerdata.cnt_p_squeeze_def_raise::integer,playerdata.cnt_p_squeeze_opp::integer,playerdata.cnt_pfr::integer,playerdata.cnt_pfr_opp::integer,playerdata.cnt_prev_callers_limp::integer,playerdata.cnt_r_2bet_def_action_call::integer,playerdata.cnt_r_2bet_def_action_fold::integer,playerdata.cnt_r_3bet::integer,playerdata.cnt_r_3bet_def_action_call::integer,playerdata.cnt_r_3bet_def_action_fold::integer,playerdata.cnt_r_3bet_def_opp::integer,playerdata.cnt_r_3bet_opp::integer,playerdata.cnt_r_4bet::integer,playerdata.cnt_r_4bet_def_action_call::integer,playerdata.cnt_r_4bet_def_action_fold::integer,playerdata.cnt_r_4bet_def_opp::integer,playerdata.cnt_r_4bet_opp::integer,playerdata.cnt_r_allin::integer,playerdata.cnt_r_allin_valid::integer,playerdata.cnt_r_bet::integer,playerdata.cnt_r_bet_def_action_call::integer,playerdata.cnt_r_bet_def_action_fold::integer,playerdata.cnt_r_bet_def_action_raise::integer,playerdata.cnt_r_bet_def_opp::integer,playerdata.cnt_r_call::integer,playerdata.cnt_r_call_hands::integer,playerdata.cnt_r_cbet::integer,playerdata.cnt_r_cbet_3bet_pot::integer,playerdata.cnt_r_cbet_def_action_call::integer,playerdata.cnt_r_cbet_def_action_fold::integer,playerdata.cnt_r_cbet_def_action_raise::integer,playerdata.cnt_r_cbet_def_opp::integer,playerdata.cnt_r_cbet_face_raise::integer,playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,playerdata.cnt_r_cbet_fold_to_raise::integer,playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_r_cbet_opp::integer,playerdata.cnt_r_cbet_opp_3bet_pot::integer,playerdata.cnt_r_cbet_success::integer,playerdata.cnt_r_check::integer,playerdata.cnt_r_check_raise::integer,playerdata.cnt_r_check_raise_opp::integer,playerdata.cnt_r_donk::integer,playerdata.cnt_r_donk_3bet_pot::integer,playerdata.cnt_r_donk_def_action_call::integer,playerdata.cnt_r_donk_def_action_fold::integer,playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_r_donk_def_action_raise::integer,playerdata.cnt_r_donk_def_opp::integer,playerdata.cnt_r_donk_def_opp_3bet_pot::integer,playerdata.cnt_r_donk_face_raise::integer,playerdata.cnt_r_donk_fold::integer,playerdata.cnt_r_donk_opp::integer,playerdata.cnt_r_donk_opp_3bet_pot::integer,playerdata.cnt_r_face_xr::integer,playerdata.cnt_r_face_xr_call::integer,playerdata.cnt_r_face_xr_fold::integer,playerdata.cnt_r_face_xr_raise::integer,playerdata.cnt_r_float::integer,playerdata.cnt_r_float_3bet_pot::integer,playerdata.cnt_r_float_def_action_call::integer,playerdata.cnt_r_float_def_action_fold::integer,playerdata.cnt_r_float_def_action_raise::integer,playerdata.cnt_r_float_def_opp::integer,playerdata.cnt_r_float_face_raise::integer,playerdata.cnt_r_float_fold::integer,playerdata.cnt_r_float_opp::integer,playerdata.cnt_r_float_opp_3bet_pot::integer,playerdata.cnt_r_fold::integer,playerdata.cnt_r_probe::integer,playerdata.cnt_r_probe_3bet_pot::integer,playerdata.cnt_r_probe_def_action_call::integer,playerdata.cnt_r_probe_def_action_fold::integer,playerdata.cnt_r_probe_def_action_raise::integer,playerdata.cnt_r_probe_def_opp::integer,playerdata.cnt_r_probe_face_raise::integer,playerdata.cnt_r_probe_fold::integer,playerdata.cnt_r_probe_opp::integer,playerdata.cnt_r_probe_opp_3bet_pot::integer,playerdata.cnt_r_raise::integer,playerdata.cnt_r_raise_wtsd::integer,playerdata.cnt_r_raise_wtsd_won::integer,playerdata.cnt_r_saw::integer,playerdata.cnt_steal_3bet_def_action_fold::integer,playerdata.cnt_steal_3bet_def_opp::integer,playerdata.cnt_steal_att::integer,playerdata.cnt_steal_att_lp::integer,playerdata.cnt_steal_att_sb::integer,playerdata.cnt_steal_def_3bet_opp::integer,playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,playerdata.cnt_steal_def_action_call::integer,playerdata.cnt_steal_def_action_call_vs_lp::integer,playerdata.cnt_steal_def_action_fold::integer,playerdata.cnt_steal_def_action_fold_vs_lp::integer,playerdata.cnt_steal_def_action_raise::integer,playerdata.cnt_steal_def_action_raise_vs_lp::integer,playerdata.cnt_steal_def_opp::integer,playerdata.cnt_steal_def_opp_vs_lp::integer,playerdata.cnt_steal_opp::integer,playerdata.cnt_steal_opp_lp::integer,playerdata.cnt_steal_opp_sb::integer,playerdata.cnt_steal_reraise_def_action_fold::integer,playerdata.cnt_steal_reraise_def_opp::integer,playerdata.cnt_steal_success::integer,playerdata.cnt_t_2bet_def_action_call::integer,playerdata.cnt_t_2bet_def_action_fold::integer,playerdata.cnt_t_3bet::integer,playerdata.cnt_t_3bet_def_action_call::integer,playerdata.cnt_t_3bet_def_action_fold::integer,playerdata.cnt_t_3bet_def_opp::integer,playerdata.cnt_t_3bet_opp::integer,playerdata.cnt_t_4bet::integer,playerdata.cnt_t_4bet_def_action_call::integer,playerdata.cnt_t_4bet_def_action_fold::integer,playerdata.cnt_t_4bet_def_opp::integer,playerdata.cnt_t_4bet_opp::integer,playerdata.cnt_t_allin::integer,playerdata.cnt_t_allin_showdown::integer,playerdata.cnt_t_allin_valid::integer,playerdata.cnt_t_bet::integer,playerdata.cnt_t_bet_def_action_call::integer,playerdata.cnt_t_bet_def_action_fold::integer,playerdata.cnt_t_bet_def_action_raise::integer,playerdata.cnt_t_bet_def_opp::integer,playerdata.cnt_t_call::integer,playerdata.cnt_t_cbet::integer,playerdata.cnt_t_cbet_3bet_pot::integer,playerdata.cnt_t_cbet_def_action_call::integer,playerdata.cnt_t_cbet_def_action_fold::integer,playerdata.cnt_t_cbet_def_action_raise::integer,playerdata.cnt_t_cbet_def_opp::integer,playerdata.cnt_t_cbet_face_raise::integer,playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,playerdata.cnt_t_cbet_fold_to_raise::integer,playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_t_cbet_opp::integer,playerdata.cnt_t_cbet_opp_3bet_pot::integer,playerdata.cnt_t_cbet_success::integer,playerdata.cnt_t_check::integer,playerdata.cnt_t_check_raise::integer,playerdata.cnt_t_check_raise_opp::integer,playerdata.cnt_t_donk::integer,playerdata.cnt_t_donk_3bet_pot::integer,playerdata.cnt_t_donk_def_action_call::integer,playerdata.cnt_t_donk_def_action_fold::integer,playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_t_donk_def_action_raise::integer,playerdata.cnt_t_donk_def_opp::integer,playerdata.cnt_t_donk_def_opp_3bet_pot::integer,playerdata.cnt_t_donk_face_raise::integer,playerdata.cnt_t_donk_fold::integer,playerdata.cnt_t_donk_opp::integer,playerdata.cnt_t_donk_opp_3bet_pot::integer,playerdata.cnt_t_face_xr::integer,playerdata.cnt_t_face_xr_call::integer,playerdata.cnt_t_face_xr_fold::integer,playerdata.cnt_t_face_xr_raise::integer,playerdata.cnt_t_float::integer,playerdata.cnt_t_float_3bet_pot::integer,playerdata.cnt_t_float_def_action_call::integer,playerdata.cnt_t_float_def_action_fold::integer,playerdata.cnt_t_float_def_action_raise::integer,playerdata.cnt_t_float_def_opp::integer,playerdata.cnt_t_float_face_raise::integer,playerdata.cnt_t_float_fold::integer,playerdata.cnt_t_float_opp::integer,playerdata.cnt_t_float_opp_3bet_pot::integer,playerdata.cnt_t_fold::integer,playerdata.cnt_t_probe::integer,playerdata.cnt_t_probe_3bet_pot::integer,playerdata.cnt_t_probe_def_action_call::integer,playerdata.cnt_t_probe_def_action_fold::integer,playerdata.cnt_t_probe_def_action_raise::integer,playerdata.cnt_t_probe_def_opp::integer,playerdata.cnt_t_probe_face_raise::integer,playerdata.cnt_t_probe_fold::integer,playerdata.cnt_t_probe_opp::integer,playerdata.cnt_t_probe_opp_3bet_pot::integer,playerdata.cnt_t_raise::integer,playerdata.cnt_t_raise_wtsd::integer,playerdata.cnt_t_raise_wtsd_won::integer,playerdata.cnt_t_saw::integer,playerdata.cnt_vpip::integer,playerdata.cnt_vpip_sb::integer,playerdata.cnt_walks::integer,playerdata.cnt_won_hand::integer,playerdata.cnt_wtsd::integer,playerdata.cnt_wtsd_non_small::integer,playerdata.cnt_wtsd_won::integer,playerdata.cnt_wtsd_won_non_small::integer,playerdata.cnt_wtsd_won_when_r_call::integer,playerdata.val_equity::numeric(14,2),playerdata.val_f_equity::numeric(14,2),playerdata.val_p_equity::numeric(14,2),playerdata.val_r_equity::numeric(14,2),playerdata.val_t_equity::numeric(14,2));
      CONTINUE;
    END insertCashPlayerDataToCache;
    
  END LOOP getCashPlayersDataToCache;
  
  RETURN;
END;
$_$;


ALTER FUNCTION public.update_tourney_cache_date(integer, integer[]) OWNER TO %USERNAME%;

--
-- TOC entry 230 (class 1255 OID 17414)
-- Name: update_tourney_cache_player(integer); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_tourney_cache_player(integer) RETURNS void
    LANGUAGE plpgsql
    AS $_$

DECLARE
  playerdata tourney_cache%ROWTYPE;

BEGIN
  <<deletePlayersCache>>
  BEGIN
    DELETE FROM tourney_cache WHERE id_player = $1;
  END deletePlayersCache;

  <<getCashPlayersDataToCache>>
  FOR playerdata IN 
    SELECT tourney_hand_player_statistics.id_player, tourney_hand_player_statistics.id_gametype, tourney_hand_player_statistics.id_blinds, tourney_hand_summary.cnt_players,((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)), (tourney_hand_player_statistics.flg_f_has_position), (tourney_hand_player_statistics.flg_t_has_position), (tourney_hand_player_statistics.flg_r_has_position), (CAST ( ((date_part('year',  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )), (sum( (CASE WHEN ( tourney_blinds.amt_bb) <> 0 THEN ((tourney_hand_player_statistics.amt_won * 1.0 )/( tourney_blinds.amt_bb)) ELSE 0 END) )), (sum(tourney_hand_player_statistics.amt_blind)), (sum(tourney_hand_player_statistics.amt_won)), (sum( (CASE WHEN ( tourney_blinds.amt_bb) <> 0 THEN ((tourney_hand_player_statistics.amt_expected_won * 1.0 )/( tourney_blinds.amt_bb)) ELSE 0 END) )), (sum(tourney_hand_player_statistics.amt_expected_won)), (sum( (case when( tourney_hand_player_statistics.cnt_r_call > 0 AND (tourney_hand_player_statistics.amt_r_bet_made + tourney_hand_player_statistics.amt_r_raise_made) = 0) then  tourney_hand_player_statistics.amt_bet_r else  0  end))), (sum( (case when( tourney_hand_player_statistics.cnt_r_call > 0 AND (tourney_hand_player_statistics.amt_r_bet_made + tourney_hand_player_statistics.amt_r_raise_made) = 0 AND tourney_hand_player_statistics.flg_won_hand) then  tourney_hand_player_statistics.amt_won + tourney_hand_player_statistics.amt_bet_ttl else  0  end))), (sum((case when(tourney_hand_player_statistics.flg_blind_b OR tourney_hand_player_statistics.flg_blind_s) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp AND ((tourney_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp AND ((tourney_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='F' OR ((tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) != 0 AND char_length(lookup_actions_t.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(F|XF)')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_bet and NOT(tourney_hand_player_statistics.flg_p_face_raise) and tourney_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_f_call )), (sum((case when(tourney_hand_player_statistics.flg_f_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='C') then 1 else 0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND tourney_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND tourney_hand_player_statistics.flg_f_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND NOT (tourney_hand_player_statistics.flg_t_saw) AND NOT (tourney_hand_player_statistics.flg_f_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND (tourney_hand_player_statistics.cnt_f_raise > 0 OR tourney_hand_player_statistics.cnt_f_call > 0 OR tourney_hand_player_statistics.flg_f_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND tourney_hand_player_statistics.flg_f_bet AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND tourney_hand_player_statistics.flg_f_bet AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'C') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT(tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action SIMILAR TO 'B_%' AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT(tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action = 'BF' AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND (tourney_hand_player_statistics.flg_f_open_opp) AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND (tourney_hand_player_statistics.flg_f_open_opp) AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when(tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and tourney_hand_player_statistics.flg_f_has_position and tourney_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XC') then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XF') then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XR') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position OR tourney_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action LIKE 'B_%') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position OR tourney_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_open_opp AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and tourney_hand_player_statistics.flg_f_has_position and tourney_hand_player_statistics.flg_f_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_open_opp and not(tourney_hand_player_statistics.flg_p_face_raise) and tourney_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_f_raise)), (sum((case when(tourney_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand AND tourney_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.id_hand > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(tourney_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'C%') OR lookup_actions_p.action SIMILAR TO '(C|X)C%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(tourney_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'F') OR lookup_actions_p.action SIMILAR TO '(C|X)F')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.enum_p_3bet_action = 'C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int > tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int < tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int > tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int < tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet_opp AND ((tourney_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet_opp AND ((tourney_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_player_statistics.flg_won_hand and not(tourney_hand_player_statistics.flg_f_saw) and not(tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet AND ((tourney_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet AND ((tourney_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet and lookup_actions_p.action LIKE 'R%' and not(tourney_hand_player_statistics.flg_p_first_raise) and not(tourney_hand_player_statistics.flg_p_3bet)) then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_p_limp) and not(tourney_hand_player_statistics.flg_p_open_opp) and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0 and (tourney_hand_player_statistics.amt_p_3bet_facing > 0 or tourney_hand_player_statistics.amt_p_4bet_facing > 0) and tourney_hand_player_statistics.flg_p_4bet_opp ) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet AND tourney_hand_player_statistics.enum_p_4bet_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet AND tourney_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when( char_length(tourney_hand_summary.str_aggressors_p) >= 4 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int != tourney_hand_player_statistics.position AND tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 5 AND tourney_hand_player_statistics.flg_p_4bet_def_opp AND tourney_hand_player_statistics.enum_folded = 'P' AND (tourney_hand_player_statistics.flg_p_4bet OR  NOT(((10 + tourney_hand_player_statistics.position -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))  ), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 5 AND tourney_hand_player_statistics.flg_p_4bet_def_opp AND (tourney_hand_player_statistics.flg_p_4bet OR   NOT(((10 + tourney_hand_player_statistics.position -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp and ((not tourney_hand_player_statistics.flg_p_3bet_def_opp) OR (tourney_hand_player_statistics.enum_p_3bet_action SIMILAR TO '(C|R)' AND tourney_hand_player_statistics.flg_p_4bet_def_opp))) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='P' OR ((tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9 AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='C' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='F' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_p_call )), (sum((case when(lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%' AND tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end)) ), (sum((case when(lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%' AND tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_ccall) then  1 else  0 end))), (sum((case when( (tourney_hand_player_statistics.enum_p_3bet_action = 'C' and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0) OR (tourney_hand_player_statistics.amt_p_3bet_facing = 0 and tourney_hand_player_statistics.enum_p_4bet_action = 'C' and not(tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when( (tourney_hand_player_statistics.flg_p_3bet_def_opp and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0) or (tourney_hand_player_statistics.amt_p_3bet_facing = 0 and tourney_hand_player_statistics.flg_p_4bet_def_opp and not(tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_player_statistics.amt_blind = 0 and not(tourney_hand_player_statistics.flg_p_limp)) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.cnt_p_face_limpers > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_fold) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%' and tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%' and tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CC%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND tourney_hand_player_statistics.flg_p_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action = 'CF') then  1 else  0 end))), (sum( (case when( (NOT(tourney_hand_player_statistics.flg_p_face_raise) OR (tourney_hand_player_statistics.flg_p_limp) OR (tourney_hand_player_statistics.flg_p_first_raise)) AND NOT(tourney_hand_player_statistics.flg_blind_b)) then  1  else  0  end) )), (sum((case when( tourney_hand_player_statistics.cnt_p_face_limpers > 0 AND NOT (tourney_hand_player_statistics.flg_blind_b)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CR%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.position = 0 and tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp AND ((tourney_hand_summary.cnt_players between 4 and 6 and tourney_hand_player_statistics.position between 3 and 5) OR (tourney_hand_summary.cnt_players between 7 and 8 and tourney_hand_player_statistics.position between 4 and 7) OR (tourney_hand_summary.cnt_players between 9 and 10 and tourney_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_p_raise )), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action = 'R' AND tourney_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND NOT tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.position = 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND tourney_hand_player_statistics.flg_p_open_opp and ((tourney_hand_summary.cnt_players between 4 and 6 and tourney_hand_player_statistics.position between 3 and 5) OR (tourney_hand_summary.cnt_players between 7 and 8 and tourney_hand_player_statistics.position between 4 and 7) OR (tourney_hand_summary.cnt_players between 9 and 10 and tourney_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_p_raise > 0) then  1 else  0 end))), (sum((case when( lookup_actions_p.action LIKE '__%' OR (lookup_actions_p.action LIKE '_' AND (tourney_hand_player_statistics.amt_before > (tourney_blinds.amt_bb + tourney_hand_player_statistics.amt_ante)) AND (tourney_hand_player_statistics.amt_p_raise_facing < (tourney_hand_player_statistics.amt_before - (tourney_hand_player_statistics.amt_blind + tourney_hand_player_statistics.amt_ante))) AND (tourney_hand_player_statistics.flg_p_open_opp OR tourney_hand_player_statistics.cnt_p_face_limpers > 0 OR tourney_hand_player_statistics.flg_p_3bet_opp OR tourney_hand_player_statistics.flg_p_4bet_opp) )) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open = false AND tourney_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp AND ((tourney_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp AND ((tourney_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='R' OR ((tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND ( char_length(lookup_actions_r.action) != 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_r_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_r_call )), (sum((case when(tourney_hand_player_statistics.cnt_r_call > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND tourney_hand_player_statistics.flg_r_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND tourney_hand_player_statistics.flg_r_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND lookup_actions_r.action LIKE 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND NOT(tourney_hand_player_statistics.flg_r_face_raise) AND NOT(tourney_hand_player_statistics.flg_showdown)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check AND (tourney_hand_player_statistics.cnt_r_raise > 0 OR tourney_hand_player_statistics.cnt_r_call > 0 OR tourney_hand_player_statistics.flg_r_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp or tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.enum_r_donk_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='F') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='R') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_opp and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b)) AND (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action LIKE 'B_%' AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action = 'BF' AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b)) AND (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_r_raise)), (sum((case when(tourney_hand_player_statistics.cnt_r_raise > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_r_raise > 0 AND tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp ) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att and tourney_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp and tourney_hand_summary.str_aggressors_p NOT LIKE '89%' AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F' AND tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp and tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_opp and tourney_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND NOT (tourney_hand_player_statistics.flg_f_saw) AND NOT (tourney_hand_player_statistics.flg_p_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp AND ((tourney_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp AND ((tourney_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.flg_showdown AND ( tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND ( char_length(lookup_actions_t.action) != 0 AND char_length(lookup_actions_r.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_t_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_t_call )), (sum((case when(tourney_hand_player_statistics.flg_t_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND tourney_hand_player_statistics.flg_t_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND tourney_hand_player_statistics.flg_t_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND lookup_actions_t.action LIKE 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND NOT (tourney_hand_player_statistics.flg_r_saw) AND NOT (tourney_hand_player_statistics.flg_t_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check AND (tourney_hand_player_statistics.cnt_t_raise > 0 OR tourney_hand_player_statistics.cnt_t_call > 0 OR tourney_hand_player_statistics.flg_t_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp or tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.enum_t_donk_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_opp and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_t_raise)), (sum((case when(tourney_hand_player_statistics.cnt_t_raise > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_t_raise > 0 AND tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_b = false AND tourney_hand_player_statistics.flg_blind_s AND tourney_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = '') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown and tourney_hand_player_statistics.amt_bet_ttl > 5 * tourney_blinds.amt_bb) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown and tourney_hand_player_statistics.flg_won_hand and tourney_hand_player_statistics.amt_bet_ttl > 5 * tourney_blinds.amt_bb) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_r_call > 0 AND tourney_hand_player_statistics.flg_won_hand AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.enum_allin='P' OR tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p' OR  tourney_hand_player_statistics.enum_allin='F' OR tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f' OR  tourney_hand_player_statistics.enum_allin='T' OR tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t' OR  tourney_hand_player_statistics.enum_allin='R' OR tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r' ) then    ( (case when(tourney_hand_player_statistics.enum_allin='P' OR ((tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p') AND  tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='F' OR ((tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f') AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND  tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='R' OR ((tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r') AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) )   else  0 end))), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) != 0 AND char_length(lookup_actions_t.action) = 0 AND char_length(lookup_actions_r.action) = 0)) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND char_length(lookup_actions_f.action) = 0) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND  char_length(lookup_actions_r.action) != 0) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0  AND char_length(lookup_actions_t.action) != 0 AND char_length(lookup_actions_r.action) = 0) then  tourney_hand_player_statistics.val_equity else  0 end) )) FROM	                 tourney_hand_player_statistics , tourney_hand_summary, lookup_actions lookup_actions_f, lookup_actions lookup_actions_t, tourney_blinds, lookup_actions lookup_actions_p, lookup_actions lookup_actions_r, lookup_positions WHERE (tourney_hand_summary.id_hand = tourney_hand_player_statistics.id_hand AND tourney_hand_summary.id_blinds = tourney_hand_player_statistics.id_blinds)  AND (lookup_actions_f.id_action=tourney_hand_player_statistics.id_action_f)  AND (lookup_actions_t.id_action=tourney_hand_player_statistics.id_action_t)  AND (tourney_blinds.id_blinds = tourney_hand_player_statistics.id_blinds)  AND (lookup_actions_p.id_action=tourney_hand_player_statistics.id_action_p)  AND (lookup_actions_r.id_action=tourney_hand_player_statistics.id_action_r)  AND (lookup_positions."position"=tourney_hand_player_statistics."position" AND lookup_positions.cnt_players=tourney_hand_player_statistics.cnt_players_lookup_position)  AND (tourney_blinds.id_blinds = tourney_hand_summary.id_blinds)     AND ((tourney_hand_player_statistics.id_player = $1))  GROUP BY tourney_hand_player_statistics.id_player, tourney_hand_player_statistics.id_gametype, tourney_hand_player_statistics.id_blinds, tourney_hand_summary.cnt_players,  ((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)),  (tourney_hand_player_statistics.flg_f_has_position),  (tourney_hand_player_statistics.flg_t_has_position),  (tourney_hand_player_statistics.flg_r_has_position),  (CAST ( ((date_part('year',  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )) 

  LOOP  
    <<insertCashPlayerDataToCache>>
    BEGIN
      INSERT INTO tourney_cache VALUES(playerdata.id_player, playerdata.id_gametype, playerdata.id_blinds, playerdata.cnt_players,playerdata.position_type::integer,playerdata.flg_has_position_f::boolean,playerdata.flg_has_position_t::boolean,playerdata.flg_has_position_r::boolean,playerdata.date_played_year_week::integer,playerdata.amt_bb_won::numeric(14,2),playerdata.amt_blind::numeric(14,2),playerdata.amt_chips_won::numeric(14,2),playerdata.amt_expected_bb_won::numeric(14,2),playerdata.amt_expected_won::numeric(14,2),playerdata.amt_r_call::numeric(14,2),playerdata.amt_r_call_won::numeric(14,2),playerdata.cnt_blind::integer,playerdata.cnt_f_2bet_def_action_call::integer,playerdata.cnt_f_2bet_def_action_fold::integer,playerdata.cnt_f_3bet::integer,playerdata.cnt_f_3bet_def_action_call::integer,playerdata.cnt_f_3bet_def_action_fold::integer,playerdata.cnt_f_3bet_def_opp::integer,playerdata.cnt_f_3bet_opp::integer,playerdata.cnt_f_4bet::integer,playerdata.cnt_f_4bet_def_action_call::integer,playerdata.cnt_f_4bet_def_action_fold::integer,playerdata.cnt_f_4bet_def_opp::integer,playerdata.cnt_f_4bet_opp::integer,playerdata.cnt_f_allin::integer,playerdata.cnt_f_allin_valid::integer,playerdata.cnt_f_bet::integer,playerdata.cnt_f_bet_def_action_call::integer,playerdata.cnt_f_bet_def_action_fold::integer,playerdata.cnt_f_bet_def_action_raise::integer,playerdata.cnt_f_bet_def_opp::integer,playerdata.cnt_f_bet_limp_pot::integer,playerdata.cnt_f_call::integer,playerdata.cnt_f_cbet::integer,playerdata.cnt_f_cbet_3bet_pot::integer,playerdata.cnt_f_cbet_def_action_call::integer,playerdata.cnt_f_cbet_def_action_call_in_pos::integer,playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_fold::integer,playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_raise::integer,playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,playerdata.cnt_f_cbet_def_opp::integer,playerdata.cnt_f_cbet_face_raise::integer,playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,playerdata.cnt_f_cbet_fold_to_raise::integer,playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_f_cbet_opp::integer,playerdata.cnt_f_cbet_opp_3bet_pot::integer,playerdata.cnt_f_cbet_success::integer,playerdata.cnt_f_check::integer,playerdata.cnt_f_check_raise::integer,playerdata.cnt_f_check_raise_opp::integer,playerdata.cnt_f_donk::integer,playerdata.cnt_f_donk_3bet_pot::integer,playerdata.cnt_f_donk_def_opp::integer,playerdata.cnt_f_donk_def_opp_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_call::integer,playerdata.cnt_f_donk_def_opp_action_fold::integer,playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_raise::integer,playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,playerdata.cnt_f_donk_face_raise::integer,playerdata.cnt_f_donk_fold::integer,playerdata.cnt_f_donk_opp::integer,playerdata.cnt_f_donk_opp_3bet_pot::integer,playerdata.cnt_f_face_xr::integer,playerdata.cnt_f_face_xr_call::integer,playerdata.cnt_f_face_xr_fold::integer,playerdata.cnt_f_face_xr_raise::integer,playerdata.cnt_f_float::integer,playerdata.cnt_f_float_3bet_pot::integer,playerdata.cnt_f_float_def_opp::integer,playerdata.cnt_f_float_def_opp_action_call::integer,playerdata.cnt_f_float_def_opp_action_fold::integer,playerdata.cnt_f_float_def_opp_action_raise::integer,playerdata.cnt_f_float_face_raise::integer,playerdata.cnt_f_float_fold::integer,playerdata.cnt_f_float_opp::integer,playerdata.cnt_f_float_opp_3bet_pot::integer,playerdata.cnt_f_fold::integer,playerdata.cnt_f_open_opp_limp_pot::integer,playerdata.cnt_f_raise::integer,playerdata.cnt_f_raise_def_opp::integer,playerdata.cnt_f_saw::integer,playerdata.cnt_f_saw_won::integer,playerdata.cnt_hands::integer,playerdata.cnt_hands_won::integer,playerdata.cnt_p_2bet_def_action_call::integer,playerdata.cnt_p_2bet_def_action_fold::integer,playerdata.cnt_p_2bet_def_opp::integer,playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,playerdata.cnt_p_3bet::integer,playerdata.cnt_p_3bet_def_action_call::integer,playerdata.cnt_p_3bet_def_action_call_after_2b::integer,playerdata.cnt_p_3bet_def_action_fold::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,playerdata.cnt_p_3bet_def_opp::integer,playerdata.cnt_p_3bet_def_opp_after_2b::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_f_cbet_def_opp::integer,playerdata.cnt_p_3bet_opp::integer,playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_open::integer,playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,playerdata.cnt_p_3bet_opp_vs_co_open::integer,playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_r_cbet_def_opp::integer,playerdata.cnt_p_3bet_success::integer,playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_t_cbet_def_opp::integer,playerdata.cnt_p_3bet_vs_bb_2bet::integer,playerdata.cnt_p_3bet_vs_btn_2bet::integer,playerdata.cnt_p_3bet_vs_btn_open::integer,playerdata.cnt_p_3bet_vs_co_2bet::integer,playerdata.cnt_p_3bet_vs_co_open::integer,playerdata.cnt_p_3bet_vs_ep_2bet::integer,playerdata.cnt_p_3bet_vs_mp_2bet::integer,playerdata.cnt_p_3bet_vs_sb_2bet::integer,playerdata.cnt_p_4bet::integer,playerdata.cnt_p_4bet_after_raising::integer,playerdata.cnt_p_4bet_cold::integer,playerdata.cnt_p_4bet_cold_opp::integer,playerdata.cnt_p_4bet_def_action_call::integer,playerdata.cnt_p_4bet_def_action_fold::integer,playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,playerdata.cnt_p_4bet_def_opp::integer,playerdata.cnt_p_4bet_def_opp_after_3b::integer,playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,playerdata.cnt_p_4bet_opp::integer,playerdata.cnt_p_4bet_opp_when_open_raised::integer,playerdata.cnt_p_5bet::integer,playerdata.cnt_p_5bet_def_action_fold::integer,playerdata.cnt_p_5bet_def_opp::integer,playerdata.cnt_p_5bet_opp::integer,playerdata.cnt_p_allin::integer,playerdata.cnt_p_allin_valid::integer,playerdata.cnt_p_bb_v_sb_3bet::integer,playerdata.cnt_p_bb_v_sb_3bet_opp::integer,playerdata.cnt_p_bb_v_sb_call::integer,playerdata.cnt_p_bb_v_sb_fold::integer,playerdata.cnt_p_call::integer,playerdata.cnt_p_call_vs_btn_open::integer,playerdata.cnt_p_call_vs_co_open::integer,playerdata.cnt_p_ccall::integer,playerdata.cnt_p_ccall_3bet::integer,playerdata.cnt_p_ccall_3bet_opp::integer,playerdata.cnt_p_ccall_opp::integer,playerdata.cnt_p_facing_limpers::integer,playerdata.cnt_p_fold::integer,playerdata.cnt_p_fold_vs_btn_open::integer,playerdata.cnt_p_fold_vs_co_open::integer,playerdata.cnt_p_limp::integer,playerdata.cnt_p_limp_call::integer,playerdata.cnt_p_limp_faceraise::integer,playerdata.cnt_p_limp_fold::integer,playerdata.cnt_p_limp_opp::integer,playerdata.cnt_p_limp_opp_facing_limpers::integer,playerdata.cnt_p_limp_raise::integer,playerdata.cnt_p_open_opp::integer,playerdata.cnt_p_open_opp_btn::integer,playerdata.cnt_p_open_opp_ep::integer,playerdata.cnt_p_raise::integer,playerdata.cnt_p_raise_3bet::integer,playerdata.cnt_p_raise_first_in::integer,playerdata.cnt_p_raise_limpers::integer,playerdata.cnt_p_rfi_btn::integer,playerdata.cnt_p_rfi_ep::integer,playerdata.cnt_p_squeeze::integer,playerdata.cnt_p_squeeze_def_call::integer,playerdata.cnt_p_squeeze_def_fold::integer,playerdata.cnt_p_squeeze_def_opp::integer,playerdata.cnt_p_squeeze_def_raise::integer,playerdata.cnt_p_squeeze_opp::integer,playerdata.cnt_pfr::integer,playerdata.cnt_pfr_opp::integer,playerdata.cnt_prev_callers_limp::integer,playerdata.cnt_r_2bet_def_action_call::integer,playerdata.cnt_r_2bet_def_action_fold::integer,playerdata.cnt_r_3bet::integer,playerdata.cnt_r_3bet_def_action_call::integer,playerdata.cnt_r_3bet_def_action_fold::integer,playerdata.cnt_r_3bet_def_opp::integer,playerdata.cnt_r_3bet_opp::integer,playerdata.cnt_r_4bet::integer,playerdata.cnt_r_4bet_def_action_call::integer,playerdata.cnt_r_4bet_def_action_fold::integer,playerdata.cnt_r_4bet_def_opp::integer,playerdata.cnt_r_4bet_opp::integer,playerdata.cnt_r_allin::integer,playerdata.cnt_r_allin_valid::integer,playerdata.cnt_r_bet::integer,playerdata.cnt_r_bet_def_action_call::integer,playerdata.cnt_r_bet_def_action_fold::integer,playerdata.cnt_r_bet_def_action_raise::integer,playerdata.cnt_r_bet_def_opp::integer,playerdata.cnt_r_call::integer,playerdata.cnt_r_call_hands::integer,playerdata.cnt_r_cbet::integer,playerdata.cnt_r_cbet_3bet_pot::integer,playerdata.cnt_r_cbet_def_action_call::integer,playerdata.cnt_r_cbet_def_action_fold::integer,playerdata.cnt_r_cbet_def_action_raise::integer,playerdata.cnt_r_cbet_def_opp::integer,playerdata.cnt_r_cbet_face_raise::integer,playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,playerdata.cnt_r_cbet_fold_to_raise::integer,playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_r_cbet_opp::integer,playerdata.cnt_r_cbet_opp_3bet_pot::integer,playerdata.cnt_r_cbet_success::integer,playerdata.cnt_r_check::integer,playerdata.cnt_r_check_raise::integer,playerdata.cnt_r_check_raise_opp::integer,playerdata.cnt_r_donk::integer,playerdata.cnt_r_donk_3bet_pot::integer,playerdata.cnt_r_donk_def_action_call::integer,playerdata.cnt_r_donk_def_action_fold::integer,playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_r_donk_def_action_raise::integer,playerdata.cnt_r_donk_def_opp::integer,playerdata.cnt_r_donk_def_opp_3bet_pot::integer,playerdata.cnt_r_donk_face_raise::integer,playerdata.cnt_r_donk_fold::integer,playerdata.cnt_r_donk_opp::integer,playerdata.cnt_r_donk_opp_3bet_pot::integer,playerdata.cnt_r_face_xr::integer,playerdata.cnt_r_face_xr_call::integer,playerdata.cnt_r_face_xr_fold::integer,playerdata.cnt_r_face_xr_raise::integer,playerdata.cnt_r_float::integer,playerdata.cnt_r_float_3bet_pot::integer,playerdata.cnt_r_float_def_action_call::integer,playerdata.cnt_r_float_def_action_fold::integer,playerdata.cnt_r_float_def_action_raise::integer,playerdata.cnt_r_float_def_opp::integer,playerdata.cnt_r_float_face_raise::integer,playerdata.cnt_r_float_fold::integer,playerdata.cnt_r_float_opp::integer,playerdata.cnt_r_float_opp_3bet_pot::integer,playerdata.cnt_r_fold::integer,playerdata.cnt_r_probe::integer,playerdata.cnt_r_probe_3bet_pot::integer,playerdata.cnt_r_probe_def_action_call::integer,playerdata.cnt_r_probe_def_action_fold::integer,playerdata.cnt_r_probe_def_action_raise::integer,playerdata.cnt_r_probe_def_opp::integer,playerdata.cnt_r_probe_face_raise::integer,playerdata.cnt_r_probe_fold::integer,playerdata.cnt_r_probe_opp::integer,playerdata.cnt_r_probe_opp_3bet_pot::integer,playerdata.cnt_r_raise::integer,playerdata.cnt_r_raise_wtsd::integer,playerdata.cnt_r_raise_wtsd_won::integer,playerdata.cnt_r_saw::integer,playerdata.cnt_steal_3bet_def_action_fold::integer,playerdata.cnt_steal_3bet_def_opp::integer,playerdata.cnt_steal_att::integer,playerdata.cnt_steal_att_lp::integer,playerdata.cnt_steal_att_sb::integer,playerdata.cnt_steal_def_3bet_opp::integer,playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,playerdata.cnt_steal_def_action_call::integer,playerdata.cnt_steal_def_action_call_vs_lp::integer,playerdata.cnt_steal_def_action_fold::integer,playerdata.cnt_steal_def_action_fold_vs_lp::integer,playerdata.cnt_steal_def_action_raise::integer,playerdata.cnt_steal_def_action_raise_vs_lp::integer,playerdata.cnt_steal_def_opp::integer,playerdata.cnt_steal_def_opp_vs_lp::integer,playerdata.cnt_steal_opp::integer,playerdata.cnt_steal_opp_lp::integer,playerdata.cnt_steal_opp_sb::integer,playerdata.cnt_steal_reraise_def_action_fold::integer,playerdata.cnt_steal_reraise_def_opp::integer,playerdata.cnt_steal_success::integer,playerdata.cnt_t_2bet_def_action_call::integer,playerdata.cnt_t_2bet_def_action_fold::integer,playerdata.cnt_t_3bet::integer,playerdata.cnt_t_3bet_def_action_call::integer,playerdata.cnt_t_3bet_def_action_fold::integer,playerdata.cnt_t_3bet_def_opp::integer,playerdata.cnt_t_3bet_opp::integer,playerdata.cnt_t_4bet::integer,playerdata.cnt_t_4bet_def_action_call::integer,playerdata.cnt_t_4bet_def_action_fold::integer,playerdata.cnt_t_4bet_def_opp::integer,playerdata.cnt_t_4bet_opp::integer,playerdata.cnt_t_allin::integer,playerdata.cnt_t_allin_showdown::integer,playerdata.cnt_t_allin_valid::integer,playerdata.cnt_t_bet::integer,playerdata.cnt_t_bet_def_action_call::integer,playerdata.cnt_t_bet_def_action_fold::integer,playerdata.cnt_t_bet_def_action_raise::integer,playerdata.cnt_t_bet_def_opp::integer,playerdata.cnt_t_call::integer,playerdata.cnt_t_cbet::integer,playerdata.cnt_t_cbet_3bet_pot::integer,playerdata.cnt_t_cbet_def_action_call::integer,playerdata.cnt_t_cbet_def_action_fold::integer,playerdata.cnt_t_cbet_def_action_raise::integer,playerdata.cnt_t_cbet_def_opp::integer,playerdata.cnt_t_cbet_face_raise::integer,playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,playerdata.cnt_t_cbet_fold_to_raise::integer,playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_t_cbet_opp::integer,playerdata.cnt_t_cbet_opp_3bet_pot::integer,playerdata.cnt_t_cbet_success::integer,playerdata.cnt_t_check::integer,playerdata.cnt_t_check_raise::integer,playerdata.cnt_t_check_raise_opp::integer,playerdata.cnt_t_donk::integer,playerdata.cnt_t_donk_3bet_pot::integer,playerdata.cnt_t_donk_def_action_call::integer,playerdata.cnt_t_donk_def_action_fold::integer,playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_t_donk_def_action_raise::integer,playerdata.cnt_t_donk_def_opp::integer,playerdata.cnt_t_donk_def_opp_3bet_pot::integer,playerdata.cnt_t_donk_face_raise::integer,playerdata.cnt_t_donk_fold::integer,playerdata.cnt_t_donk_opp::integer,playerdata.cnt_t_donk_opp_3bet_pot::integer,playerdata.cnt_t_face_xr::integer,playerdata.cnt_t_face_xr_call::integer,playerdata.cnt_t_face_xr_fold::integer,playerdata.cnt_t_face_xr_raise::integer,playerdata.cnt_t_float::integer,playerdata.cnt_t_float_3bet_pot::integer,playerdata.cnt_t_float_def_action_call::integer,playerdata.cnt_t_float_def_action_fold::integer,playerdata.cnt_t_float_def_action_raise::integer,playerdata.cnt_t_float_def_opp::integer,playerdata.cnt_t_float_face_raise::integer,playerdata.cnt_t_float_fold::integer,playerdata.cnt_t_float_opp::integer,playerdata.cnt_t_float_opp_3bet_pot::integer,playerdata.cnt_t_fold::integer,playerdata.cnt_t_probe::integer,playerdata.cnt_t_probe_3bet_pot::integer,playerdata.cnt_t_probe_def_action_call::integer,playerdata.cnt_t_probe_def_action_fold::integer,playerdata.cnt_t_probe_def_action_raise::integer,playerdata.cnt_t_probe_def_opp::integer,playerdata.cnt_t_probe_face_raise::integer,playerdata.cnt_t_probe_fold::integer,playerdata.cnt_t_probe_opp::integer,playerdata.cnt_t_probe_opp_3bet_pot::integer,playerdata.cnt_t_raise::integer,playerdata.cnt_t_raise_wtsd::integer,playerdata.cnt_t_raise_wtsd_won::integer,playerdata.cnt_t_saw::integer,playerdata.cnt_vpip::integer,playerdata.cnt_vpip_sb::integer,playerdata.cnt_walks::integer,playerdata.cnt_won_hand::integer,playerdata.cnt_wtsd::integer,playerdata.cnt_wtsd_non_small::integer,playerdata.cnt_wtsd_won::integer,playerdata.cnt_wtsd_won_non_small::integer,playerdata.cnt_wtsd_won_when_r_call::integer,playerdata.val_equity::numeric(14,2),playerdata.val_f_equity::numeric(14,2),playerdata.val_p_equity::numeric(14,2),playerdata.val_r_equity::numeric(14,2),playerdata.val_t_equity::numeric(14,2));
      CONTINUE;
    END insertCashPlayerDataToCache;
    
  END LOOP getCashPlayersDataToCache;
  
  RETURN;
END;
$_$;


ALTER FUNCTION public.update_tourney_cache_player(integer) OWNER TO %USERNAME%;

--
-- TOC entry 231 (class 1255 OID 17416)
-- Name: update_tourney_cache_playerrange(integer, integer); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_tourney_cache_playerrange(integer, integer) RETURNS void
    LANGUAGE plpgsql
    AS $_$

DECLARE
  playerdata tourney_cache%ROWTYPE;

BEGIN
  <<deletePlayersCache>>
  BEGIN
    DELETE FROM tourney_cache WHERE id_player >= $1 AND id_player <= $2;
  END deletePlayersCache;

  <<getCashPlayersDataToCache>>
  FOR playerdata IN 
    SELECT tourney_hand_player_statistics.id_player, tourney_hand_player_statistics.id_gametype, tourney_hand_player_statistics.id_blinds, tourney_hand_summary.cnt_players,((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)), (tourney_hand_player_statistics.flg_f_has_position), (tourney_hand_player_statistics.flg_t_has_position), (tourney_hand_player_statistics.flg_r_has_position), (CAST ( ((date_part('year',  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )), (sum( (CASE WHEN ( tourney_blinds.amt_bb) <> 0 THEN ((tourney_hand_player_statistics.amt_won * 1.0 )/( tourney_blinds.amt_bb)) ELSE 0 END) )), (sum(tourney_hand_player_statistics.amt_blind)), (sum(tourney_hand_player_statistics.amt_won)), (sum( (CASE WHEN ( tourney_blinds.amt_bb) <> 0 THEN ((tourney_hand_player_statistics.amt_expected_won * 1.0 )/( tourney_blinds.amt_bb)) ELSE 0 END) )), (sum(tourney_hand_player_statistics.amt_expected_won)), (sum( (case when( tourney_hand_player_statistics.cnt_r_call > 0 AND (tourney_hand_player_statistics.amt_r_bet_made + tourney_hand_player_statistics.amt_r_raise_made) = 0) then  tourney_hand_player_statistics.amt_bet_r else  0  end))), (sum( (case when( tourney_hand_player_statistics.cnt_r_call > 0 AND (tourney_hand_player_statistics.amt_r_bet_made + tourney_hand_player_statistics.amt_r_raise_made) = 0 AND tourney_hand_player_statistics.flg_won_hand) then  tourney_hand_player_statistics.amt_won + tourney_hand_player_statistics.amt_bet_ttl else  0  end))), (sum((case when(tourney_hand_player_statistics.flg_blind_b OR tourney_hand_player_statistics.flg_blind_s) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp AND ((tourney_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp AND ((tourney_hand_player_statistics.amt_f_bet_facing = 0 AND lookup_actions_f.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_f_bet_facing > 0 AND lookup_actions_f.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='F' OR ((tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) != 0 AND char_length(lookup_actions_t.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(F|XF)')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (lookup_actions_f.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_bet and NOT(tourney_hand_player_statistics.flg_p_face_raise) and tourney_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_f_call )), (sum((case when(tourney_hand_player_statistics.flg_f_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='C') then 1 else 0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_f_check) AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND tourney_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND tourney_hand_player_statistics.flg_f_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_cbet AND NOT (tourney_hand_player_statistics.flg_t_saw) AND NOT (tourney_hand_player_statistics.flg_f_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_check AND (tourney_hand_player_statistics.cnt_f_raise > 0 OR tourney_hand_player_statistics.cnt_f_call > 0 OR tourney_hand_player_statistics.flg_f_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND tourney_hand_player_statistics.flg_f_bet AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND tourney_hand_player_statistics.flg_f_bet AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp)) then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'C') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'F') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(lookup_actions_p.action LIKE '%R' AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) and tourney_hand_player_statistics.amt_f_bet_facing > 0 AND NOT (tourney_hand_player_statistics.flg_f_open_opp) AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 1)) end) = 'R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT(tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action SIMILAR TO 'B_%' AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT(tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND lookup_actions_f.action = 'BF' AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_face_raise AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND (tourney_hand_player_statistics.flg_f_open_opp) AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND NOT (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet) AND (tourney_hand_player_statistics.flg_f_open_opp) AND NOT (tourney_hand_player_statistics.flg_f_cbet_opp) AND ((tourney_hand_summary.cnt_players > 2 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) or (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0  end))), (sum((case when(tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_f.action) < 2) then '' else (substring(lookup_actions_f.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_f_bet AND tourney_hand_player_statistics.flg_f_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_f) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_f from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and tourney_hand_player_statistics.flg_f_has_position and tourney_hand_player_statistics.flg_f_bet) then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' AND tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.amt_f_bet_facing > 0) then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XC') then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XF') then  1 else  0 end))), (sum((case when( not(tourney_hand_player_statistics.flg_p_face_raise) AND lookup_actions_p.action LIKE '%R' and tourney_hand_player_statistics.flg_f_open_opp AND tourney_hand_player_statistics.amt_f_bet_facing > 0 AND (case when(char_length(lookup_actions_f.action) < 1) then '' else (substring(lookup_actions_f.action from 1 for 2)) end) = 'XR') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position OR tourney_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action LIKE 'B_%') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_bet AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position OR tourney_hand_player_statistics.flg_f_has_position) and lookup_actions_f.action = 'BF') then  1 else  0 end))), (sum((case when( (lookup_actions_p.action = 'C' OR lookup_actions_p.action = 'CC') AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.flg_f_open_opp AND char_length(tourney_hand_summary.str_aggressors_p) = 2 AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_f_has_position))) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and lookup_actions_p.action = 'RC' and tourney_hand_player_statistics.flg_f_has_position and tourney_hand_player_statistics.flg_f_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_open_opp and not(tourney_hand_player_statistics.flg_p_face_raise) and tourney_hand_player_statistics.cnt_p_raise = 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_f_raise)), (sum((case when(tourney_hand_player_statistics.flg_f_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand AND tourney_hand_player_statistics.flg_f_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.id_hand > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(tourney_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'C%') OR lookup_actions_p.action SIMILAR TO '(C|X)C%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 AND ((NOT(tourney_hand_player_statistics.flg_p_limp) AND lookup_actions_p.action LIKE 'F') OR lookup_actions_p.action SIMILAR TO '(C|X)F')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.enum_p_3bet_action = 'C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int > tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.enum_p_3bet_action='F' AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int < tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int > tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 3 and tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 3) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 3 for 1)) end)::int < tourney_hand_player_statistics.position) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_f_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_f_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet_opp AND ((tourney_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet_opp AND ((tourney_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet_opp and tourney_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_player_statistics.flg_won_hand and not(tourney_hand_player_statistics.flg_f_saw) and not(tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='C') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '88%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '80%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '81%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%') then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet AND ((tourney_hand_summary.cnt_players BETWEEN 4 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 3 and 5) OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 4 and 7) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 5 and 7))) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 2 and tourney_hand_player_statistics.flg_p_3bet AND ((tourney_hand_summary.cnt_players BETWEEN 3 and 6 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end) = '2') OR (tourney_hand_summary.cnt_players BETWEEN 7 and 8 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 3) OR (tourney_hand_summary.cnt_players BETWEEN 9 and 10 and (case when(char_length(tourney_hand_summary.str_aggressors_p) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 2 for 1)) end)::int BETWEEN 2 and 4))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet and tourney_hand_summary.str_aggressors_p LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet and lookup_actions_p.action LIKE 'R%' and not(tourney_hand_player_statistics.flg_p_first_raise) and not(tourney_hand_player_statistics.flg_p_3bet)) then  1 else  0 end))), (sum((case when(not(tourney_hand_player_statistics.flg_p_limp) and not(tourney_hand_player_statistics.flg_p_open_opp) and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0 and (tourney_hand_player_statistics.amt_p_3bet_facing > 0 or tourney_hand_player_statistics.amt_p_4bet_facing > 0) and tourney_hand_player_statistics.flg_p_4bet_opp ) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_p_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet AND tourney_hand_player_statistics.enum_p_4bet_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_3bet AND tourney_hand_player_statistics.flg_p_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_def_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp AND tourney_hand_player_statistics.flg_p_first_raise) then  1 else  0 end))), (sum((case when( char_length(tourney_hand_summary.str_aggressors_p) >= 4 AND (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int != tourney_hand_player_statistics.position AND tourney_hand_player_statistics.flg_p_4bet) then  1 else  0 end))), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 5 AND tourney_hand_player_statistics.flg_p_4bet_def_opp AND tourney_hand_player_statistics.enum_folded = 'P' AND (tourney_hand_player_statistics.flg_p_4bet OR  NOT(((10 + tourney_hand_player_statistics.position -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))  ), (sum((case when(char_length(tourney_hand_summary.str_aggressors_p) >= 5 AND tourney_hand_player_statistics.flg_p_4bet_def_opp AND (tourney_hand_player_statistics.flg_p_4bet OR   NOT(((10 + tourney_hand_player_statistics.position -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) BETWEEN 1 AND (((10 + (case when(char_length(tourney_hand_summary.str_aggressors_p) < 4) then '-1' else (substring(tourney_hand_summary.str_aggressors_p from 4 for 1)) end)::int -  substring(tourney_hand_summary.str_aggressors_p from 5 for 1)::int) % 10) - 1)))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_4bet_opp and ((not tourney_hand_player_statistics.flg_p_3bet_def_opp) OR (tourney_hand_player_statistics.enum_p_3bet_action SIMILAR TO '(C|R)' AND tourney_hand_player_statistics.flg_p_4bet_def_opp))) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='P' OR ((tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9 AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='C' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.position=8 AND tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action='F' AND tourney_hand_player_statistics.val_p_raise_aggressor_pos=9) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_p_call )), (sum((case when(lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%' AND tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end)) ), (sum((case when(lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%' AND tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_ccall) then  1 else  0 end))), (sum((case when( (tourney_hand_player_statistics.enum_p_3bet_action = 'C' and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0) OR (tourney_hand_player_statistics.amt_p_3bet_facing = 0 and tourney_hand_player_statistics.enum_p_4bet_action = 'C' and not(tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when( (tourney_hand_player_statistics.flg_p_3bet_def_opp and not(tourney_hand_player_statistics.flg_p_first_raise) and tourney_hand_player_statistics.amt_p_2bet_facing = 0) or (tourney_hand_player_statistics.amt_p_3bet_facing = 0 and tourney_hand_player_statistics.flg_p_4bet_def_opp and not(tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_p_2bet_facing > 0 and tourney_hand_player_statistics.amt_blind = 0 and not(tourney_hand_player_statistics.flg_p_limp)) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.cnt_p_face_limpers > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_fold) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and tourney_hand_summary.str_aggressors_p LIKE '80%' and tourney_hand_summary.str_actors_p LIKE '0%' and tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = 'F' and tourney_hand_summary.str_aggressors_p LIKE '81%' and tourney_hand_summary.str_actors_p LIKE '1%' and tourney_hand_player_statistics.amt_p_2bet_facing > 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CC%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND tourney_hand_player_statistics.flg_p_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action = 'CF') then  1 else  0 end))), (sum( (case when( (NOT(tourney_hand_player_statistics.flg_p_face_raise) OR (tourney_hand_player_statistics.flg_p_limp) OR (tourney_hand_player_statistics.flg_p_first_raise)) AND NOT(tourney_hand_player_statistics.flg_blind_b)) then  1  else  0  end) )), (sum((case when( tourney_hand_player_statistics.cnt_p_face_limpers > 0 AND NOT (tourney_hand_player_statistics.flg_blind_b)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_limp AND lookup_actions_p.action LIKE 'CR%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.position = 0 and tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp AND ((tourney_hand_summary.cnt_players between 4 and 6 and tourney_hand_player_statistics.position between 3 and 5) OR (tourney_hand_summary.cnt_players between 7 and 8 and tourney_hand_player_statistics.position between 4 and 7) OR (tourney_hand_summary.cnt_players between 9 and 10 and tourney_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_p_raise )), (sum((case when(tourney_hand_player_statistics.enum_p_3bet_action = 'R' AND tourney_hand_player_statistics.flg_p_4bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND NOT tourney_hand_player_statistics.flg_p_open_opp) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.position = 0) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_first_raise AND tourney_hand_player_statistics.flg_p_open_opp and ((tourney_hand_summary.cnt_players between 4 and 6 and tourney_hand_player_statistics.position between 3 and 5) OR (tourney_hand_summary.cnt_players between 7 and 8 and tourney_hand_player_statistics.position between 4 and 7) OR (tourney_hand_summary.cnt_players between 9 and 10 and tourney_hand_player_statistics.position between 5 and 7))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_def_opp AND tourney_hand_player_statistics.enum_p_squeeze_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_squeeze_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_p_raise > 0) then  1 else  0 end))), (sum((case when( lookup_actions_p.action LIKE '__%' OR (lookup_actions_p.action LIKE '_' AND (tourney_hand_player_statistics.amt_before > (tourney_blinds.amt_bb + tourney_hand_player_statistics.amt_ante)) AND (tourney_hand_player_statistics.amt_p_raise_facing < (tourney_hand_player_statistics.amt_before - (tourney_hand_player_statistics.amt_blind + tourney_hand_player_statistics.amt_ante))) AND (tourney_hand_player_statistics.flg_p_open_opp OR tourney_hand_player_statistics.cnt_p_face_limpers > 0 OR tourney_hand_player_statistics.flg_p_3bet_opp OR tourney_hand_player_statistics.flg_p_4bet_opp) )) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open = false AND tourney_hand_player_statistics.flg_p_limp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp AND ((tourney_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp AND ((tourney_hand_player_statistics.amt_r_bet_facing = 0 AND lookup_actions_r.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_r_bet_facing > 0 AND lookup_actions_r.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='R' OR ((tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND ( char_length(lookup_actions_r.action) != 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_r_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 AND (lookup_actions_r.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_r_call )), (sum((case when(tourney_hand_player_statistics.cnt_r_call > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND tourney_hand_player_statistics.flg_r_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND tourney_hand_player_statistics.flg_r_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND lookup_actions_r.action LIKE 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet OR tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_cbet AND NOT(tourney_hand_player_statistics.flg_r_face_raise) AND NOT(tourney_hand_player_statistics.flg_showdown)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_check AND (tourney_hand_player_statistics.cnt_r_raise > 0 OR tourney_hand_player_statistics.cnt_r_call > 0 OR tourney_hand_player_statistics.flg_r_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp or tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.enum_r_donk_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_donk_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_r_donk_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_r_donk_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_r.action) < 2) then '' else (substring(lookup_actions_r.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_r_bet AND tourney_hand_player_statistics.flg_r_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_r) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_r from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='F') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_r_float_action='R') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and lookup_actions_r.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float and lookup_actions_r.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_float_opp and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b)) AND (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp) and lookup_actions_r.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_r_bet_facing > 0 and tourney_hand_player_statistics.flg_t_cbet_opp and lookup_actions_t.action = 'X' and not(tourney_hand_player_statistics.flg_r_open_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action LIKE 'B_%' AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_bet AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) and lookup_actions_r.action = 'BF' AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_open_opp AND lookup_actions_t.action LIKE 'X' AND tourney_hand_player_statistics.flg_f_check AND tourney_hand_player_statistics.enum_f_cbet_action = 'C' AND NOT (tourney_hand_player_statistics.flg_f_face_raise) AND ((tourney_hand_summary.cnt_players >= 3 AND tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_b)) AND (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_r_raise)), (sum((case when(tourney_hand_player_statistics.cnt_r_raise > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_r_raise > 0 AND tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_r_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp ) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att and tourney_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.flg_p_first_raise and tourney_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp and tourney_hand_summary.str_aggressors_p NOT LIKE '89%' AND tourney_hand_player_statistics.flg_p_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'C%' and tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action = 'F' AND tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp AND lookup_actions_p.action LIKE 'R%' AND tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_def_opp and tourney_hand_summary.str_aggressors_p NOT LIKE '89%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_opp and tourney_hand_player_statistics.position <= 1) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_p_open_opp and tourney_hand_player_statistics.position = 9) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp AND tourney_hand_player_statistics.enum_p_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND tourney_hand_player_statistics.flg_p_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_steal_att AND NOT (tourney_hand_player_statistics.flg_f_saw) AND NOT (tourney_hand_player_statistics.flg_p_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp AND ((tourney_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(C|XC|BC)%') OR (tourney_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCC|CC)%'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp AND ((tourney_hand_player_statistics.amt_t_bet_facing = 0 AND lookup_actions_t.action SIMILAR TO '(F|XF|BF)%') OR (tourney_hand_player_statistics.amt_t_bet_facing > 0 AND lookup_actions_t.action SIMILAR TO  '(XCF|CF)'))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_3bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_3bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_3bet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_4bet_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_4bet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_4bet_opp) then  1 else  0 end))), (sum( (case when(tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.flg_showdown AND ( tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND tourney_hand_player_statistics.enum_face_allin_action<>'N' AND tourney_hand_player_statistics.enum_face_allin_action<>'F'))) then  1 else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND ( char_length(lookup_actions_t.action) != 0 AND char_length(lookup_actions_r.action) = 0)) then  1 else  0 end) )), (sum((case when(tourney_hand_player_statistics.flg_t_bet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(C|XC)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(F|XF)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 AND (lookup_actions_t.action SIMILAR TO '(R|XR)%')) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_t_call )), (sum((case when(tourney_hand_player_statistics.flg_t_cbet) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='C') then 1 else 0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_cbet_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND tourney_hand_player_statistics.flg_t_face_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND tourney_hand_player_statistics.flg_t_face_raise and (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND lookup_actions_t.action LIKE 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet_opp AND (tourney_hand_player_statistics.flg_p_3bet or tourney_hand_player_statistics.flg_p_4bet)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_cbet AND NOT (tourney_hand_player_statistics.flg_r_saw) AND NOT (tourney_hand_player_statistics.flg_t_face_raise)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check_raise) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_check AND (tourney_hand_player_statistics.cnt_t_raise > 0 OR tourney_hand_player_statistics.cnt_t_call > 0 OR tourney_hand_player_statistics.flg_t_fold)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_t_donk) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='F') then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp or tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.enum_t_donk_action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_donk_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) and tourney_hand_player_statistics.flg_t_donk_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when((tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp) AND tourney_hand_player_statistics.flg_t_donk_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'C' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'F' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when((case when(char_length(lookup_actions_t.action) < 2) then '' else (substring(lookup_actions_t.action from 2 for 1)) end) = 'R' AND tourney_hand_player_statistics.flg_t_bet AND tourney_hand_player_statistics.flg_t_face_raise AND ((tourney_hand_summary.cnt_players > 2 AND (case when(char_length(tourney_hand_summary.str_aggressors_t) < 2) then '-1' else (substring(tourney_hand_summary.str_aggressors_t from 2 for 1)) end)::int > tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 AND tourney_hand_player_statistics.flg_blind_s))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='C') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.enum_t_float_action='R') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_def_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_opp) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_float_opp and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_fold) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'C%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action = 'F') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp) and lookup_actions_t.action LIKE 'R%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.amt_t_bet_facing > 0 and tourney_hand_player_statistics.flg_f_cbet_opp and lookup_actions_f.action = 'X' and not(tourney_hand_player_statistics.flg_t_open_opp)) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action LIKE 'B_%') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_bet AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and lookup_actions_t.action = 'BF') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_summary.cnt_players >= 3 and tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b))) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_open_opp AND lookup_actions_f.action LIKE 'X' AND lookup_actions_p.action NOT LIKE '%R' AND tourney_hand_player_statistics.flg_p_face_raise AND ((tourney_hand_player_statistics.val_p_raise_aggressor_pos < tourney_hand_player_statistics.position AND tourney_hand_summary.cnt_players >= 3) OR (tourney_hand_summary.cnt_players = 2 and tourney_hand_player_statistics.flg_blind_b)) and (tourney_hand_player_statistics.flg_p_3bet_def_opp OR tourney_hand_player_statistics.flg_p_4bet_def_opp)) then  1 else  0 end))), (sum(tourney_hand_player_statistics.cnt_t_raise)), (sum((case when(tourney_hand_player_statistics.cnt_t_raise > 0 AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_t_raise > 0 AND tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_t_saw) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_blind_b = false AND tourney_hand_player_statistics.flg_blind_s AND tourney_hand_player_statistics.flg_vpip) then  1 else  0 end))), (sum((case when(lookup_actions_p.action = '') then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown and tourney_hand_player_statistics.amt_bet_ttl > 5 * tourney_blinds.amt_bb) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown AND tourney_hand_player_statistics.flg_won_hand) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.flg_showdown and tourney_hand_player_statistics.flg_won_hand and tourney_hand_player_statistics.amt_bet_ttl > 5 * tourney_blinds.amt_bb) then  1 else  0 end))), (sum((case when(tourney_hand_player_statistics.cnt_r_call > 0 AND tourney_hand_player_statistics.flg_won_hand AND tourney_hand_player_statistics.flg_showdown) then  1 else  0 end))), (sum((case when( tourney_hand_player_statistics.enum_allin='P' OR tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p' OR  tourney_hand_player_statistics.enum_allin='F' OR tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f' OR  tourney_hand_player_statistics.enum_allin='T' OR tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t' OR  tourney_hand_player_statistics.enum_allin='R' OR tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r' ) then    ( (case when(tourney_hand_player_statistics.enum_allin='P' OR ((tourney_hand_player_statistics.enum_face_allin='P' OR tourney_hand_player_statistics.enum_face_allin='p') AND  tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='F' OR ((tourney_hand_player_statistics.enum_face_allin='F' OR tourney_hand_player_statistics.enum_face_allin='f') AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='T' OR ((tourney_hand_player_statistics.enum_face_allin='T' OR tourney_hand_player_statistics.enum_face_allin='t') AND  tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) ) +  ( (case when(tourney_hand_player_statistics.enum_allin='R' OR ((tourney_hand_player_statistics.enum_face_allin='R' OR tourney_hand_player_statistics.enum_face_allin='r') AND tourney_hand_player_statistics.enum_face_allin_action<>'F')) then  tourney_hand_player_statistics.val_equity else  0 end) )   else  0 end))), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND (char_length(lookup_actions_f.action) != 0 AND char_length(lookup_actions_t.action) = 0 AND char_length(lookup_actions_r.action) = 0)) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND char_length(lookup_actions_f.action) = 0) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0 AND  char_length(lookup_actions_r.action) != 0) then  tourney_hand_player_statistics.val_equity else  0 end) )), (sum( (case when(tourney_hand_player_statistics.val_equity>0  AND char_length(lookup_actions_t.action) != 0 AND char_length(lookup_actions_r.action) = 0) then  tourney_hand_player_statistics.val_equity else  0 end) )) FROM	                 tourney_hand_player_statistics , tourney_hand_summary, lookup_actions lookup_actions_f, lookup_actions lookup_actions_t, tourney_blinds, lookup_actions lookup_actions_p, lookup_actions lookup_actions_r, lookup_positions WHERE (tourney_hand_summary.id_hand = tourney_hand_player_statistics.id_hand AND tourney_hand_summary.id_blinds = tourney_hand_player_statistics.id_blinds)  AND (lookup_actions_f.id_action=tourney_hand_player_statistics.id_action_f)  AND (lookup_actions_t.id_action=tourney_hand_player_statistics.id_action_t)  AND (tourney_blinds.id_blinds = tourney_hand_player_statistics.id_blinds)  AND (lookup_actions_p.id_action=tourney_hand_player_statistics.id_action_p)  AND (lookup_actions_r.id_action=tourney_hand_player_statistics.id_action_r)  AND (lookup_positions."position"=tourney_hand_player_statistics."position" AND lookup_positions.cnt_players=tourney_hand_player_statistics.cnt_players_lookup_position)  AND (tourney_blinds.id_blinds = tourney_hand_summary.id_blinds)     AND ((tourney_hand_player_statistics.id_player >= $1 AND tourney_hand_player_statistics.id_player <= $2))  GROUP BY tourney_hand_player_statistics.id_player, tourney_hand_player_statistics.id_gametype, tourney_hand_player_statistics.id_blinds, tourney_hand_summary.cnt_players,  ((case when( lookup_positions.flg_sb) then  0 else  (case when( lookup_positions.flg_bb) then  1 else  (case when( lookup_positions.flg_ep) then  2 else  (case when( lookup_positions.flg_mp) then  3 else  (case when( lookup_positions.flg_co) then  4 else  5 end) end) end) end) end)),  (tourney_hand_player_statistics.flg_f_has_position),  (tourney_hand_player_statistics.flg_t_has_position),  (tourney_hand_player_statistics.flg_r_has_position),  (CAST ( ((date_part('year',  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')) * 100) + (EXTRACT (WEEK FROM  timezone('UTC',  tourney_hand_player_statistics.date_played  + INTERVAL '0 HOURS')))) AS integer )) 

  LOOP  
    <<insertCashPlayerDataToCache>>
    BEGIN
      INSERT INTO tourney_cache VALUES(playerdata.id_player, playerdata.id_gametype, playerdata.id_blinds, playerdata.cnt_players,playerdata.position_type::integer,playerdata.flg_has_position_f::boolean,playerdata.flg_has_position_t::boolean,playerdata.flg_has_position_r::boolean,playerdata.date_played_year_week::integer,playerdata.amt_bb_won::numeric(14,2),playerdata.amt_blind::numeric(14,2),playerdata.amt_chips_won::numeric(14,2),playerdata.amt_expected_bb_won::numeric(14,2),playerdata.amt_expected_won::numeric(14,2),playerdata.amt_r_call::numeric(14,2),playerdata.amt_r_call_won::numeric(14,2),playerdata.cnt_blind::integer,playerdata.cnt_f_2bet_def_action_call::integer,playerdata.cnt_f_2bet_def_action_fold::integer,playerdata.cnt_f_3bet::integer,playerdata.cnt_f_3bet_def_action_call::integer,playerdata.cnt_f_3bet_def_action_fold::integer,playerdata.cnt_f_3bet_def_opp::integer,playerdata.cnt_f_3bet_opp::integer,playerdata.cnt_f_4bet::integer,playerdata.cnt_f_4bet_def_action_call::integer,playerdata.cnt_f_4bet_def_action_fold::integer,playerdata.cnt_f_4bet_def_opp::integer,playerdata.cnt_f_4bet_opp::integer,playerdata.cnt_f_allin::integer,playerdata.cnt_f_allin_valid::integer,playerdata.cnt_f_bet::integer,playerdata.cnt_f_bet_def_action_call::integer,playerdata.cnt_f_bet_def_action_fold::integer,playerdata.cnt_f_bet_def_action_raise::integer,playerdata.cnt_f_bet_def_opp::integer,playerdata.cnt_f_bet_limp_pot::integer,playerdata.cnt_f_call::integer,playerdata.cnt_f_cbet::integer,playerdata.cnt_f_cbet_3bet_pot::integer,playerdata.cnt_f_cbet_def_action_call::integer,playerdata.cnt_f_cbet_def_action_call_in_pos::integer,playerdata.cnt_f_cbet_def_action_call_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_fold::integer,playerdata.cnt_f_cbet_def_action_fold_in_pos::integer,playerdata.cnt_f_cbet_def_action_fold_out_of_pos::integer,playerdata.cnt_f_cbet_def_action_raise::integer,playerdata.cnt_f_cbet_def_action_raise_in_pos::integer,playerdata.cnt_f_cbet_def_action_raise_out_of_pos::integer,playerdata.cnt_f_cbet_def_opp::integer,playerdata.cnt_f_cbet_face_raise::integer,playerdata.cnt_f_cbet_face_raise_3bet_pot::integer,playerdata.cnt_f_cbet_fold_to_raise::integer,playerdata.cnt_f_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_f_cbet_opp::integer,playerdata.cnt_f_cbet_opp_3bet_pot::integer,playerdata.cnt_f_cbet_success::integer,playerdata.cnt_f_check::integer,playerdata.cnt_f_check_raise::integer,playerdata.cnt_f_check_raise_opp::integer,playerdata.cnt_f_donk::integer,playerdata.cnt_f_donk_3bet_pot::integer,playerdata.cnt_f_donk_def_opp::integer,playerdata.cnt_f_donk_def_opp_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_call::integer,playerdata.cnt_f_donk_def_opp_action_fold::integer,playerdata.cnt_f_donk_def_opp_action_fold_3bet_pot::integer,playerdata.cnt_f_donk_def_opp_action_raise::integer,playerdata.cnt_f_donk_def_opp_action_raise_3bet_pot::integer,playerdata.cnt_f_donk_face_raise::integer,playerdata.cnt_f_donk_fold::integer,playerdata.cnt_f_donk_opp::integer,playerdata.cnt_f_donk_opp_3bet_pot::integer,playerdata.cnt_f_face_xr::integer,playerdata.cnt_f_face_xr_call::integer,playerdata.cnt_f_face_xr_fold::integer,playerdata.cnt_f_face_xr_raise::integer,playerdata.cnt_f_float::integer,playerdata.cnt_f_float_3bet_pot::integer,playerdata.cnt_f_float_def_opp::integer,playerdata.cnt_f_float_def_opp_action_call::integer,playerdata.cnt_f_float_def_opp_action_fold::integer,playerdata.cnt_f_float_def_opp_action_raise::integer,playerdata.cnt_f_float_face_raise::integer,playerdata.cnt_f_float_fold::integer,playerdata.cnt_f_float_opp::integer,playerdata.cnt_f_float_opp_3bet_pot::integer,playerdata.cnt_f_fold::integer,playerdata.cnt_f_open_opp_limp_pot::integer,playerdata.cnt_f_raise::integer,playerdata.cnt_f_raise_def_opp::integer,playerdata.cnt_f_saw::integer,playerdata.cnt_f_saw_won::integer,playerdata.cnt_hands::integer,playerdata.cnt_hands_won::integer,playerdata.cnt_p_2bet_def_action_call::integer,playerdata.cnt_p_2bet_def_action_fold::integer,playerdata.cnt_p_2bet_def_opp::integer,playerdata.cnt_p_2bet_def_opp_vs_btn_open::integer,playerdata.cnt_p_2bet_def_opp_vs_co_open::integer,playerdata.cnt_p_3bet::integer,playerdata.cnt_p_3bet_def_action_call::integer,playerdata.cnt_p_3bet_def_action_call_after_2b::integer,playerdata.cnt_p_3bet_def_action_fold::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_action_fold_when_open_raised_oop::integer,playerdata.cnt_p_3bet_def_opp::integer,playerdata.cnt_p_3bet_def_opp_after_2b::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_ip::integer,playerdata.cnt_p_3bet_def_opp_when_open_raised_oop::integer,playerdata.cnt_p_3bet_f_cbet_def_action_call::integer,playerdata.cnt_p_3bet_f_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_f_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_f_cbet_def_opp::integer,playerdata.cnt_p_3bet_opp::integer,playerdata.cnt_p_3bet_opp_vs_bb_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_2bet::integer,playerdata.cnt_p_3bet_opp_vs_btn_open::integer,playerdata.cnt_p_3bet_opp_vs_co_2bet::integer,playerdata.cnt_p_3bet_opp_vs_co_open::integer,playerdata.cnt_p_3bet_opp_vs_ep_2bet::integer,playerdata.cnt_p_3bet_opp_vs_mp_2bet::integer,playerdata.cnt_p_3bet_opp_vs_sb_2bet::integer,playerdata.cnt_p_3bet_r_cbet_def_action_call::integer,playerdata.cnt_p_3bet_r_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_r_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_r_cbet_def_opp::integer,playerdata.cnt_p_3bet_success::integer,playerdata.cnt_p_3bet_t_cbet_def_action_call::integer,playerdata.cnt_p_3bet_t_cbet_def_action_fold::integer,playerdata.cnt_p_3bet_t_cbet_def_action_raise::integer,playerdata.cnt_p_3bet_t_cbet_def_opp::integer,playerdata.cnt_p_3bet_vs_bb_2bet::integer,playerdata.cnt_p_3bet_vs_btn_2bet::integer,playerdata.cnt_p_3bet_vs_btn_open::integer,playerdata.cnt_p_3bet_vs_co_2bet::integer,playerdata.cnt_p_3bet_vs_co_open::integer,playerdata.cnt_p_3bet_vs_ep_2bet::integer,playerdata.cnt_p_3bet_vs_mp_2bet::integer,playerdata.cnt_p_3bet_vs_sb_2bet::integer,playerdata.cnt_p_4bet::integer,playerdata.cnt_p_4bet_after_raising::integer,playerdata.cnt_p_4bet_cold::integer,playerdata.cnt_p_4bet_cold_opp::integer,playerdata.cnt_p_4bet_def_action_call::integer,playerdata.cnt_p_4bet_def_action_fold::integer,playerdata.cnt_p_4bet_def_action_fold_after_3b::integer,playerdata.cnt_p_4bet_def_opp::integer,playerdata.cnt_p_4bet_def_opp_after_3b::integer,playerdata.cnt_p_4bet_def_opp_when_open_raised::integer,playerdata.cnt_p_4bet_opp::integer,playerdata.cnt_p_4bet_opp_when_open_raised::integer,playerdata.cnt_p_5bet::integer,playerdata.cnt_p_5bet_def_action_fold::integer,playerdata.cnt_p_5bet_def_opp::integer,playerdata.cnt_p_5bet_opp::integer,playerdata.cnt_p_allin::integer,playerdata.cnt_p_allin_valid::integer,playerdata.cnt_p_bb_v_sb_3bet::integer,playerdata.cnt_p_bb_v_sb_3bet_opp::integer,playerdata.cnt_p_bb_v_sb_call::integer,playerdata.cnt_p_bb_v_sb_fold::integer,playerdata.cnt_p_call::integer,playerdata.cnt_p_call_vs_btn_open::integer,playerdata.cnt_p_call_vs_co_open::integer,playerdata.cnt_p_ccall::integer,playerdata.cnt_p_ccall_3bet::integer,playerdata.cnt_p_ccall_3bet_opp::integer,playerdata.cnt_p_ccall_opp::integer,playerdata.cnt_p_facing_limpers::integer,playerdata.cnt_p_fold::integer,playerdata.cnt_p_fold_vs_btn_open::integer,playerdata.cnt_p_fold_vs_co_open::integer,playerdata.cnt_p_limp::integer,playerdata.cnt_p_limp_call::integer,playerdata.cnt_p_limp_faceraise::integer,playerdata.cnt_p_limp_fold::integer,playerdata.cnt_p_limp_opp::integer,playerdata.cnt_p_limp_opp_facing_limpers::integer,playerdata.cnt_p_limp_raise::integer,playerdata.cnt_p_open_opp::integer,playerdata.cnt_p_open_opp_btn::integer,playerdata.cnt_p_open_opp_ep::integer,playerdata.cnt_p_raise::integer,playerdata.cnt_p_raise_3bet::integer,playerdata.cnt_p_raise_first_in::integer,playerdata.cnt_p_raise_limpers::integer,playerdata.cnt_p_rfi_btn::integer,playerdata.cnt_p_rfi_ep::integer,playerdata.cnt_p_squeeze::integer,playerdata.cnt_p_squeeze_def_call::integer,playerdata.cnt_p_squeeze_def_fold::integer,playerdata.cnt_p_squeeze_def_opp::integer,playerdata.cnt_p_squeeze_def_raise::integer,playerdata.cnt_p_squeeze_opp::integer,playerdata.cnt_pfr::integer,playerdata.cnt_pfr_opp::integer,playerdata.cnt_prev_callers_limp::integer,playerdata.cnt_r_2bet_def_action_call::integer,playerdata.cnt_r_2bet_def_action_fold::integer,playerdata.cnt_r_3bet::integer,playerdata.cnt_r_3bet_def_action_call::integer,playerdata.cnt_r_3bet_def_action_fold::integer,playerdata.cnt_r_3bet_def_opp::integer,playerdata.cnt_r_3bet_opp::integer,playerdata.cnt_r_4bet::integer,playerdata.cnt_r_4bet_def_action_call::integer,playerdata.cnt_r_4bet_def_action_fold::integer,playerdata.cnt_r_4bet_def_opp::integer,playerdata.cnt_r_4bet_opp::integer,playerdata.cnt_r_allin::integer,playerdata.cnt_r_allin_valid::integer,playerdata.cnt_r_bet::integer,playerdata.cnt_r_bet_def_action_call::integer,playerdata.cnt_r_bet_def_action_fold::integer,playerdata.cnt_r_bet_def_action_raise::integer,playerdata.cnt_r_bet_def_opp::integer,playerdata.cnt_r_call::integer,playerdata.cnt_r_call_hands::integer,playerdata.cnt_r_cbet::integer,playerdata.cnt_r_cbet_3bet_pot::integer,playerdata.cnt_r_cbet_def_action_call::integer,playerdata.cnt_r_cbet_def_action_fold::integer,playerdata.cnt_r_cbet_def_action_raise::integer,playerdata.cnt_r_cbet_def_opp::integer,playerdata.cnt_r_cbet_face_raise::integer,playerdata.cnt_r_cbet_face_raise_3bet_pot::integer,playerdata.cnt_r_cbet_fold_to_raise::integer,playerdata.cnt_r_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_r_cbet_opp::integer,playerdata.cnt_r_cbet_opp_3bet_pot::integer,playerdata.cnt_r_cbet_success::integer,playerdata.cnt_r_check::integer,playerdata.cnt_r_check_raise::integer,playerdata.cnt_r_check_raise_opp::integer,playerdata.cnt_r_donk::integer,playerdata.cnt_r_donk_3bet_pot::integer,playerdata.cnt_r_donk_def_action_call::integer,playerdata.cnt_r_donk_def_action_fold::integer,playerdata.cnt_r_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_r_donk_def_action_raise::integer,playerdata.cnt_r_donk_def_opp::integer,playerdata.cnt_r_donk_def_opp_3bet_pot::integer,playerdata.cnt_r_donk_face_raise::integer,playerdata.cnt_r_donk_fold::integer,playerdata.cnt_r_donk_opp::integer,playerdata.cnt_r_donk_opp_3bet_pot::integer,playerdata.cnt_r_face_xr::integer,playerdata.cnt_r_face_xr_call::integer,playerdata.cnt_r_face_xr_fold::integer,playerdata.cnt_r_face_xr_raise::integer,playerdata.cnt_r_float::integer,playerdata.cnt_r_float_3bet_pot::integer,playerdata.cnt_r_float_def_action_call::integer,playerdata.cnt_r_float_def_action_fold::integer,playerdata.cnt_r_float_def_action_raise::integer,playerdata.cnt_r_float_def_opp::integer,playerdata.cnt_r_float_face_raise::integer,playerdata.cnt_r_float_fold::integer,playerdata.cnt_r_float_opp::integer,playerdata.cnt_r_float_opp_3bet_pot::integer,playerdata.cnt_r_fold::integer,playerdata.cnt_r_probe::integer,playerdata.cnt_r_probe_3bet_pot::integer,playerdata.cnt_r_probe_def_action_call::integer,playerdata.cnt_r_probe_def_action_fold::integer,playerdata.cnt_r_probe_def_action_raise::integer,playerdata.cnt_r_probe_def_opp::integer,playerdata.cnt_r_probe_face_raise::integer,playerdata.cnt_r_probe_fold::integer,playerdata.cnt_r_probe_opp::integer,playerdata.cnt_r_probe_opp_3bet_pot::integer,playerdata.cnt_r_raise::integer,playerdata.cnt_r_raise_wtsd::integer,playerdata.cnt_r_raise_wtsd_won::integer,playerdata.cnt_r_saw::integer,playerdata.cnt_steal_3bet_def_action_fold::integer,playerdata.cnt_steal_3bet_def_opp::integer,playerdata.cnt_steal_att::integer,playerdata.cnt_steal_att_lp::integer,playerdata.cnt_steal_att_sb::integer,playerdata.cnt_steal_def_3bet_opp::integer,playerdata.cnt_steal_def_3bet_opp_vs_lp::integer,playerdata.cnt_steal_def_action_call::integer,playerdata.cnt_steal_def_action_call_vs_lp::integer,playerdata.cnt_steal_def_action_fold::integer,playerdata.cnt_steal_def_action_fold_vs_lp::integer,playerdata.cnt_steal_def_action_raise::integer,playerdata.cnt_steal_def_action_raise_vs_lp::integer,playerdata.cnt_steal_def_opp::integer,playerdata.cnt_steal_def_opp_vs_lp::integer,playerdata.cnt_steal_opp::integer,playerdata.cnt_steal_opp_lp::integer,playerdata.cnt_steal_opp_sb::integer,playerdata.cnt_steal_reraise_def_action_fold::integer,playerdata.cnt_steal_reraise_def_opp::integer,playerdata.cnt_steal_success::integer,playerdata.cnt_t_2bet_def_action_call::integer,playerdata.cnt_t_2bet_def_action_fold::integer,playerdata.cnt_t_3bet::integer,playerdata.cnt_t_3bet_def_action_call::integer,playerdata.cnt_t_3bet_def_action_fold::integer,playerdata.cnt_t_3bet_def_opp::integer,playerdata.cnt_t_3bet_opp::integer,playerdata.cnt_t_4bet::integer,playerdata.cnt_t_4bet_def_action_call::integer,playerdata.cnt_t_4bet_def_action_fold::integer,playerdata.cnt_t_4bet_def_opp::integer,playerdata.cnt_t_4bet_opp::integer,playerdata.cnt_t_allin::integer,playerdata.cnt_t_allin_showdown::integer,playerdata.cnt_t_allin_valid::integer,playerdata.cnt_t_bet::integer,playerdata.cnt_t_bet_def_action_call::integer,playerdata.cnt_t_bet_def_action_fold::integer,playerdata.cnt_t_bet_def_action_raise::integer,playerdata.cnt_t_bet_def_opp::integer,playerdata.cnt_t_call::integer,playerdata.cnt_t_cbet::integer,playerdata.cnt_t_cbet_3bet_pot::integer,playerdata.cnt_t_cbet_def_action_call::integer,playerdata.cnt_t_cbet_def_action_fold::integer,playerdata.cnt_t_cbet_def_action_raise::integer,playerdata.cnt_t_cbet_def_opp::integer,playerdata.cnt_t_cbet_face_raise::integer,playerdata.cnt_t_cbet_face_raise_3bet_pot::integer,playerdata.cnt_t_cbet_fold_to_raise::integer,playerdata.cnt_t_cbet_fold_to_raise_3bet_pot::integer,playerdata.cnt_t_cbet_opp::integer,playerdata.cnt_t_cbet_opp_3bet_pot::integer,playerdata.cnt_t_cbet_success::integer,playerdata.cnt_t_check::integer,playerdata.cnt_t_check_raise::integer,playerdata.cnt_t_check_raise_opp::integer,playerdata.cnt_t_donk::integer,playerdata.cnt_t_donk_3bet_pot::integer,playerdata.cnt_t_donk_def_action_call::integer,playerdata.cnt_t_donk_def_action_fold::integer,playerdata.cnt_t_donk_def_action_fold_3bet_pot::integer,playerdata.cnt_t_donk_def_action_raise::integer,playerdata.cnt_t_donk_def_opp::integer,playerdata.cnt_t_donk_def_opp_3bet_pot::integer,playerdata.cnt_t_donk_face_raise::integer,playerdata.cnt_t_donk_fold::integer,playerdata.cnt_t_donk_opp::integer,playerdata.cnt_t_donk_opp_3bet_pot::integer,playerdata.cnt_t_face_xr::integer,playerdata.cnt_t_face_xr_call::integer,playerdata.cnt_t_face_xr_fold::integer,playerdata.cnt_t_face_xr_raise::integer,playerdata.cnt_t_float::integer,playerdata.cnt_t_float_3bet_pot::integer,playerdata.cnt_t_float_def_action_call::integer,playerdata.cnt_t_float_def_action_fold::integer,playerdata.cnt_t_float_def_action_raise::integer,playerdata.cnt_t_float_def_opp::integer,playerdata.cnt_t_float_face_raise::integer,playerdata.cnt_t_float_fold::integer,playerdata.cnt_t_float_opp::integer,playerdata.cnt_t_float_opp_3bet_pot::integer,playerdata.cnt_t_fold::integer,playerdata.cnt_t_probe::integer,playerdata.cnt_t_probe_3bet_pot::integer,playerdata.cnt_t_probe_def_action_call::integer,playerdata.cnt_t_probe_def_action_fold::integer,playerdata.cnt_t_probe_def_action_raise::integer,playerdata.cnt_t_probe_def_opp::integer,playerdata.cnt_t_probe_face_raise::integer,playerdata.cnt_t_probe_fold::integer,playerdata.cnt_t_probe_opp::integer,playerdata.cnt_t_probe_opp_3bet_pot::integer,playerdata.cnt_t_raise::integer,playerdata.cnt_t_raise_wtsd::integer,playerdata.cnt_t_raise_wtsd_won::integer,playerdata.cnt_t_saw::integer,playerdata.cnt_vpip::integer,playerdata.cnt_vpip_sb::integer,playerdata.cnt_walks::integer,playerdata.cnt_won_hand::integer,playerdata.cnt_wtsd::integer,playerdata.cnt_wtsd_non_small::integer,playerdata.cnt_wtsd_won::integer,playerdata.cnt_wtsd_won_non_small::integer,playerdata.cnt_wtsd_won_when_r_call::integer,playerdata.val_equity::numeric(14,2),playerdata.val_f_equity::numeric(14,2),playerdata.val_p_equity::numeric(14,2),playerdata.val_r_equity::numeric(14,2),playerdata.val_t_equity::numeric(14,2));
      CONTINUE;
    END insertCashPlayerDataToCache;
    
  END LOOP getCashPlayersDataToCache;
  
  RETURN;
END;
$_$;


ALTER FUNCTION public.update_tourney_cache_playerrange(integer, integer) OWNER TO %USERNAME%;

--
-- TOC entry 233 (class 1255 OID 17426)
-- Name: update_tourney_custom_cache(); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_tourney_custom_cache() RETURNS void
    LANGUAGE plpgsql
    AS $$

BEGIN
  -- There are no elements to cache so do nothing
  RETURN;
END;
$$;


ALTER FUNCTION public.update_tourney_custom_cache() OWNER TO %USERNAME%;

--
-- TOC entry 236 (class 1255 OID 17429)
-- Name: update_tourney_custom_cache_date(integer, text); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_tourney_custom_cache_date(integer, text) RETURNS void
    LANGUAGE plpgsql
    AS $$

BEGIN
  -- There are no elements to cache so do nothing
  RETURN;
END;
$$;


ALTER FUNCTION public.update_tourney_custom_cache_date(integer, text) OWNER TO %USERNAME%;

--
-- TOC entry 234 (class 1255 OID 17427)
-- Name: update_tourney_custom_cache_player(integer); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_tourney_custom_cache_player(integer) RETURNS void
    LANGUAGE plpgsql
    AS $$

BEGIN
  -- There are no elements to cache so do nothing
  RETURN;
END;
$$;


ALTER FUNCTION public.update_tourney_custom_cache_player(integer) OWNER TO %USERNAME%;

--
-- TOC entry 235 (class 1255 OID 17428)
-- Name: update_tourney_custom_cache_playerrange(integer, integer); Type: FUNCTION; Schema: public; Owner: %USERNAME%
--

CREATE FUNCTION public.update_tourney_custom_cache_playerrange(integer, integer) RETURNS void
    LANGUAGE plpgsql
    AS $$

BEGIN
  -- There are no elements to cache so do nothing
  RETURN;
END;
$$;


ALTER FUNCTION public.update_tourney_custom_cache_playerrange(integer, integer) OWNER TO %USERNAME%;

SET default_tablespace = '';

SET default_with_oids = false;

--
-- TOC entry 205 (class 1259 OID 17379)
-- Name: cash_cache; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_cache (
    id_player integer NOT NULL,
    id_gametype integer NOT NULL,
    id_limit integer NOT NULL,
    cnt_players integer NOT NULL,
    position_type integer NOT NULL,
    flg_has_position_f boolean NOT NULL,
    flg_has_position_t boolean NOT NULL,
    flg_has_position_r boolean NOT NULL,
    date_played_year_week integer NOT NULL,
    amt_bb_won numeric(14,2),
    amt_bb_won_inc_payout numeric(14,2),
    amt_blind numeric(14,2),
    amt_blind_curr_conv numeric(14,2),
    amt_expected_bb_won numeric(14,2),
    amt_expected_won numeric(14,2),
    amt_expected_won_curr_conv numeric(14,2),
    amt_jackpot_taken numeric(14,2),
    amt_jackpot_taken_curr_conv numeric(14,2),
    amt_payout numeric(14,2),
    amt_payout_curr_conv numeric(14,2),
    amt_payout_fee numeric(14,2),
    amt_payout_fee_curr_conv numeric(14,2),
    amt_r_call numeric(14,2),
    amt_r_call_won numeric(14,2),
    amt_rake_attributed numeric(14,2),
    amt_rake_attributed_curr_conv numeric(14,2),
    amt_rake_share numeric(14,2),
    amt_rake_share_curr_conv numeric(14,2),
    amt_rake_taken numeric(14,2),
    amt_rake_taken_curr_conv numeric(14,2),
    amt_rake_weighted_contributed numeric(14,2),
    amt_rake_weighted_contributed_curr_conv numeric(14,2),
    amt_straddle numeric(14,2),
    amt_straddle_curr_conv numeric(14,2),
    amt_won numeric(14,2),
    amt_won_curr_conv numeric(14,2),
    amt_won_inc_payout numeric(14,2),
    amt_won_inc_payout_curr_conv numeric(14,2),
    cnt_blind integer,
    cnt_f_2bet_def_action_call integer,
    cnt_f_2bet_def_action_fold integer,
    cnt_f_3bet integer,
    cnt_f_3bet_def_action_call integer,
    cnt_f_3bet_def_action_fold integer,
    cnt_f_3bet_def_opp integer,
    cnt_f_3bet_opp integer,
    cnt_f_4bet integer,
    cnt_f_4bet_def_action_call integer,
    cnt_f_4bet_def_action_fold integer,
    cnt_f_4bet_def_opp integer,
    cnt_f_4bet_opp integer,
    cnt_f_allin integer,
    cnt_f_allin_valid integer,
    cnt_f_bet integer,
    cnt_f_bet_def_action_call integer,
    cnt_f_bet_def_action_fold integer,
    cnt_f_bet_def_action_raise integer,
    cnt_f_bet_def_opp integer,
    cnt_f_bet_limp_pot integer,
    cnt_f_call integer,
    cnt_f_cbet integer,
    cnt_f_cbet_3bet_pot integer,
    cnt_f_cbet_def_action_call integer,
    cnt_f_cbet_def_action_call_in_pos integer,
    cnt_f_cbet_def_action_call_out_of_pos integer,
    cnt_f_cbet_def_action_fold integer,
    cnt_f_cbet_def_action_fold_in_pos integer,
    cnt_f_cbet_def_action_fold_out_of_pos integer,
    cnt_f_cbet_def_action_raise integer,
    cnt_f_cbet_def_action_raise_in_pos integer,
    cnt_f_cbet_def_action_raise_out_of_pos integer,
    cnt_f_cbet_def_opp integer,
    cnt_f_cbet_face_raise integer,
    cnt_f_cbet_face_raise_3bet_pot integer,
    cnt_f_cbet_fold_to_raise integer,
    cnt_f_cbet_fold_to_raise_3bet_pot integer,
    cnt_f_cbet_opp integer,
    cnt_f_cbet_opp_3bet_pot integer,
    cnt_f_cbet_success integer,
    cnt_f_check integer,
    cnt_f_check_raise integer,
    cnt_f_check_raise_opp integer,
    cnt_f_donk integer,
    cnt_f_donk_3bet_pot integer,
    cnt_f_donk_def_opp integer,
    cnt_f_donk_def_opp_3bet_pot integer,
    cnt_f_donk_def_opp_action_call integer,
    cnt_f_donk_def_opp_action_fold integer,
    cnt_f_donk_def_opp_action_fold_3bet_pot integer,
    cnt_f_donk_def_opp_action_raise integer,
    cnt_f_donk_def_opp_action_raise_3bet_pot integer,
    cnt_f_donk_face_raise integer,
    cnt_f_donk_fold integer,
    cnt_f_donk_opp integer,
    cnt_f_donk_opp_3bet_pot integer,
    cnt_f_face_xr integer,
    cnt_f_face_xr_call integer,
    cnt_f_face_xr_fold integer,
    cnt_f_face_xr_raise integer,
    cnt_f_float integer,
    cnt_f_float_3bet_pot integer,
    cnt_f_float_def_opp integer,
    cnt_f_float_def_opp_action_call integer,
    cnt_f_float_def_opp_action_fold integer,
    cnt_f_float_def_opp_action_raise integer,
    cnt_f_float_face_raise integer,
    cnt_f_float_fold integer,
    cnt_f_float_opp integer,
    cnt_f_float_opp_3bet_pot integer,
    cnt_f_fold integer,
    cnt_f_open_opp_limp_pot integer,
    cnt_f_raise integer,
    cnt_f_raise_def_opp integer,
    cnt_f_saw integer,
    cnt_f_saw_won integer,
    cnt_hands integer,
    cnt_hands_won integer,
    cnt_p_2bet_def_action_call integer,
    cnt_p_2bet_def_action_fold integer,
    cnt_p_2bet_def_opp integer,
    cnt_p_2bet_def_opp_vs_btn_open integer,
    cnt_p_2bet_def_opp_vs_co_open integer,
    cnt_p_3bet integer,
    cnt_p_3bet_def_action_call integer,
    cnt_p_3bet_def_action_call_after_2b integer,
    cnt_p_3bet_def_action_fold integer,
    cnt_p_3bet_def_action_fold_when_open_raised integer,
    cnt_p_3bet_def_action_fold_when_open_raised_ip integer,
    cnt_p_3bet_def_action_fold_when_open_raised_oop integer,
    cnt_p_3bet_def_opp integer,
    cnt_p_3bet_def_opp_after_2b integer,
    cnt_p_3bet_def_opp_when_open_raised integer,
    cnt_p_3bet_def_opp_when_open_raised_ip integer,
    cnt_p_3bet_def_opp_when_open_raised_oop integer,
    cnt_p_3bet_f_cbet_def_action_call integer,
    cnt_p_3bet_f_cbet_def_action_fold integer,
    cnt_p_3bet_f_cbet_def_action_raise integer,
    cnt_p_3bet_f_cbet_def_opp integer,
    cnt_p_3bet_opp integer,
    cnt_p_3bet_opp_vs_bb_2bet integer,
    cnt_p_3bet_opp_vs_btn_2bet integer,
    cnt_p_3bet_opp_vs_btn_open integer,
    cnt_p_3bet_opp_vs_co_2bet integer,
    cnt_p_3bet_opp_vs_co_open integer,
    cnt_p_3bet_opp_vs_ep_2bet integer,
    cnt_p_3bet_opp_vs_mp_2bet integer,
    cnt_p_3bet_opp_vs_sb_2bet integer,
    cnt_p_3bet_r_cbet_def_action_call integer,
    cnt_p_3bet_r_cbet_def_action_fold integer,
    cnt_p_3bet_r_cbet_def_action_raise integer,
    cnt_p_3bet_r_cbet_def_opp integer,
    cnt_p_3bet_success integer,
    cnt_p_3bet_t_cbet_def_action_call integer,
    cnt_p_3bet_t_cbet_def_action_fold integer,
    cnt_p_3bet_t_cbet_def_action_raise integer,
    cnt_p_3bet_t_cbet_def_opp integer,
    cnt_p_3bet_vs_bb_2bet integer,
    cnt_p_3bet_vs_btn_2bet integer,
    cnt_p_3bet_vs_btn_open integer,
    cnt_p_3bet_vs_co_2bet integer,
    cnt_p_3bet_vs_co_open integer,
    cnt_p_3bet_vs_ep_2bet integer,
    cnt_p_3bet_vs_mp_2bet integer,
    cnt_p_3bet_vs_sb_2bet integer,
    cnt_p_4bet integer,
    cnt_p_4bet_after_raising integer,
    cnt_p_4bet_cold integer,
    cnt_p_4bet_cold_opp integer,
    cnt_p_4bet_def_action_call integer,
    cnt_p_4bet_def_action_fold integer,
    cnt_p_4bet_def_action_fold_after_3b integer,
    cnt_p_4bet_def_opp integer,
    cnt_p_4bet_def_opp_after_3b integer,
    cnt_p_4bet_def_opp_when_open_raised integer,
    cnt_p_4bet_opp integer,
    cnt_p_4bet_opp_when_open_raised integer,
    cnt_p_5bet integer,
    cnt_p_5bet_def_action_fold integer,
    cnt_p_5bet_def_opp integer,
    cnt_p_5bet_opp integer,
    cnt_p_allin integer,
    cnt_p_allin_valid integer,
    cnt_p_bb_v_sb_3bet integer,
    cnt_p_bb_v_sb_3bet_opp integer,
    cnt_p_bb_v_sb_call integer,
    cnt_p_bb_v_sb_fold integer,
    cnt_p_call integer,
    cnt_p_call_vs_btn_open integer,
    cnt_p_call_vs_co_open integer,
    cnt_p_ccall integer,
    cnt_p_ccall_3bet integer,
    cnt_p_ccall_3bet_opp integer,
    cnt_p_ccall_opp integer,
    cnt_p_facing_limpers integer,
    cnt_p_fold integer,
    cnt_p_fold_vs_btn_open integer,
    cnt_p_fold_vs_co_open integer,
    cnt_p_limp integer,
    cnt_p_limp_call integer,
    cnt_p_limp_faceraise integer,
    cnt_p_limp_fold integer,
    cnt_p_limp_opp integer,
    cnt_p_limp_opp_facing_limpers integer,
    cnt_p_limp_raise integer,
    cnt_p_open_opp integer,
    cnt_p_open_opp_btn integer,
    cnt_p_open_opp_ep integer,
    cnt_p_raise integer,
    cnt_p_raise_3bet integer,
    cnt_p_raise_first_in integer,
    cnt_p_raise_limpers integer,
    cnt_p_rfi_btn integer,
    cnt_p_rfi_ep integer,
    cnt_p_squeeze integer,
    cnt_p_squeeze_def_call integer,
    cnt_p_squeeze_def_fold integer,
    cnt_p_squeeze_def_opp integer,
    cnt_p_squeeze_def_raise integer,
    cnt_p_squeeze_opp integer,
    cnt_pfr integer,
    cnt_pfr_opp integer,
    cnt_players_ttl integer,
    cnt_prev_callers_limp integer,
    cnt_r_2bet_def_action_call integer,
    cnt_r_2bet_def_action_fold integer,
    cnt_r_3bet integer,
    cnt_r_3bet_def_action_call integer,
    cnt_r_3bet_def_action_fold integer,
    cnt_r_3bet_def_opp integer,
    cnt_r_3bet_opp integer,
    cnt_r_4bet integer,
    cnt_r_4bet_def_action_call integer,
    cnt_r_4bet_def_action_fold integer,
    cnt_r_4bet_def_opp integer,
    cnt_r_4bet_opp integer,
    cnt_r_allin integer,
    cnt_r_allin_valid integer,
    cnt_r_bet integer,
    cnt_r_bet_def_action_call integer,
    cnt_r_bet_def_action_fold integer,
    cnt_r_bet_def_action_raise integer,
    cnt_r_bet_def_opp integer,
    cnt_r_call integer,
    cnt_r_call_hands integer,
    cnt_r_cbet integer,
    cnt_r_cbet_3bet_pot integer,
    cnt_r_cbet_def_action_call integer,
    cnt_r_cbet_def_action_fold integer,
    cnt_r_cbet_def_action_raise integer,
    cnt_r_cbet_def_opp integer,
    cnt_r_cbet_face_raise integer,
    cnt_r_cbet_face_raise_3bet_pot integer,
    cnt_r_cbet_fold_to_raise integer,
    cnt_r_cbet_fold_to_raise_3bet_pot integer,
    cnt_r_cbet_opp integer,
    cnt_r_cbet_opp_3bet_pot integer,
    cnt_r_cbet_success integer,
    cnt_r_check integer,
    cnt_r_check_raise integer,
    cnt_r_check_raise_opp integer,
    cnt_r_donk integer,
    cnt_r_donk_3bet_pot integer,
    cnt_r_donk_def_action_call integer,
    cnt_r_donk_def_action_fold integer,
    cnt_r_donk_def_action_fold_3bet_pot integer,
    cnt_r_donk_def_action_raise integer,
    cnt_r_donk_def_opp integer,
    cnt_r_donk_def_opp_3bet_pot integer,
    cnt_r_donk_face_raise integer,
    cnt_r_donk_fold integer,
    cnt_r_donk_opp integer,
    cnt_r_donk_opp_3bet_pot integer,
    cnt_r_face_xr integer,
    cnt_r_face_xr_call integer,
    cnt_r_face_xr_fold integer,
    cnt_r_face_xr_raise integer,
    cnt_r_float integer,
    cnt_r_float_3bet_pot integer,
    cnt_r_float_def_action_call integer,
    cnt_r_float_def_action_fold integer,
    cnt_r_float_def_action_raise integer,
    cnt_r_float_def_opp integer,
    cnt_r_float_face_raise integer,
    cnt_r_float_fold integer,
    cnt_r_float_opp integer,
    cnt_r_float_opp_3bet_pot integer,
    cnt_r_fold integer,
    cnt_r_probe integer,
    cnt_r_probe_3bet_pot integer,
    cnt_r_probe_def_action_call integer,
    cnt_r_probe_def_action_fold integer,
    cnt_r_probe_def_action_raise integer,
    cnt_r_probe_def_opp integer,
    cnt_r_probe_face_raise integer,
    cnt_r_probe_fold integer,
    cnt_r_probe_opp integer,
    cnt_r_probe_opp_3bet_pot integer,
    cnt_r_raise integer,
    cnt_r_raise_wtsd integer,
    cnt_r_raise_wtsd_won integer,
    cnt_r_saw integer,
    cnt_steal_3bet_def_action_fold integer,
    cnt_steal_3bet_def_opp integer,
    cnt_steal_att integer,
    cnt_steal_att_lp integer,
    cnt_steal_att_sb integer,
    cnt_steal_def_3bet_opp integer,
    cnt_steal_def_3bet_opp_vs_lp integer,
    cnt_steal_def_action_call integer,
    cnt_steal_def_action_call_vs_lp integer,
    cnt_steal_def_action_fold integer,
    cnt_steal_def_action_fold_vs_lp integer,
    cnt_steal_def_action_raise integer,
    cnt_steal_def_action_raise_vs_lp integer,
    cnt_steal_def_opp integer,
    cnt_steal_def_opp_vs_lp integer,
    cnt_steal_opp integer,
    cnt_steal_opp_lp integer,
    cnt_steal_opp_sb integer,
    cnt_steal_reraise_def_action_fold integer,
    cnt_steal_reraise_def_opp integer,
    cnt_steal_success integer,
    cnt_t_2bet_def_action_call integer,
    cnt_t_2bet_def_action_fold integer,
    cnt_t_3bet integer,
    cnt_t_3bet_def_action_call integer,
    cnt_t_3bet_def_action_fold integer,
    cnt_t_3bet_def_opp integer,
    cnt_t_3bet_opp integer,
    cnt_t_4bet integer,
    cnt_t_4bet_def_action_call integer,
    cnt_t_4bet_def_action_fold integer,
    cnt_t_4bet_def_opp integer,
    cnt_t_4bet_opp integer,
    cnt_t_allin integer,
    cnt_t_allin_valid integer,
    cnt_t_bet integer,
    cnt_t_bet_def_action_call integer,
    cnt_t_bet_def_action_fold integer,
    cnt_t_bet_def_action_raise integer,
    cnt_t_bet_def_opp integer,
    cnt_t_call integer,
    cnt_t_cbet integer,
    cnt_t_cbet_3bet_pot integer,
    cnt_t_cbet_def_action_call integer,
    cnt_t_cbet_def_action_fold integer,
    cnt_t_cbet_def_action_raise integer,
    cnt_t_cbet_def_opp integer,
    cnt_t_cbet_face_raise integer,
    cnt_t_cbet_face_raise_3bet_pot integer,
    cnt_t_cbet_fold_to_raise integer,
    cnt_t_cbet_fold_to_raise_3bet_pot integer,
    cnt_t_cbet_opp integer,
    cnt_t_cbet_opp_3bet_pot integer,
    cnt_t_cbet_success integer,
    cnt_t_check integer,
    cnt_t_check_raise integer,
    cnt_t_check_raise_opp integer,
    cnt_t_donk integer,
    cnt_t_donk_3bet_pot integer,
    cnt_t_donk_def_action_call integer,
    cnt_t_donk_def_action_fold integer,
    cnt_t_donk_def_action_fold_3bet_pot integer,
    cnt_t_donk_def_action_raise integer,
    cnt_t_donk_def_opp integer,
    cnt_t_donk_def_opp_3bet_pot integer,
    cnt_t_donk_face_raise integer,
    cnt_t_donk_fold integer,
    cnt_t_donk_opp integer,
    cnt_t_donk_opp_3bet_pot integer,
    cnt_t_face_xr integer,
    cnt_t_face_xr_call integer,
    cnt_t_face_xr_fold integer,
    cnt_t_face_xr_raise integer,
    cnt_t_float integer,
    cnt_t_float_3bet_pot integer,
    cnt_t_float_def_action_call integer,
    cnt_t_float_def_action_fold integer,
    cnt_t_float_def_action_raise integer,
    cnt_t_float_def_opp integer,
    cnt_t_float_face_raise integer,
    cnt_t_float_fold integer,
    cnt_t_float_opp integer,
    cnt_t_float_opp_3bet_pot integer,
    cnt_t_fold integer,
    cnt_t_probe integer,
    cnt_t_probe_3bet_pot integer,
    cnt_t_probe_def_action_call integer,
    cnt_t_probe_def_action_fold integer,
    cnt_t_probe_def_action_raise integer,
    cnt_t_probe_def_opp integer,
    cnt_t_probe_face_raise integer,
    cnt_t_probe_fold integer,
    cnt_t_probe_opp integer,
    cnt_t_probe_opp_3bet_pot integer,
    cnt_t_raise integer,
    cnt_t_raise_wtsd integer,
    cnt_t_raise_wtsd_won integer,
    cnt_t_saw integer,
    cnt_vpip integer,
    cnt_vpip_sb integer,
    cnt_walks integer,
    cnt_won_hand integer,
    cnt_wtsd integer,
    cnt_wtsd_allin integer,
    cnt_wtsd_non_small integer,
    cnt_wtsd_won integer,
    cnt_wtsd_won_non_small integer,
    cnt_wtsd_won_when_r_call integer,
    limit_currency text,
    val_equity numeric(14,2),
    val_f_equity numeric(14,2),
    val_p_equity numeric(14,2),
    val_r_equity numeric(14,2),
    val_t_equity numeric(14,2)
);


ALTER TABLE public.cash_cache OWNER TO %USERNAME%;

--
-- TOC entry 206 (class 1259 OID 17396)
-- Name: cash_custom_cache; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_custom_cache (
    id_player integer NOT NULL,
    id_gametype integer NOT NULL,
    id_limit integer NOT NULL,
    cnt_players integer NOT NULL,
    position_type integer NOT NULL,
    flg_has_position_f boolean NOT NULL,
    flg_has_position_t boolean NOT NULL,
    flg_has_position_r boolean NOT NULL,
    date_played_year_week integer NOT NULL
);


ALTER TABLE public.cash_custom_cache OWNER TO %USERNAME%;

--
-- TOC entry 174 (class 1259 OID 16704)
-- Name: cash_hand_histories; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_hand_histories (
    id_hand integer NOT NULL,
    history text
);


ALTER TABLE public.cash_hand_histories OWNER TO %USERNAME%;

--
-- TOC entry 173 (class 1259 OID 16628)
-- Name: cash_hand_player_combinations; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_hand_player_combinations (
    id_hand integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_player integer NOT NULL,
    flg_f_highcard boolean DEFAULT false,
    flg_f_1pair boolean DEFAULT false,
    flg_f_2pair boolean DEFAULT false,
    flg_f_threeoak boolean DEFAULT false,
    flg_f_straight boolean DEFAULT false,
    flg_f_flush boolean DEFAULT false,
    flg_f_fullhouse boolean DEFAULT false,
    flg_f_fouroak boolean DEFAULT false,
    flg_f_strflush boolean DEFAULT false,
    id_f_hand_strength smallint DEFAULT 0,
    id_f_kicker_strength smallint DEFAULT 0,
    val_f_hole_cards_used smallint DEFAULT 0,
    flg_f_gutshot_draw boolean DEFAULT false,
    flg_f_straight_draw boolean DEFAULT false,
    flg_f_2gutshot_draw boolean DEFAULT false,
    flg_f_flush_draw boolean DEFAULT false,
    flg_f_wrap_draw boolean DEFAULT false,
    val_f_wrap_outs smallint DEFAULT 0,
    flg_f_bflush_draw boolean DEFAULT false,
    flg_f_bstraight_draw boolean DEFAULT false,
    id_f_flush_draw_strength smallint DEFAULT 0,
    val_f_straight_draw_nut_outs smallint DEFAULT 0,
    val_f_straight_draw_nonnut_outs smallint DEFAULT 0,
    flg_f_low_hand boolean DEFAULT false,
    val_f_low_hand_strength smallint DEFAULT 0,
    flg_f_nut_flush_blocker boolean DEFAULT false,
    flg_f_low_draw boolean DEFAULT false,
    val_f_low_draw_strength smallint DEFAULT 0,
    flg_t_highcard boolean DEFAULT false,
    flg_t_1pair boolean DEFAULT false,
    flg_t_2pair boolean DEFAULT false,
    flg_t_threeoak boolean DEFAULT false,
    flg_t_straight boolean DEFAULT false,
    flg_t_flush boolean DEFAULT false,
    flg_t_fullhouse boolean DEFAULT false,
    flg_t_fouroak boolean DEFAULT false,
    flg_t_strflush boolean DEFAULT false,
    id_t_hand_strength smallint DEFAULT 0,
    id_t_kicker_strength smallint DEFAULT 0,
    val_t_hole_cards_used smallint DEFAULT 0,
    flg_t_gutshot_draw boolean DEFAULT false,
    flg_t_straight_draw boolean DEFAULT false,
    flg_t_2gutshot_draw boolean DEFAULT false,
    flg_t_flush_draw boolean DEFAULT false,
    flg_t_wrap_draw boolean DEFAULT false,
    val_t_wrap_outs smallint DEFAULT 0,
    id_t_flush_draw_strength smallint DEFAULT 0,
    val_t_straight_draw_nut_outs smallint DEFAULT 0,
    val_t_straight_draw_nonnut_outs smallint DEFAULT 0,
    flg_t_low_hand boolean DEFAULT false,
    val_t_low_hand_strength smallint DEFAULT 0,
    flg_t_nut_flush_blocker boolean DEFAULT false,
    flg_t_low_draw boolean DEFAULT false,
    val_t_low_draw_strength smallint DEFAULT 0,
    flg_r_highcard boolean DEFAULT false,
    flg_r_1pair boolean DEFAULT false,
    flg_r_2pair boolean DEFAULT false,
    flg_r_threeoak boolean DEFAULT false,
    flg_r_straight boolean DEFAULT false,
    flg_r_flush boolean DEFAULT false,
    flg_r_fullhouse boolean DEFAULT false,
    flg_r_fouroak boolean DEFAULT false,
    flg_r_strflush boolean DEFAULT false,
    id_r_hand_strength smallint DEFAULT 0,
    id_r_kicker_strength smallint DEFAULT 0,
    val_r_hole_cards_used smallint DEFAULT 0,
    flg_r_low_hand boolean DEFAULT false,
    val_r_low_hand_strength smallint DEFAULT 0,
    flg_r_nut_flush_blocker boolean DEFAULT false
);


ALTER TABLE public.cash_hand_player_combinations OWNER TO %USERNAME%;

--
-- TOC entry 172 (class 1259 OID 16421)
-- Name: cash_hand_player_statistics; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_hand_player_statistics (
    id_hand integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_player integer NOT NULL,
    id_player_real integer NOT NULL,
    id_holecard smallint NOT NULL,
    id_limit smallint NOT NULL,
    id_session integer NOT NULL,
    date_played timestamp without time zone NOT NULL,
    "position" smallint,
    cnt_players smallint,
    cnt_players_lookup_position smallint,
    cnt_p_raise smallint DEFAULT 0,
    flg_p_first_raise boolean DEFAULT false,
    cnt_p_call smallint DEFAULT 0,
    flg_p_limp boolean DEFAULT false,
    flg_p_fold boolean DEFAULT false,
    flg_p_ccall boolean DEFAULT false,
    cnt_p_face_limpers smallint DEFAULT 0,
    flg_vpip boolean DEFAULT false,
    flg_f_bet boolean DEFAULT false,
    cnt_f_raise smallint DEFAULT 0,
    flg_f_first_raise boolean DEFAULT false,
    cnt_f_call smallint DEFAULT 0,
    flg_f_check boolean DEFAULT false,
    flg_f_check_raise boolean DEFAULT false,
    flg_f_fold boolean DEFAULT false,
    flg_f_saw boolean DEFAULT false,
    flg_t_bet boolean DEFAULT false,
    cnt_t_raise smallint DEFAULT 0,
    flg_t_first_raise boolean DEFAULT false,
    cnt_t_call smallint DEFAULT 0,
    flg_t_check boolean DEFAULT false,
    flg_t_check_raise boolean DEFAULT false,
    flg_t_fold boolean DEFAULT false,
    flg_t_saw boolean DEFAULT false,
    flg_r_bet boolean DEFAULT false,
    cnt_r_raise smallint DEFAULT 0,
    flg_r_first_raise boolean DEFAULT false,
    cnt_r_call smallint DEFAULT 0,
    flg_r_check boolean DEFAULT false,
    flg_r_check_raise boolean DEFAULT false,
    flg_r_fold boolean DEFAULT false,
    flg_r_saw boolean DEFAULT false,
    enum_allin character(1),
    enum_face_allin character(1),
    enum_face_allin_action character(1),
    flg_blind_s boolean DEFAULT false,
    flg_blind_b boolean DEFAULT false,
    flg_blind_ds boolean DEFAULT false,
    flg_blind_db boolean DEFAULT false,
    flg_sb_steal_fold boolean DEFAULT false,
    flg_bb_steal_fold boolean DEFAULT false,
    flg_blind_def_opp boolean DEFAULT false,
    flg_steal_att boolean DEFAULT false,
    flg_steal_opp boolean DEFAULT false,
    flg_blind_k boolean DEFAULT false,
    flg_showdown boolean DEFAULT false,
    flg_won_hand boolean DEFAULT false,
    amt_won numeric(14,2) DEFAULT 0,
    amt_expected_won numeric(14,2) DEFAULT 0,
    amt_payout numeric(14,2) DEFAULT 0,
    amt_payout_fee numeric(14,2) DEFAULT 0,
    amt_straddle numeric(11,2) DEFAULT 0,
    val_equity numeric(6,5) DEFAULT 0,
    id_final_hand smallint NOT NULL,
    id_final_hand_lo integer NOT NULL,
    flg_showed boolean DEFAULT false,
    enum_folded character(1),
    flg_p_face_raise boolean DEFAULT false,
    flg_p_3bet boolean DEFAULT false,
    flg_p_3bet_opp boolean DEFAULT false,
    flg_p_3bet_def_opp boolean DEFAULT false,
    enum_p_3bet_action character(1),
    flg_p_4bet boolean DEFAULT false,
    flg_p_4bet_opp boolean DEFAULT false,
    flg_p_4bet_def_opp boolean DEFAULT false,
    enum_p_4bet_action character(1),
    flg_p_squeeze boolean DEFAULT false,
    flg_p_squeeze_opp boolean DEFAULT false,
    flg_p_squeeze_def_opp boolean DEFAULT false,
    enum_p_squeeze_action character(1),
    flg_f_face_raise boolean DEFAULT false,
    flg_f_3bet boolean DEFAULT false,
    flg_f_3bet_opp boolean DEFAULT false,
    flg_f_3bet_def_opp boolean DEFAULT false,
    enum_f_3bet_action character(1),
    flg_f_4bet boolean DEFAULT false,
    flg_f_4bet_opp boolean DEFAULT false,
    flg_f_4bet_def_opp boolean DEFAULT false,
    enum_f_4bet_action character(1),
    flg_f_cbet boolean DEFAULT false,
    flg_f_cbet_opp boolean DEFAULT false,
    flg_f_cbet_def_opp boolean DEFAULT false,
    enum_f_cbet_action character(1),
    flg_t_face_raise boolean DEFAULT false,
    flg_t_3bet boolean DEFAULT false,
    flg_t_3bet_opp boolean DEFAULT false,
    flg_t_3bet_def_opp boolean DEFAULT false,
    enum_t_3bet_action character(1),
    flg_t_4bet boolean DEFAULT false,
    flg_t_4bet_opp boolean DEFAULT false,
    flg_t_4bet_def_opp boolean DEFAULT false,
    enum_t_4bet_action character(1),
    flg_t_cbet boolean DEFAULT false,
    flg_t_cbet_opp boolean DEFAULT false,
    flg_t_cbet_def_opp boolean DEFAULT false,
    enum_t_cbet_action character(1),
    flg_t_float boolean DEFAULT false,
    flg_t_float_opp boolean DEFAULT false,
    flg_t_float_def_opp boolean DEFAULT false,
    enum_t_float_action character(1),
    flg_t_donk boolean DEFAULT false,
    flg_t_donk_opp boolean DEFAULT false,
    flg_t_donk_def_opp boolean DEFAULT false,
    enum_t_donk_action character(1),
    flg_r_face_raise boolean DEFAULT false,
    flg_r_3bet boolean DEFAULT false,
    flg_r_3bet_opp boolean DEFAULT false,
    flg_r_3bet_def_opp boolean DEFAULT false,
    enum_r_3bet_action character(1),
    flg_r_4bet boolean DEFAULT false,
    flg_r_4bet_opp boolean DEFAULT false,
    flg_r_4bet_def_opp boolean DEFAULT false,
    enum_r_4bet_action character(1),
    flg_r_cbet boolean DEFAULT false,
    flg_r_cbet_opp boolean DEFAULT false,
    flg_r_cbet_def_opp boolean DEFAULT false,
    enum_r_cbet_action character(1),
    flg_r_float boolean DEFAULT false,
    flg_r_float_opp boolean DEFAULT false,
    flg_r_float_def_opp boolean DEFAULT false,
    enum_r_float_action character(1),
    flg_r_donk boolean DEFAULT false,
    flg_r_donk_opp boolean DEFAULT false,
    flg_r_donk_def_opp boolean DEFAULT false,
    enum_r_donk_action character(1),
    val_curr_conv numeric(12,4),
    seat smallint,
    holecard_1 smallint NOT NULL,
    holecard_2 smallint NOT NULL,
    holecard_3 smallint NOT NULL,
    holecard_4 smallint NOT NULL,
    id_suits smallint NOT NULL,
    flg_hero boolean DEFAULT false,
    amt_before numeric(14,2),
    amt_blind numeric(11,2) DEFAULT 0,
    amt_ante numeric(11,2) DEFAULT 0,
    amt_bet_p numeric(14,2) DEFAULT 0,
    amt_bet_f numeric(14,2) DEFAULT 0,
    amt_bet_t numeric(14,2) DEFAULT 0,
    amt_bet_r numeric(14,2) DEFAULT 0,
    amt_bet_ttl numeric(14,2) DEFAULT 0,
    id_action_p integer DEFAULT 0,
    id_action_f integer DEFAULT 0,
    id_action_t integer DEFAULT 0,
    id_action_r integer DEFAULT 0,
    flg_p_open boolean DEFAULT false,
    flg_p_open_opp boolean DEFAULT false,
    flg_f_first boolean DEFAULT false,
    flg_f_open boolean DEFAULT false,
    flg_f_open_opp boolean DEFAULT false,
    flg_f_has_position boolean DEFAULT false,
    flg_t_first boolean DEFAULT false,
    flg_t_open boolean DEFAULT false,
    flg_t_open_opp boolean DEFAULT false,
    flg_t_has_position boolean DEFAULT false,
    flg_r_first boolean DEFAULT false,
    flg_r_open boolean DEFAULT false,
    flg_r_open_opp boolean DEFAULT false,
    flg_r_has_position boolean DEFAULT false,
    amt_p_effective_stack numeric(14,2) DEFAULT 0,
    amt_f_effective_stack numeric(14,2) DEFAULT 0,
    amt_t_effective_stack numeric(14,2) DEFAULT 0,
    amt_r_effective_stack numeric(14,2) DEFAULT 0,
    amt_p_raise_facing numeric(14,2) DEFAULT 0,
    val_p_raise_facing_pct numeric(11,2) DEFAULT 0,
    amt_p_2bet_facing numeric(14,2) DEFAULT 0,
    val_p_2bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_p_3bet_facing numeric(14,2) DEFAULT 0,
    val_p_3bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_p_4bet_facing numeric(14,2) DEFAULT 0,
    val_p_4bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_p_5bet_facing numeric(14,2) DEFAULT 0,
    val_p_5bet_facing_pct numeric(11,2) DEFAULT 0,
    val_p_raise_aggressor_pos smallint,
    amt_p_raise_made numeric(14,2) DEFAULT 0,
    val_p_raise_made_pct numeric(11,2) DEFAULT 0,
    amt_p_raise_made_2 numeric(14,2) DEFAULT 0,
    val_p_raise_made_2_pct numeric(11,2) DEFAULT 0,
    amt_f_bet_facing numeric(14,2) DEFAULT 0,
    val_f_bet_facing_pct numeric(11,2) DEFAULT 0,
    val_f_bet_aggressor_pos smallint,
    amt_f_bet_made numeric(14,2) DEFAULT 0,
    val_f_bet_made_pct numeric(11,2) DEFAULT 0,
    amt_f_raise_facing numeric(14,2) DEFAULT 0,
    val_f_raise_facing_pct numeric(11,2) DEFAULT 0,
    amt_f_2bet_facing numeric(14,2) DEFAULT 0,
    val_f_2bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_f_3bet_facing numeric(14,2) DEFAULT 0,
    val_f_3bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_f_4bet_facing numeric(14,2) DEFAULT 0,
    val_f_4bet_facing_pct numeric(11,2) DEFAULT 0,
    val_f_raise_aggressor_pos smallint,
    amt_f_raise_made numeric(14,2) DEFAULT 0,
    val_f_raise_made_pct numeric(11,2) DEFAULT 0,
    amt_f_raise_made_2 numeric(14,2) DEFAULT 0,
    val_f_raise_made_2_pct numeric(11,2) DEFAULT 0,
    amt_t_bet_facing numeric(14,2) DEFAULT 0,
    val_t_bet_facing_pct numeric(11,2) DEFAULT 0,
    val_t_bet_aggressor_pos smallint,
    amt_t_bet_made numeric(14,2) DEFAULT 0,
    val_t_bet_made_pct numeric(11,2) DEFAULT 0,
    amt_t_raise_facing numeric(14,2) DEFAULT 0,
    val_t_raise_facing_pct numeric(11,2) DEFAULT 0,
    amt_t_2bet_facing numeric(14,2) DEFAULT 0,
    val_t_2bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_t_3bet_facing numeric(14,2) DEFAULT 0,
    val_t_3bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_t_4bet_facing numeric(14,2) DEFAULT 0,
    val_t_4bet_facing_pct numeric(11,2) DEFAULT 0,
    val_t_raise_aggressor_pos smallint,
    amt_t_raise_made numeric(14,2) DEFAULT 0,
    val_t_raise_made_pct numeric(11,2) DEFAULT 0,
    amt_t_raise_made_2 numeric(14,2) DEFAULT 0,
    val_t_raise_made_2_pct numeric(11,2) DEFAULT 0,
    amt_r_bet_facing numeric(14,2) DEFAULT 0,
    val_r_bet_facing_pct numeric(11,2) DEFAULT 0,
    val_r_bet_aggressor_pos smallint,
    amt_r_bet_made numeric(14,2) DEFAULT 0,
    val_r_bet_made_pct numeric(11,2) DEFAULT 0,
    amt_r_raise_facing numeric(14,2) DEFAULT 0,
    val_r_raise_facing_pct numeric(11,2) DEFAULT 0,
    amt_r_2bet_facing numeric(14,2) DEFAULT 0,
    val_r_2bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_r_3bet_facing numeric(14,2) DEFAULT 0,
    val_r_3bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_r_4bet_facing numeric(14,2) DEFAULT 0,
    val_r_4bet_facing_pct numeric(11,2) DEFAULT 0,
    val_r_raise_aggressor_pos smallint,
    amt_r_raise_made numeric(14,2) DEFAULT 0,
    val_r_raise_made_pct numeric(11,2) DEFAULT 0,
    amt_r_raise_made_2 numeric(14,2) DEFAULT 0,
    val_r_raise_made_2_pct numeric(11,2) DEFAULT 0
);


ALTER TABLE public.cash_hand_player_statistics OWNER TO %USERNAME%;

--
-- TOC entry 2955 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_allin; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_allin IS 'Poss Values: P, F, T, R, N';


--
-- TOC entry 2956 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_face_allin; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_face_allin IS 'Poss Values: P, F, T, R, N';


--
-- TOC entry 2957 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_face_allin_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_face_allin_action IS 'Poss Values: F, C, R, N';


--
-- TOC entry 2958 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_folded; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_folded IS 'Poss Values: P, F, T, R, N';


--
-- TOC entry 2959 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_p_3bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_p_3bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2960 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_p_4bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_p_4bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2961 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_f_3bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_f_3bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2962 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_f_4bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_f_4bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2963 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_t_3bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_t_3bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2964 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_t_4bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_t_4bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2965 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_r_3bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_r_3bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2966 (class 0 OID 0)
-- Dependencies: 172
-- Name: COLUMN cash_hand_player_statistics.enum_r_4bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.cash_hand_player_statistics.enum_r_4bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 171 (class 1259 OID 16394)
-- Name: cash_hand_summary; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_hand_summary (
    id_hand integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_site smallint NOT NULL,
    id_limit smallint NOT NULL,
    id_table integer NOT NULL,
    hand_no character varying(32) NOT NULL,
    date_played timestamp without time zone NOT NULL,
    date_imported timestamp without time zone NOT NULL,
    cnt_players smallint DEFAULT 0,
    cnt_players_lookup_position smallint DEFAULT 0,
    cnt_players_f smallint DEFAULT 0,
    cnt_players_t smallint DEFAULT 0,
    cnt_players_r smallint DEFAULT 0,
    amt_pot numeric(14,2) DEFAULT 0,
    amt_rake numeric(14,2) DEFAULT 0,
    amt_jackpot_fee numeric(11,2) DEFAULT 0,
    amt_short_stack numeric(14,2) DEFAULT 0,
    amt_mgr numeric(14,2) DEFAULT 0,
    amt_pot_p numeric(14,2) DEFAULT 0,
    amt_pot_f numeric(14,2) DEFAULT 0,
    amt_pot_t numeric(14,2) DEFAULT 0,
    amt_pot_r numeric(14,2) DEFAULT 0,
    str_actors_p character varying(10),
    str_actors_f character varying(10),
    str_actors_t character varying(10),
    str_actors_r character varying(10),
    str_aggressors_p character varying(10),
    str_aggressors_f character varying(10),
    str_aggressors_t character varying(10),
    str_aggressors_r character varying(10),
    id_win_hand smallint,
    id_win_hand_lo integer,
    id_winner integer,
    id_winner_lo integer,
    button smallint NOT NULL,
    card_1 smallint,
    card_2 smallint,
    card_3 smallint,
    card_4 smallint,
    card_5 smallint,
    flg_note boolean DEFAULT false,
    flg_tag boolean DEFAULT false,
    flg_autonote boolean DEFAULT false
);


ALTER TABLE public.cash_hand_summary OWNER TO %USERNAME%;

--
-- TOC entry 175 (class 1259 OID 16712)
-- Name: cash_limit; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_limit (
    id_limit smallint NOT NULL,
    limit_name text,
    id_gametype smallint NOT NULL,
    limit_currency character(3) NOT NULL,
    amt_sb numeric(11,2),
    amt_bb numeric(11,2),
    flg_nlpl boolean,
    flg_nl boolean,
    flg_pl boolean,
    flg_lo boolean,
    flg_fr boolean,
    flg_sh boolean,
    flg_hu boolean,
    id_filter integer NOT NULL
);


ALTER TABLE public.cash_limit OWNER TO %USERNAME%;

--
-- TOC entry 176 (class 1259 OID 16720)
-- Name: cash_table; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_table (
    id_table integer NOT NULL,
    table_name text
);


ALTER TABLE public.cash_table OWNER TO %USERNAME%;

--
-- TOC entry 177 (class 1259 OID 16728)
-- Name: cash_table_session_summary; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.cash_table_session_summary (
    id_session integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_site smallint NOT NULL,
    id_player integer NOT NULL,
    id_player_real integer NOT NULL,
    id_limit integer NOT NULL,
    id_table integer NOT NULL,
    date_start timestamp without time zone,
    date_end timestamp without time zone,
    cnt_minutes integer,
    seat integer,
    amt_pot numeric(14,2),
    amt_won numeric(14,2),
    amt_rake numeric(14,2),
    amt_rake_contributed numeric(14,2),
    amt_rake_contributed_weighted numeric(14,2),
    amt_mgr numeric(14,2),
    cnt_hands integer,
    cnt_hands_won integer,
    cnt_ttl_players integer,
    cnt_ttl_players_flop integer,
    flg_note boolean DEFAULT false,
    flg_tag boolean DEFAULT false,
    val_curr_conv numeric(12,4)
);


ALTER TABLE public.cash_table_session_summary OWNER TO %USERNAME%;

--
-- TOC entry 202 (class 1259 OID 17285)
-- Name: live_cash_player; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.live_cash_player (
    id_player integer NOT NULL,
    id_player_real integer NOT NULL,
    id_live_table integer NOT NULL,
    amt_ante numeric(11,2) DEFAULT 0,
    amt_before numeric(11,2) DEFAULT 0,
    amt_stack numeric(11,2) DEFAULT 0,
    amt_won numeric(11,2) DEFAULT 0,
    amt_won_1 numeric(11,2) DEFAULT 0,
    amt_won_2 numeric(11,2) DEFAULT 0,
    amt_won_3 numeric(11,2) DEFAULT 0,
    amt_won_4 numeric(11,2) DEFAULT 0,
    amt_won_5 numeric(11,2) DEFAULT 0,
    amt_won_6 numeric(11,2) DEFAULT 0,
    amt_won_7 numeric(11,2) DEFAULT 0,
    amt_won_8 numeric(11,2) DEFAULT 0,
    amt_won_9 numeric(11,2) DEFAULT 0
);


ALTER TABLE public.live_cash_player OWNER TO %USERNAME%;

--
-- TOC entry 201 (class 1259 OID 17231)
-- Name: live_cash_table; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.live_cash_table (
    id_live_table integer NOT NULL,
    amt_ante numeric(11,2) DEFAULT 0,
    amt_sb numeric(11,2) DEFAULT 0,
    amt_bb numeric(11,2) DEFAULT 0,
    amt_avg_stack numeric(11,2) DEFAULT 0,
    amt_min_stack numeric(11,2) DEFAULT 0,
    amt_pot numeric(11,2) DEFAULT 0,
    amt_rake numeric(11,2) DEFAULT 0,
    cnt_players integer DEFAULT 0,
    cnt_saw_flop integer DEFAULT 0,
    winner text,
    cnt_hands integer DEFAULT 1,
    amt_pot_1 numeric(11,2) DEFAULT 0,
    amt_pot_2 numeric(11,2) DEFAULT 0,
    amt_pot_3 numeric(11,2) DEFAULT 0,
    amt_pot_4 numeric(11,2) DEFAULT 0,
    amt_pot_5 numeric(11,2) DEFAULT 0,
    amt_pot_6 numeric(11,2) DEFAULT 0,
    amt_pot_7 numeric(11,2) DEFAULT 0,
    amt_pot_8 numeric(11,2) DEFAULT 0,
    amt_pot_9 numeric(11,2) DEFAULT 0,
    amt_rake_1 numeric(11,2) DEFAULT 0,
    amt_rake_2 numeric(11,2) DEFAULT 0,
    amt_rake_3 numeric(11,2) DEFAULT 0,
    amt_rake_4 numeric(11,2) DEFAULT 0,
    amt_rake_5 numeric(11,2) DEFAULT 0,
    amt_rake_6 numeric(11,2) DEFAULT 0,
    amt_rake_7 numeric(11,2) DEFAULT 0,
    amt_rake_8 numeric(11,2) DEFAULT 0,
    amt_rake_9 numeric(11,2) DEFAULT 0,
    cnt_players_1 integer DEFAULT 0,
    cnt_players_2 integer DEFAULT 0,
    cnt_players_3 integer DEFAULT 0,
    cnt_players_4 integer DEFAULT 0,
    cnt_players_5 integer DEFAULT 0,
    cnt_players_6 integer DEFAULT 0,
    cnt_players_7 integer DEFAULT 0,
    cnt_players_8 integer DEFAULT 0,
    cnt_players_9 integer DEFAULT 0,
    cnt_saw_flop_1 integer DEFAULT 0,
    cnt_saw_flop_2 integer DEFAULT 0,
    cnt_saw_flop_3 integer DEFAULT 0,
    cnt_saw_flop_4 integer DEFAULT 0,
    cnt_saw_flop_5 integer DEFAULT 0,
    cnt_saw_flop_6 integer DEFAULT 0,
    cnt_saw_flop_7 integer DEFAULT 0,
    cnt_saw_flop_8 integer DEFAULT 0,
    cnt_saw_flop_9 integer DEFAULT 0,
    winner_1 text,
    winner_2 text,
    winner_3 text,
    winner_4 text,
    winner_5 text,
    winner_6 text,
    winner_7 text,
    winner_8 text,
    winner_9 text
);


ALTER TABLE public.live_cash_table OWNER TO %USERNAME%;

--
-- TOC entry 204 (class 1259 OID 17359)
-- Name: live_tourney_player; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.live_tourney_player (
    id_player integer NOT NULL,
    id_player_real integer NOT NULL,
    id_live_table integer NOT NULL,
    amt_ante numeric(11,2) DEFAULT 0,
    amt_before numeric(11,2) DEFAULT 0,
    amt_stack numeric(11,2) DEFAULT 0,
    amt_won numeric(11,2) DEFAULT 0,
    amt_won_1 numeric(11,2) DEFAULT 0,
    amt_won_2 numeric(11,2) DEFAULT 0,
    amt_won_3 numeric(11,2) DEFAULT 0,
    amt_won_4 numeric(11,2) DEFAULT 0,
    amt_won_5 numeric(11,2) DEFAULT 0,
    amt_won_6 numeric(11,2) DEFAULT 0,
    amt_won_7 numeric(11,2) DEFAULT 0,
    amt_won_8 numeric(11,2) DEFAULT 0,
    amt_won_9 numeric(11,2) DEFAULT 0
);


ALTER TABLE public.live_tourney_player OWNER TO %USERNAME%;

--
-- TOC entry 203 (class 1259 OID 17305)
-- Name: live_tourney_table; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.live_tourney_table (
    id_live_table integer NOT NULL,
    amt_ante numeric(11,2) DEFAULT 0,
    amt_sb numeric(11,2) DEFAULT 0,
    amt_bb numeric(11,2) DEFAULT 0,
    amt_avg_stack numeric(11,2) DEFAULT 0,
    amt_min_stack numeric(11,2) DEFAULT 0,
    amt_pot numeric(11,2) DEFAULT 0,
    amt_rake numeric(11,2) DEFAULT 0,
    cnt_players integer DEFAULT 0,
    cnt_saw_flop integer DEFAULT 0,
    winner text,
    cnt_hands integer DEFAULT 1,
    amt_pot_1 numeric(11,2) DEFAULT 0,
    amt_pot_2 numeric(11,2) DEFAULT 0,
    amt_pot_3 numeric(11,2) DEFAULT 0,
    amt_pot_4 numeric(11,2) DEFAULT 0,
    amt_pot_5 numeric(11,2) DEFAULT 0,
    amt_pot_6 numeric(11,2) DEFAULT 0,
    amt_pot_7 numeric(11,2) DEFAULT 0,
    amt_pot_8 numeric(11,2) DEFAULT 0,
    amt_pot_9 numeric(11,2) DEFAULT 0,
    amt_rake_1 numeric(11,2) DEFAULT 0,
    amt_rake_2 numeric(11,2) DEFAULT 0,
    amt_rake_3 numeric(11,2) DEFAULT 0,
    amt_rake_4 numeric(11,2) DEFAULT 0,
    amt_rake_5 numeric(11,2) DEFAULT 0,
    amt_rake_6 numeric(11,2) DEFAULT 0,
    amt_rake_7 numeric(11,2) DEFAULT 0,
    amt_rake_8 numeric(11,2) DEFAULT 0,
    amt_rake_9 numeric(11,2) DEFAULT 0,
    cnt_players_1 integer DEFAULT 0,
    cnt_players_2 integer DEFAULT 0,
    cnt_players_3 integer DEFAULT 0,
    cnt_players_4 integer DEFAULT 0,
    cnt_players_5 integer DEFAULT 0,
    cnt_players_6 integer DEFAULT 0,
    cnt_players_7 integer DEFAULT 0,
    cnt_players_8 integer DEFAULT 0,
    cnt_players_9 integer DEFAULT 0,
    cnt_saw_flop_1 integer DEFAULT 0,
    cnt_saw_flop_2 integer DEFAULT 0,
    cnt_saw_flop_3 integer DEFAULT 0,
    cnt_saw_flop_4 integer DEFAULT 0,
    cnt_saw_flop_5 integer DEFAULT 0,
    cnt_saw_flop_6 integer DEFAULT 0,
    cnt_saw_flop_7 integer DEFAULT 0,
    cnt_saw_flop_8 integer DEFAULT 0,
    cnt_saw_flop_9 integer DEFAULT 0,
    winner_1 text,
    winner_2 text,
    winner_3 text,
    winner_4 text,
    winner_5 text,
    winner_6 text,
    winner_7 text,
    winner_8 text,
    winner_9 text
);


ALTER TABLE public.live_tourney_table OWNER TO %USERNAME%;

--
-- TOC entry 194 (class 1259 OID 17166)
-- Name: lookup_actions; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_actions (
    id_action integer NOT NULL,
    action text
);


ALTER TABLE public.lookup_actions OWNER TO %USERNAME%;

--
-- TOC entry 188 (class 1259 OID 17108)
-- Name: lookup_hand_groups; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_hand_groups (
    id_group smallint NOT NULL,
    group_name text NOT NULL
);


ALTER TABLE public.lookup_hand_groups OWNER TO %USERNAME%;

--
-- TOC entry 189 (class 1259 OID 17116)
-- Name: lookup_hand_ranks; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_hand_ranks (
    id_hand_rank smallint NOT NULL,
    id_group smallint NOT NULL,
    group_name text NOT NULL,
    group_details text
);


ALTER TABLE public.lookup_hand_ranks OWNER TO %USERNAME%;

--
-- TOC entry 190 (class 1259 OID 17124)
-- Name: lookup_hole_cards; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_hole_cards (
    id_holecard integer NOT NULL,
    id_gametype smallint NOT NULL,
    hole_cards character varying(4) NOT NULL,
    enum_pair_type character(1),
    val_pair_1 smallint DEFAULT 0 NOT NULL,
    val_pair_2 smallint DEFAULT 0 NOT NULL,
    flg_h_suited boolean DEFAULT false,
    flg_h_connector boolean DEFAULT false,
    flg_h_1_gap boolean DEFAULT false,
    flg_h_2_gap boolean DEFAULT false,
    flg_o_connector boolean DEFAULT false,
    flg_o_connector_2_str boolean DEFAULT false,
    flg_o_connector_2_gap boolean DEFAULT false,
    flg_o_connector_3 boolean DEFAULT false
);


ALTER TABLE public.lookup_hole_cards OWNER TO %USERNAME%;

--
-- TOC entry 192 (class 1259 OID 17147)
-- Name: lookup_positions; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_positions (
    cnt_players smallint NOT NULL,
    "position" smallint NOT NULL,
    absolute_position smallint NOT NULL,
    description character varying(6),
    flg_sb boolean DEFAULT false,
    flg_bb boolean DEFAULT false,
    flg_ep boolean DEFAULT false,
    flg_mp boolean DEFAULT false,
    flg_co boolean DEFAULT false,
    flg_btn boolean DEFAULT false
);


ALTER TABLE public.lookup_positions OWNER TO %USERNAME%;

--
-- TOC entry 193 (class 1259 OID 17158)
-- Name: lookup_sites; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_sites (
    id_site integer NOT NULL,
    site_abbrev character varying(3),
    site_name text
);


ALTER TABLE public.lookup_sites OWNER TO %USERNAME%;

--
-- TOC entry 191 (class 1259 OID 17139)
-- Name: lookup_suits_omaha; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_suits_omaha (
    id_suits integer NOT NULL,
    suits text
);


ALTER TABLE public.lookup_suits_omaha OWNER TO %USERNAME%;

--
-- TOC entry 195 (class 1259 OID 17174)
-- Name: lookup_tags; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_tags (
    id_tag integer NOT NULL,
    enum_type character(1) NOT NULL,
    tag text NOT NULL,
    icon text
);


ALTER TABLE public.lookup_tags OWNER TO %USERNAME%;

--
-- TOC entry 187 (class 1259 OID 17100)
-- Name: lookup_tourney_type; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.lookup_tourney_type (
    id_type smallint NOT NULL,
    description text
);


ALTER TABLE public.lookup_tourney_type OWNER TO %USERNAME%;

--
-- TOC entry 197 (class 1259 OID 17188)
-- Name: notes; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.notes (
    id_note integer NOT NULL,
    id_x integer NOT NULL,
    enum_type character(1) NOT NULL,
    flg_tournament boolean DEFAULT false,
    id_gametype smallint NOT NULL,
    date_note timestamp without time zone NOT NULL,
    id_color smallint,
    note text NOT NULL,
    note_tsvector tsvector
);


ALTER TABLE public.notes OWNER TO %USERNAME%;

--
-- TOC entry 198 (class 1259 OID 17199)
-- Name: notes_auto; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.notes_auto (
    id_autonote integer NOT NULL,
    id_player integer NOT NULL,
    uuid_name uuid NOT NULL,
    id_category smallint DEFAULT 0,
    flg_tournament boolean DEFAULT false,
    id_gametype smallint NOT NULL,
    note text NOT NULL,
    cnt_times integer DEFAULT 0,
    id_hands text NOT NULL,
    date_added timestamp without time zone NOT NULL,
    date_updated timestamp without time zone NOT NULL
);


ALTER TABLE public.notes_auto OWNER TO %USERNAME%;

--
-- TOC entry 199 (class 1259 OID 17211)
-- Name: player; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.player (
    id_player integer NOT NULL,
    id_site smallint NOT NULL,
    player_name text,
    player_name_search text,
    id_player_alias integer,
    flg_note boolean DEFAULT false,
    flg_tag boolean DEFAULT false,
    flg_anonymous boolean DEFAULT false
);


ALTER TABLE public.player OWNER TO %USERNAME%;

--
-- TOC entry 200 (class 1259 OID 17223)
-- Name: settings; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.settings (
    setting_name text NOT NULL,
    setting_value text NOT NULL
);


ALTER TABLE public.settings OWNER TO %USERNAME%;

--
-- TOC entry 196 (class 1259 OID 17182)
-- Name: tags; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tags (
    id_x integer NOT NULL,
    enum_type character(1) NOT NULL,
    flg_tournament boolean DEFAULT false,
    id_tag integer NOT NULL,
    flg_auto boolean DEFAULT false
);


ALTER TABLE public.tags OWNER TO %USERNAME%;

--
-- TOC entry 181 (class 1259 OID 17040)
-- Name: tourney_blinds; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_blinds (
    id_blinds smallint NOT NULL,
    blinds_name text,
    id_gametype smallint NOT NULL,
    amt_sb numeric(14,2),
    amt_bb numeric(14,2),
    flg_nlpl boolean,
    flg_nl boolean,
    flg_pl boolean,
    flg_lo boolean,
    flg_fr boolean,
    flg_sh boolean,
    flg_hu boolean,
    id_filter integer NOT NULL
);


ALTER TABLE public.tourney_blinds OWNER TO %USERNAME%;

--
-- TOC entry 207 (class 1259 OID 17406)
-- Name: tourney_cache; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_cache (
    id_player integer NOT NULL,
    id_gametype integer NOT NULL,
    id_blinds integer NOT NULL,
    cnt_players integer NOT NULL,
    position_type integer NOT NULL,
    flg_has_position_f boolean NOT NULL,
    flg_has_position_t boolean NOT NULL,
    flg_has_position_r boolean NOT NULL,
    date_played_year_week integer NOT NULL,
    amt_bb_won numeric(14,2),
    amt_blind numeric(14,2),
    amt_chips_won numeric(14,2),
    amt_expected_bb_won numeric(14,2),
    amt_expected_won numeric(14,2),
    amt_r_call numeric(14,2),
    amt_r_call_won numeric(14,2),
    cnt_blind integer,
    cnt_f_2bet_def_action_call integer,
    cnt_f_2bet_def_action_fold integer,
    cnt_f_3bet integer,
    cnt_f_3bet_def_action_call integer,
    cnt_f_3bet_def_action_fold integer,
    cnt_f_3bet_def_opp integer,
    cnt_f_3bet_opp integer,
    cnt_f_4bet integer,
    cnt_f_4bet_def_action_call integer,
    cnt_f_4bet_def_action_fold integer,
    cnt_f_4bet_def_opp integer,
    cnt_f_4bet_opp integer,
    cnt_f_allin integer,
    cnt_f_allin_valid integer,
    cnt_f_bet integer,
    cnt_f_bet_def_action_call integer,
    cnt_f_bet_def_action_fold integer,
    cnt_f_bet_def_action_raise integer,
    cnt_f_bet_def_opp integer,
    cnt_f_bet_limp_pot integer,
    cnt_f_call integer,
    cnt_f_cbet integer,
    cnt_f_cbet_3bet_pot integer,
    cnt_f_cbet_def_action_call integer,
    cnt_f_cbet_def_action_call_in_pos integer,
    cnt_f_cbet_def_action_call_out_of_pos integer,
    cnt_f_cbet_def_action_fold integer,
    cnt_f_cbet_def_action_fold_in_pos integer,
    cnt_f_cbet_def_action_fold_out_of_pos integer,
    cnt_f_cbet_def_action_raise integer,
    cnt_f_cbet_def_action_raise_in_pos integer,
    cnt_f_cbet_def_action_raise_out_of_pos integer,
    cnt_f_cbet_def_opp integer,
    cnt_f_cbet_face_raise integer,
    cnt_f_cbet_face_raise_3bet_pot integer,
    cnt_f_cbet_fold_to_raise integer,
    cnt_f_cbet_fold_to_raise_3bet_pot integer,
    cnt_f_cbet_opp integer,
    cnt_f_cbet_opp_3bet_pot integer,
    cnt_f_cbet_success integer,
    cnt_f_check integer,
    cnt_f_check_raise integer,
    cnt_f_check_raise_opp integer,
    cnt_f_donk integer,
    cnt_f_donk_3bet_pot integer,
    cnt_f_donk_def_opp integer,
    cnt_f_donk_def_opp_3bet_pot integer,
    cnt_f_donk_def_opp_action_call integer,
    cnt_f_donk_def_opp_action_fold integer,
    cnt_f_donk_def_opp_action_fold_3bet_pot integer,
    cnt_f_donk_def_opp_action_raise integer,
    cnt_f_donk_def_opp_action_raise_3bet_pot integer,
    cnt_f_donk_face_raise integer,
    cnt_f_donk_fold integer,
    cnt_f_donk_opp integer,
    cnt_f_donk_opp_3bet_pot integer,
    cnt_f_face_xr integer,
    cnt_f_face_xr_call integer,
    cnt_f_face_xr_fold integer,
    cnt_f_face_xr_raise integer,
    cnt_f_float integer,
    cnt_f_float_3bet_pot integer,
    cnt_f_float_def_opp integer,
    cnt_f_float_def_opp_action_call integer,
    cnt_f_float_def_opp_action_fold integer,
    cnt_f_float_def_opp_action_raise integer,
    cnt_f_float_face_raise integer,
    cnt_f_float_fold integer,
    cnt_f_float_opp integer,
    cnt_f_float_opp_3bet_pot integer,
    cnt_f_fold integer,
    cnt_f_open_opp_limp_pot integer,
    cnt_f_raise integer,
    cnt_f_raise_def_opp integer,
    cnt_f_saw integer,
    cnt_f_saw_won integer,
    cnt_hands integer,
    cnt_hands_won integer,
    cnt_p_2bet_def_action_call integer,
    cnt_p_2bet_def_action_fold integer,
    cnt_p_2bet_def_opp integer,
    cnt_p_2bet_def_opp_vs_btn_open integer,
    cnt_p_2bet_def_opp_vs_co_open integer,
    cnt_p_3bet integer,
    cnt_p_3bet_def_action_call integer,
    cnt_p_3bet_def_action_call_after_2b integer,
    cnt_p_3bet_def_action_fold integer,
    cnt_p_3bet_def_action_fold_when_open_raised integer,
    cnt_p_3bet_def_action_fold_when_open_raised_ip integer,
    cnt_p_3bet_def_action_fold_when_open_raised_oop integer,
    cnt_p_3bet_def_opp integer,
    cnt_p_3bet_def_opp_after_2b integer,
    cnt_p_3bet_def_opp_when_open_raised integer,
    cnt_p_3bet_def_opp_when_open_raised_ip integer,
    cnt_p_3bet_def_opp_when_open_raised_oop integer,
    cnt_p_3bet_f_cbet_def_action_call integer,
    cnt_p_3bet_f_cbet_def_action_fold integer,
    cnt_p_3bet_f_cbet_def_action_raise integer,
    cnt_p_3bet_f_cbet_def_opp integer,
    cnt_p_3bet_opp integer,
    cnt_p_3bet_opp_vs_bb_2bet integer,
    cnt_p_3bet_opp_vs_btn_2bet integer,
    cnt_p_3bet_opp_vs_btn_open integer,
    cnt_p_3bet_opp_vs_co_2bet integer,
    cnt_p_3bet_opp_vs_co_open integer,
    cnt_p_3bet_opp_vs_ep_2bet integer,
    cnt_p_3bet_opp_vs_mp_2bet integer,
    cnt_p_3bet_opp_vs_sb_2bet integer,
    cnt_p_3bet_r_cbet_def_action_call integer,
    cnt_p_3bet_r_cbet_def_action_fold integer,
    cnt_p_3bet_r_cbet_def_action_raise integer,
    cnt_p_3bet_r_cbet_def_opp integer,
    cnt_p_3bet_success integer,
    cnt_p_3bet_t_cbet_def_action_call integer,
    cnt_p_3bet_t_cbet_def_action_fold integer,
    cnt_p_3bet_t_cbet_def_action_raise integer,
    cnt_p_3bet_t_cbet_def_opp integer,
    cnt_p_3bet_vs_bb_2bet integer,
    cnt_p_3bet_vs_btn_2bet integer,
    cnt_p_3bet_vs_btn_open integer,
    cnt_p_3bet_vs_co_2bet integer,
    cnt_p_3bet_vs_co_open integer,
    cnt_p_3bet_vs_ep_2bet integer,
    cnt_p_3bet_vs_mp_2bet integer,
    cnt_p_3bet_vs_sb_2bet integer,
    cnt_p_4bet integer,
    cnt_p_4bet_after_raising integer,
    cnt_p_4bet_cold integer,
    cnt_p_4bet_cold_opp integer,
    cnt_p_4bet_def_action_call integer,
    cnt_p_4bet_def_action_fold integer,
    cnt_p_4bet_def_action_fold_after_3b integer,
    cnt_p_4bet_def_opp integer,
    cnt_p_4bet_def_opp_after_3b integer,
    cnt_p_4bet_def_opp_when_open_raised integer,
    cnt_p_4bet_opp integer,
    cnt_p_4bet_opp_when_open_raised integer,
    cnt_p_5bet integer,
    cnt_p_5bet_def_action_fold integer,
    cnt_p_5bet_def_opp integer,
    cnt_p_5bet_opp integer,
    cnt_p_allin integer,
    cnt_p_allin_valid integer,
    cnt_p_bb_v_sb_3bet integer,
    cnt_p_bb_v_sb_3bet_opp integer,
    cnt_p_bb_v_sb_call integer,
    cnt_p_bb_v_sb_fold integer,
    cnt_p_call integer,
    cnt_p_call_vs_btn_open integer,
    cnt_p_call_vs_co_open integer,
    cnt_p_ccall integer,
    cnt_p_ccall_3bet integer,
    cnt_p_ccall_3bet_opp integer,
    cnt_p_ccall_opp integer,
    cnt_p_facing_limpers integer,
    cnt_p_fold integer,
    cnt_p_fold_vs_btn_open integer,
    cnt_p_fold_vs_co_open integer,
    cnt_p_limp integer,
    cnt_p_limp_call integer,
    cnt_p_limp_faceraise integer,
    cnt_p_limp_fold integer,
    cnt_p_limp_opp integer,
    cnt_p_limp_opp_facing_limpers integer,
    cnt_p_limp_raise integer,
    cnt_p_open_opp integer,
    cnt_p_open_opp_btn integer,
    cnt_p_open_opp_ep integer,
    cnt_p_raise integer,
    cnt_p_raise_3bet integer,
    cnt_p_raise_first_in integer,
    cnt_p_raise_limpers integer,
    cnt_p_rfi_btn integer,
    cnt_p_rfi_ep integer,
    cnt_p_squeeze integer,
    cnt_p_squeeze_def_call integer,
    cnt_p_squeeze_def_fold integer,
    cnt_p_squeeze_def_opp integer,
    cnt_p_squeeze_def_raise integer,
    cnt_p_squeeze_opp integer,
    cnt_pfr integer,
    cnt_pfr_opp integer,
    cnt_prev_callers_limp integer,
    cnt_r_2bet_def_action_call integer,
    cnt_r_2bet_def_action_fold integer,
    cnt_r_3bet integer,
    cnt_r_3bet_def_action_call integer,
    cnt_r_3bet_def_action_fold integer,
    cnt_r_3bet_def_opp integer,
    cnt_r_3bet_opp integer,
    cnt_r_4bet integer,
    cnt_r_4bet_def_action_call integer,
    cnt_r_4bet_def_action_fold integer,
    cnt_r_4bet_def_opp integer,
    cnt_r_4bet_opp integer,
    cnt_r_allin integer,
    cnt_r_allin_valid integer,
    cnt_r_bet integer,
    cnt_r_bet_def_action_call integer,
    cnt_r_bet_def_action_fold integer,
    cnt_r_bet_def_action_raise integer,
    cnt_r_bet_def_opp integer,
    cnt_r_call integer,
    cnt_r_call_hands integer,
    cnt_r_cbet integer,
    cnt_r_cbet_3bet_pot integer,
    cnt_r_cbet_def_action_call integer,
    cnt_r_cbet_def_action_fold integer,
    cnt_r_cbet_def_action_raise integer,
    cnt_r_cbet_def_opp integer,
    cnt_r_cbet_face_raise integer,
    cnt_r_cbet_face_raise_3bet_pot integer,
    cnt_r_cbet_fold_to_raise integer,
    cnt_r_cbet_fold_to_raise_3bet_pot integer,
    cnt_r_cbet_opp integer,
    cnt_r_cbet_opp_3bet_pot integer,
    cnt_r_cbet_success integer,
    cnt_r_check integer,
    cnt_r_check_raise integer,
    cnt_r_check_raise_opp integer,
    cnt_r_donk integer,
    cnt_r_donk_3bet_pot integer,
    cnt_r_donk_def_action_call integer,
    cnt_r_donk_def_action_fold integer,
    cnt_r_donk_def_action_fold_3bet_pot integer,
    cnt_r_donk_def_action_raise integer,
    cnt_r_donk_def_opp integer,
    cnt_r_donk_def_opp_3bet_pot integer,
    cnt_r_donk_face_raise integer,
    cnt_r_donk_fold integer,
    cnt_r_donk_opp integer,
    cnt_r_donk_opp_3bet_pot integer,
    cnt_r_face_xr integer,
    cnt_r_face_xr_call integer,
    cnt_r_face_xr_fold integer,
    cnt_r_face_xr_raise integer,
    cnt_r_float integer,
    cnt_r_float_3bet_pot integer,
    cnt_r_float_def_action_call integer,
    cnt_r_float_def_action_fold integer,
    cnt_r_float_def_action_raise integer,
    cnt_r_float_def_opp integer,
    cnt_r_float_face_raise integer,
    cnt_r_float_fold integer,
    cnt_r_float_opp integer,
    cnt_r_float_opp_3bet_pot integer,
    cnt_r_fold integer,
    cnt_r_probe integer,
    cnt_r_probe_3bet_pot integer,
    cnt_r_probe_def_action_call integer,
    cnt_r_probe_def_action_fold integer,
    cnt_r_probe_def_action_raise integer,
    cnt_r_probe_def_opp integer,
    cnt_r_probe_face_raise integer,
    cnt_r_probe_fold integer,
    cnt_r_probe_opp integer,
    cnt_r_probe_opp_3bet_pot integer,
    cnt_r_raise integer,
    cnt_r_raise_wtsd integer,
    cnt_r_raise_wtsd_won integer,
    cnt_r_saw integer,
    cnt_steal_3bet_def_action_fold integer,
    cnt_steal_3bet_def_opp integer,
    cnt_steal_att integer,
    cnt_steal_att_lp integer,
    cnt_steal_att_sb integer,
    cnt_steal_def_3bet_opp integer,
    cnt_steal_def_3bet_opp_vs_lp integer,
    cnt_steal_def_action_call integer,
    cnt_steal_def_action_call_vs_lp integer,
    cnt_steal_def_action_fold integer,
    cnt_steal_def_action_fold_vs_lp integer,
    cnt_steal_def_action_raise integer,
    cnt_steal_def_action_raise_vs_lp integer,
    cnt_steal_def_opp integer,
    cnt_steal_def_opp_vs_lp integer,
    cnt_steal_opp integer,
    cnt_steal_opp_lp integer,
    cnt_steal_opp_sb integer,
    cnt_steal_reraise_def_action_fold integer,
    cnt_steal_reraise_def_opp integer,
    cnt_steal_success integer,
    cnt_t_2bet_def_action_call integer,
    cnt_t_2bet_def_action_fold integer,
    cnt_t_3bet integer,
    cnt_t_3bet_def_action_call integer,
    cnt_t_3bet_def_action_fold integer,
    cnt_t_3bet_def_opp integer,
    cnt_t_3bet_opp integer,
    cnt_t_4bet integer,
    cnt_t_4bet_def_action_call integer,
    cnt_t_4bet_def_action_fold integer,
    cnt_t_4bet_def_opp integer,
    cnt_t_4bet_opp integer,
    cnt_t_allin integer,
    cnt_t_allin_showdown integer,
    cnt_t_allin_valid integer,
    cnt_t_bet integer,
    cnt_t_bet_def_action_call integer,
    cnt_t_bet_def_action_fold integer,
    cnt_t_bet_def_action_raise integer,
    cnt_t_bet_def_opp integer,
    cnt_t_call integer,
    cnt_t_cbet integer,
    cnt_t_cbet_3bet_pot integer,
    cnt_t_cbet_def_action_call integer,
    cnt_t_cbet_def_action_fold integer,
    cnt_t_cbet_def_action_raise integer,
    cnt_t_cbet_def_opp integer,
    cnt_t_cbet_face_raise integer,
    cnt_t_cbet_face_raise_3bet_pot integer,
    cnt_t_cbet_fold_to_raise integer,
    cnt_t_cbet_fold_to_raise_3bet_pot integer,
    cnt_t_cbet_opp integer,
    cnt_t_cbet_opp_3bet_pot integer,
    cnt_t_cbet_success integer,
    cnt_t_check integer,
    cnt_t_check_raise integer,
    cnt_t_check_raise_opp integer,
    cnt_t_donk integer,
    cnt_t_donk_3bet_pot integer,
    cnt_t_donk_def_action_call integer,
    cnt_t_donk_def_action_fold integer,
    cnt_t_donk_def_action_fold_3bet_pot integer,
    cnt_t_donk_def_action_raise integer,
    cnt_t_donk_def_opp integer,
    cnt_t_donk_def_opp_3bet_pot integer,
    cnt_t_donk_face_raise integer,
    cnt_t_donk_fold integer,
    cnt_t_donk_opp integer,
    cnt_t_donk_opp_3bet_pot integer,
    cnt_t_face_xr integer,
    cnt_t_face_xr_call integer,
    cnt_t_face_xr_fold integer,
    cnt_t_face_xr_raise integer,
    cnt_t_float integer,
    cnt_t_float_3bet_pot integer,
    cnt_t_float_def_action_call integer,
    cnt_t_float_def_action_fold integer,
    cnt_t_float_def_action_raise integer,
    cnt_t_float_def_opp integer,
    cnt_t_float_face_raise integer,
    cnt_t_float_fold integer,
    cnt_t_float_opp integer,
    cnt_t_float_opp_3bet_pot integer,
    cnt_t_fold integer,
    cnt_t_probe integer,
    cnt_t_probe_3bet_pot integer,
    cnt_t_probe_def_action_call integer,
    cnt_t_probe_def_action_fold integer,
    cnt_t_probe_def_action_raise integer,
    cnt_t_probe_def_opp integer,
    cnt_t_probe_face_raise integer,
    cnt_t_probe_fold integer,
    cnt_t_probe_opp integer,
    cnt_t_probe_opp_3bet_pot integer,
    cnt_t_raise integer,
    cnt_t_raise_wtsd integer,
    cnt_t_raise_wtsd_won integer,
    cnt_t_saw integer,
    cnt_vpip integer,
    cnt_vpip_sb integer,
    cnt_walks integer,
    cnt_won_hand integer,
    cnt_wtsd integer,
    cnt_wtsd_non_small integer,
    cnt_wtsd_won integer,
    cnt_wtsd_won_non_small integer,
    cnt_wtsd_won_when_r_call integer,
    val_equity numeric(14,2),
    val_f_equity numeric(14,2),
    val_p_equity numeric(14,2),
    val_r_equity numeric(14,2),
    val_t_equity numeric(14,2)
);


ALTER TABLE public.tourney_cache OWNER TO %USERNAME%;

--
-- TOC entry 208 (class 1259 OID 17420)
-- Name: tourney_custom_cache; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_custom_cache (
    id_player integer NOT NULL,
    id_gametype integer NOT NULL,
    id_blinds integer NOT NULL,
    cnt_players integer NOT NULL,
    position_type integer NOT NULL,
    flg_has_position_f boolean NOT NULL,
    flg_has_position_t boolean NOT NULL,
    flg_has_position_r boolean NOT NULL,
    date_played_year_week integer NOT NULL
);


ALTER TABLE public.tourney_custom_cache OWNER TO %USERNAME%;

--
-- TOC entry 185 (class 1259 OID 17084)
-- Name: tourney_hand_histories; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_hand_histories (
    id_hand integer NOT NULL,
    history text
);


ALTER TABLE public.tourney_hand_histories OWNER TO %USERNAME%;

--
-- TOC entry 179 (class 1259 OID 16761)
-- Name: tourney_hand_player_combinations; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_hand_player_combinations (
    id_hand integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_player integer NOT NULL,
    flg_f_highcard boolean DEFAULT false,
    flg_f_1pair boolean DEFAULT false,
    flg_f_2pair boolean DEFAULT false,
    flg_f_threeoak boolean DEFAULT false,
    flg_f_straight boolean DEFAULT false,
    flg_f_flush boolean DEFAULT false,
    flg_f_fullhouse boolean DEFAULT false,
    flg_f_fouroak boolean DEFAULT false,
    flg_f_strflush boolean DEFAULT false,
    id_f_hand_strength smallint DEFAULT 0,
    id_f_kicker_strength smallint DEFAULT 0,
    val_f_hole_cards_used smallint DEFAULT 0,
    flg_f_gutshot_draw boolean DEFAULT false,
    flg_f_straight_draw boolean DEFAULT false,
    flg_f_2gutshot_draw boolean DEFAULT false,
    flg_f_flush_draw boolean DEFAULT false,
    flg_f_wrap_draw boolean DEFAULT false,
    val_f_wrap_outs smallint DEFAULT 0,
    flg_f_bflush_draw boolean DEFAULT false,
    flg_f_bstraight_draw boolean DEFAULT false,
    id_f_flush_draw_strength smallint DEFAULT 0,
    val_f_straight_draw_nut_outs smallint DEFAULT 0,
    val_f_straight_draw_nonnut_outs smallint DEFAULT 0,
    flg_f_low_hand boolean DEFAULT false,
    val_f_low_hand_strength smallint DEFAULT 0,
    flg_f_nut_flush_blocker boolean DEFAULT false,
    flg_f_low_draw boolean DEFAULT false,
    val_f_low_draw_strength smallint DEFAULT 0,
    flg_t_highcard boolean DEFAULT false,
    flg_t_1pair boolean DEFAULT false,
    flg_t_2pair boolean DEFAULT false,
    flg_t_threeoak boolean DEFAULT false,
    flg_t_straight boolean DEFAULT false,
    flg_t_flush boolean DEFAULT false,
    flg_t_fullhouse boolean DEFAULT false,
    flg_t_fouroak boolean DEFAULT false,
    flg_t_strflush boolean DEFAULT false,
    id_t_hand_strength smallint DEFAULT 0,
    id_t_kicker_strength smallint DEFAULT 0,
    val_t_hole_cards_used smallint DEFAULT 0,
    flg_t_gutshot_draw boolean DEFAULT false,
    flg_t_straight_draw boolean DEFAULT false,
    flg_t_2gutshot_draw boolean DEFAULT false,
    flg_t_flush_draw boolean DEFAULT false,
    flg_t_wrap_draw boolean DEFAULT false,
    val_t_wrap_outs smallint DEFAULT 0,
    id_t_flush_draw_strength smallint DEFAULT 0,
    val_t_straight_draw_nut_outs smallint DEFAULT 0,
    val_t_straight_draw_nonnut_outs smallint DEFAULT 0,
    flg_t_low_hand boolean DEFAULT false,
    val_t_low_hand_strength smallint DEFAULT 0,
    flg_t_nut_flush_blocker boolean DEFAULT false,
    flg_t_low_draw boolean DEFAULT false,
    val_t_low_draw_strength smallint DEFAULT 0,
    flg_r_highcard boolean DEFAULT false,
    flg_r_1pair boolean DEFAULT false,
    flg_r_2pair boolean DEFAULT false,
    flg_r_threeoak boolean DEFAULT false,
    flg_r_straight boolean DEFAULT false,
    flg_r_flush boolean DEFAULT false,
    flg_r_fullhouse boolean DEFAULT false,
    flg_r_fouroak boolean DEFAULT false,
    flg_r_strflush boolean DEFAULT false,
    id_r_hand_strength smallint DEFAULT 0,
    id_r_kicker_strength smallint DEFAULT 0,
    val_r_hole_cards_used smallint DEFAULT 0,
    flg_r_low_hand boolean DEFAULT false,
    val_r_low_hand_strength smallint DEFAULT 0,
    flg_r_nut_flush_blocker boolean DEFAULT false
);


ALTER TABLE public.tourney_hand_player_combinations OWNER TO %USERNAME%;

--
-- TOC entry 180 (class 1259 OID 16837)
-- Name: tourney_hand_player_statistics; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_hand_player_statistics (
    id_hand integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_player integer NOT NULL,
    id_player_real integer NOT NULL,
    id_holecard smallint NOT NULL,
    id_blinds smallint NOT NULL,
    id_tourney integer NOT NULL,
    date_played timestamp without time zone NOT NULL,
    "position" smallint,
    cnt_players smallint,
    cnt_players_lookup_position smallint,
    cnt_p_raise smallint DEFAULT 0,
    flg_p_first_raise boolean DEFAULT false,
    cnt_p_call smallint DEFAULT 0,
    flg_p_limp boolean DEFAULT false,
    flg_p_fold boolean DEFAULT false,
    flg_p_ccall boolean DEFAULT false,
    cnt_p_face_limpers smallint DEFAULT 0,
    flg_vpip boolean DEFAULT false,
    flg_f_bet boolean DEFAULT false,
    cnt_f_raise smallint DEFAULT 0,
    flg_f_first_raise boolean DEFAULT false,
    cnt_f_call smallint DEFAULT 0,
    flg_f_check boolean DEFAULT false,
    flg_f_check_raise boolean DEFAULT false,
    flg_f_fold boolean DEFAULT false,
    flg_f_saw boolean DEFAULT false,
    flg_t_bet boolean DEFAULT false,
    cnt_t_raise smallint DEFAULT 0,
    flg_t_first_raise boolean DEFAULT false,
    cnt_t_call smallint DEFAULT 0,
    flg_t_check boolean DEFAULT false,
    flg_t_check_raise boolean DEFAULT false,
    flg_t_fold boolean DEFAULT false,
    flg_t_saw boolean DEFAULT false,
    flg_r_bet boolean DEFAULT false,
    cnt_r_raise smallint DEFAULT 0,
    flg_r_first_raise boolean DEFAULT false,
    cnt_r_call smallint DEFAULT 0,
    flg_r_check boolean DEFAULT false,
    flg_r_check_raise boolean DEFAULT false,
    flg_r_fold boolean DEFAULT false,
    flg_r_saw boolean DEFAULT false,
    enum_allin character(1),
    enum_face_allin character(1),
    enum_face_allin_action character(1),
    flg_blind_s boolean DEFAULT false,
    flg_blind_b boolean DEFAULT false,
    flg_sb_steal_fold boolean DEFAULT false,
    flg_bb_steal_fold boolean DEFAULT false,
    flg_blind_def_opp boolean DEFAULT false,
    flg_steal_att boolean DEFAULT false,
    flg_steal_opp boolean DEFAULT false,
    flg_blind_k boolean DEFAULT false,
    flg_showdown boolean DEFAULT false,
    flg_won_hand boolean DEFAULT false,
    amt_won numeric(14,2) DEFAULT 0,
    amt_expected_won numeric(14,2) DEFAULT 0,
    amt_expected_won_icm_pct numeric(6,5) DEFAULT NULL::numeric,
    val_equity numeric(6,5) DEFAULT 0,
    id_final_hand smallint NOT NULL,
    id_final_hand_lo integer NOT NULL,
    flg_showed boolean DEFAULT false,
    enum_folded character(1),
    flg_p_face_raise boolean DEFAULT false,
    flg_p_3bet boolean DEFAULT false,
    flg_p_3bet_opp boolean DEFAULT false,
    flg_p_3bet_def_opp boolean DEFAULT false,
    enum_p_3bet_action character(1),
    flg_p_4bet boolean DEFAULT false,
    flg_p_4bet_opp boolean DEFAULT false,
    flg_p_4bet_def_opp boolean DEFAULT false,
    enum_p_4bet_action character(1),
    flg_p_squeeze boolean DEFAULT false,
    flg_p_squeeze_opp boolean DEFAULT false,
    flg_p_squeeze_def_opp boolean DEFAULT false,
    enum_p_squeeze_action character(1),
    flg_f_face_raise boolean DEFAULT false,
    flg_f_3bet boolean DEFAULT false,
    flg_f_3bet_opp boolean DEFAULT false,
    flg_f_3bet_def_opp boolean DEFAULT false,
    enum_f_3bet_action character(1),
    flg_f_4bet boolean DEFAULT false,
    flg_f_4bet_opp boolean DEFAULT false,
    flg_f_4bet_def_opp boolean DEFAULT false,
    enum_f_4bet_action character(1),
    flg_f_cbet boolean DEFAULT false,
    flg_f_cbet_opp boolean DEFAULT false,
    flg_f_cbet_def_opp boolean DEFAULT false,
    enum_f_cbet_action character(1),
    flg_t_face_raise boolean DEFAULT false,
    flg_t_3bet boolean DEFAULT false,
    flg_t_3bet_opp boolean DEFAULT false,
    flg_t_3bet_def_opp boolean DEFAULT false,
    enum_t_3bet_action character(1),
    flg_t_4bet boolean DEFAULT false,
    flg_t_4bet_opp boolean DEFAULT false,
    flg_t_4bet_def_opp boolean DEFAULT false,
    enum_t_4bet_action character(1),
    flg_t_cbet boolean DEFAULT false,
    flg_t_cbet_opp boolean DEFAULT false,
    flg_t_cbet_def_opp boolean DEFAULT false,
    enum_t_cbet_action character(1),
    flg_t_float boolean DEFAULT false,
    flg_t_float_opp boolean DEFAULT false,
    flg_t_float_def_opp boolean DEFAULT false,
    enum_t_float_action character(1),
    flg_t_donk boolean DEFAULT false,
    flg_t_donk_opp boolean DEFAULT false,
    flg_t_donk_def_opp boolean DEFAULT false,
    enum_t_donk_action character(1),
    flg_r_face_raise boolean DEFAULT false,
    flg_r_3bet boolean DEFAULT false,
    flg_r_3bet_opp boolean DEFAULT false,
    flg_r_3bet_def_opp boolean DEFAULT false,
    enum_r_3bet_action character(1),
    flg_r_4bet boolean DEFAULT false,
    flg_r_4bet_opp boolean DEFAULT false,
    flg_r_4bet_def_opp boolean DEFAULT false,
    enum_r_4bet_action character(1),
    flg_r_cbet boolean DEFAULT false,
    flg_r_cbet_opp boolean DEFAULT false,
    flg_r_cbet_def_opp boolean DEFAULT false,
    enum_r_cbet_action character(1),
    flg_r_float boolean DEFAULT false,
    flg_r_float_opp boolean DEFAULT false,
    flg_r_float_def_opp boolean DEFAULT false,
    enum_r_float_action character(1),
    flg_r_donk boolean DEFAULT false,
    flg_r_donk_opp boolean DEFAULT false,
    flg_r_donk_def_opp boolean DEFAULT false,
    enum_r_donk_action character(1),
    seat smallint,
    holecard_1 smallint NOT NULL,
    holecard_2 smallint NOT NULL,
    holecard_3 smallint NOT NULL,
    holecard_4 smallint NOT NULL,
    id_suits smallint NOT NULL,
    flg_hero boolean DEFAULT false,
    amt_before numeric(14,2),
    amt_blind numeric(11,2) DEFAULT 0,
    amt_ante numeric(11,2) DEFAULT 0,
    amt_bet_p numeric(14,2) DEFAULT 0,
    amt_bet_f numeric(14,2) DEFAULT 0,
    amt_bet_t numeric(14,2) DEFAULT 0,
    amt_bet_r numeric(14,2) DEFAULT 0,
    amt_bet_ttl numeric(14,2) DEFAULT 0,
    id_action_p integer DEFAULT 0,
    id_action_f integer DEFAULT 0,
    id_action_t integer DEFAULT 0,
    id_action_r integer DEFAULT 0,
    flg_p_open boolean DEFAULT false,
    flg_p_open_opp boolean DEFAULT false,
    flg_f_first boolean DEFAULT false,
    flg_f_open boolean DEFAULT false,
    flg_f_open_opp boolean DEFAULT false,
    flg_f_has_position boolean DEFAULT false,
    flg_t_first boolean DEFAULT false,
    flg_t_open boolean DEFAULT false,
    flg_t_open_opp boolean DEFAULT false,
    flg_t_has_position boolean DEFAULT false,
    flg_r_first boolean DEFAULT false,
    flg_r_open boolean DEFAULT false,
    flg_r_open_opp boolean DEFAULT false,
    flg_r_has_position boolean DEFAULT false,
    amt_p_effective_stack numeric(14,2) DEFAULT 0,
    amt_f_effective_stack numeric(14,2) DEFAULT 0,
    amt_t_effective_stack numeric(14,2) DEFAULT 0,
    amt_r_effective_stack numeric(14,2) DEFAULT 0,
    amt_p_raise_facing numeric(14,2) DEFAULT 0,
    val_p_raise_facing_pct numeric(11,2) DEFAULT 0,
    amt_p_2bet_facing numeric(14,2) DEFAULT 0,
    val_p_2bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_p_3bet_facing numeric(14,2) DEFAULT 0,
    val_p_3bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_p_4bet_facing numeric(14,2) DEFAULT 0,
    val_p_4bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_p_5bet_facing numeric(14,2) DEFAULT 0,
    val_p_5bet_facing_pct numeric(11,2) DEFAULT 0,
    val_p_raise_aggressor_pos smallint,
    amt_p_raise_made numeric(14,2) DEFAULT 0,
    val_p_raise_made_pct numeric(11,2) DEFAULT 0,
    amt_p_raise_made_2 numeric(14,2) DEFAULT 0,
    val_p_raise_made_2_pct numeric(11,2) DEFAULT 0,
    amt_f_bet_facing numeric(14,2) DEFAULT 0,
    val_f_bet_facing_pct numeric(11,2) DEFAULT 0,
    val_f_bet_aggressor_pos smallint,
    amt_f_bet_made numeric(14,2) DEFAULT 0,
    val_f_bet_made_pct numeric(11,2) DEFAULT 0,
    amt_f_raise_facing numeric(14,2) DEFAULT 0,
    val_f_raise_facing_pct numeric(11,2) DEFAULT 0,
    amt_f_2bet_facing numeric(14,2) DEFAULT 0,
    val_f_2bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_f_3bet_facing numeric(14,2) DEFAULT 0,
    val_f_3bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_f_4bet_facing numeric(14,2) DEFAULT 0,
    val_f_4bet_facing_pct numeric(11,2) DEFAULT 0,
    val_f_raise_aggressor_pos smallint,
    amt_f_raise_made numeric(14,2) DEFAULT 0,
    val_f_raise_made_pct numeric(11,2) DEFAULT 0,
    amt_f_raise_made_2 numeric(14,2) DEFAULT 0,
    val_f_raise_made_2_pct numeric(11,2) DEFAULT 0,
    amt_t_bet_facing numeric(14,2) DEFAULT 0,
    val_t_bet_facing_pct numeric(11,2) DEFAULT 0,
    val_t_bet_aggressor_pos smallint,
    amt_t_bet_made numeric(14,2) DEFAULT 0,
    val_t_bet_made_pct numeric(11,2) DEFAULT 0,
    amt_t_raise_facing numeric(14,2) DEFAULT 0,
    val_t_raise_facing_pct numeric(11,2) DEFAULT 0,
    amt_t_2bet_facing numeric(14,2) DEFAULT 0,
    val_t_2bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_t_3bet_facing numeric(14,2) DEFAULT 0,
    val_t_3bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_t_4bet_facing numeric(14,2) DEFAULT 0,
    val_t_4bet_facing_pct numeric(11,2) DEFAULT 0,
    val_t_raise_aggressor_pos smallint,
    amt_t_raise_made numeric(14,2) DEFAULT 0,
    val_t_raise_made_pct numeric(11,2) DEFAULT 0,
    amt_t_raise_made_2 numeric(14,2) DEFAULT 0,
    val_t_raise_made_2_pct numeric(11,2) DEFAULT 0,
    amt_r_bet_facing numeric(14,2) DEFAULT 0,
    val_r_bet_facing_pct numeric(11,2) DEFAULT 0,
    val_r_bet_aggressor_pos smallint,
    amt_r_bet_made numeric(14,2) DEFAULT 0,
    val_r_bet_made_pct numeric(11,2) DEFAULT 0,
    amt_r_raise_facing numeric(14,2) DEFAULT 0,
    val_r_raise_facing_pct numeric(11,2) DEFAULT 0,
    amt_r_2bet_facing numeric(14,2) DEFAULT 0,
    val_r_2bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_r_3bet_facing numeric(14,2) DEFAULT 0,
    val_r_3bet_facing_pct numeric(11,2) DEFAULT 0,
    amt_r_4bet_facing numeric(14,2) DEFAULT 0,
    val_r_4bet_facing_pct numeric(11,2) DEFAULT 0,
    val_r_raise_aggressor_pos smallint,
    amt_r_raise_made numeric(14,2) DEFAULT 0,
    val_r_raise_made_pct numeric(11,2) DEFAULT 0,
    amt_r_raise_made_2 numeric(14,2) DEFAULT 0,
    val_r_raise_made_2_pct numeric(11,2) DEFAULT 0
);


ALTER TABLE public.tourney_hand_player_statistics OWNER TO %USERNAME%;

--
-- TOC entry 2967 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_allin; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_allin IS 'Poss Values: P, F, T, R, N';


--
-- TOC entry 2968 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_face_allin; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_face_allin IS 'Poss Values: P, F, T, R, N';


--
-- TOC entry 2969 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_face_allin_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_face_allin_action IS 'Poss Values: F, C, R, N';


--
-- TOC entry 2970 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_folded; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_folded IS 'Poss Values: P, F, T, R, N';


--
-- TOC entry 2971 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_p_3bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_p_3bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2972 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_p_4bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_p_4bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2973 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_f_3bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_f_3bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2974 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_f_4bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_f_4bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2975 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_t_3bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_t_3bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2976 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_t_4bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_t_4bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2977 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_r_3bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_r_3bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 2978 (class 0 OID 0)
-- Dependencies: 180
-- Name: COLUMN tourney_hand_player_statistics.enum_r_4bet_action; Type: COMMENT; Schema: public; Owner: %USERNAME%
--

COMMENT ON COLUMN public.tourney_hand_player_statistics.enum_r_4bet_action IS '(R)aise, (C)all, (F)old';


--
-- TOC entry 178 (class 1259 OID 16738)
-- Name: tourney_hand_summary; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_hand_summary (
    id_hand integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_site smallint NOT NULL,
    id_tourney integer NOT NULL,
    id_blinds smallint NOT NULL,
    id_table integer NOT NULL,
    hand_no character varying(32) NOT NULL,
    date_played timestamp without time zone NOT NULL,
    date_imported timestamp without time zone NOT NULL,
    cnt_players smallint DEFAULT 0,
    cnt_players_lookup_position smallint DEFAULT 0,
    cnt_players_f smallint DEFAULT 0,
    cnt_players_t smallint DEFAULT 0,
    cnt_players_r smallint DEFAULT 0,
    amt_pot numeric(14,2) NOT NULL,
    amt_short_stack numeric(14,2) DEFAULT 0,
    amt_pot_p numeric(14,2) DEFAULT 0,
    amt_pot_f numeric(14,2) DEFAULT 0,
    amt_pot_t numeric(14,2) DEFAULT 0,
    amt_pot_r numeric(14,2) DEFAULT 0,
    str_actors_p character varying(10),
    str_actors_f character varying(10),
    str_actors_t character varying(10),
    str_actors_r character varying(10),
    str_aggressors_p character varying(10),
    str_aggressors_f character varying(10),
    str_aggressors_t character varying(10),
    str_aggressors_r character varying(10),
    id_win_hand smallint NOT NULL,
    id_win_hand_lo integer NOT NULL,
    id_winner integer NOT NULL,
    id_winner_lo integer NOT NULL,
    button smallint NOT NULL,
    card_1 smallint,
    card_2 smallint,
    card_3 smallint,
    card_4 smallint,
    card_5 smallint,
    flg_note boolean DEFAULT false,
    flg_tag boolean DEFAULT false,
    flg_autonote boolean DEFAULT false
);


ALTER TABLE public.tourney_hand_summary OWNER TO %USERNAME%;

--
-- TOC entry 183 (class 1259 OID 17068)
-- Name: tourney_results; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_results (
    id_tourney integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_site integer NOT NULL,
    id_player integer NOT NULL,
    id_player_real integer NOT NULL,
    date_start timestamp without time zone,
    date_end timestamp without time zone,
    val_finish integer NOT NULL,
    amt_won numeric(14,2) NOT NULL,
    cnt_rebuy smallint,
    cnt_addon smallint,
    val_bounty numeric(12,8) NOT NULL,
    flg_sat_seat boolean DEFAULT false,
    amt_won_adj numeric(14,2)
);


ALTER TABLE public.tourney_results OWNER TO %USERNAME%;

--
-- TOC entry 182 (class 1259 OID 17048)
-- Name: tourney_summary; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_summary (
    id_tourney integer NOT NULL,
    id_gametype smallint NOT NULL,
    id_site smallint NOT NULL,
    id_table_type smallint NOT NULL,
    id_tourney_type smallint NOT NULL,
    tourney_no character varying(32) NOT NULL,
    date_start timestamp without time zone,
    date_end timestamp without time zone,
    date_rebuy_period_over timestamp without time zone,
    amt_buyin numeric(14,2) NOT NULL,
    amt_fee numeric(11,2) DEFAULT 0,
    amt_prize_pool numeric(14,2) DEFAULT 0,
    summary text,
    tourney_no_target character varying(32),
    cnt_players integer DEFAULT 0,
    flg_note boolean DEFAULT false,
    flg_tag boolean DEFAULT false,
    id_winner integer,
    currency character(3) NOT NULL,
    val_curr_conv numeric(12,4),
    amt_rebuy numeric(14,2) DEFAULT 0,
    amt_addon numeric(14,2) DEFAULT 0,
    amt_bounty numeric(14,2) DEFAULT 0,
    amt_bounty_val numeric(14,2) DEFAULT 0,
    cnt_hands smallint DEFAULT 0
);


ALTER TABLE public.tourney_summary OWNER TO %USERNAME%;

--
-- TOC entry 184 (class 1259 OID 17076)
-- Name: tourney_table; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_table (
    id_table integer NOT NULL,
    table_name text
);


ALTER TABLE public.tourney_table OWNER TO %USERNAME%;

--
-- TOC entry 186 (class 1259 OID 17092)
-- Name: tourney_table_type; Type: TABLE; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE TABLE public.tourney_table_type (
    id_table_type smallint NOT NULL,
    description text,
    val_tables smallint,
    val_seats smallint,
    val_speed character(1),
    val_flags character(16)
);


ALTER TABLE public.tourney_table_type OWNER TO %USERNAME%;

--
-- TOC entry 2829 (class 2606 OID 17386)
-- Name: cash_cache_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_cache
    ADD CONSTRAINT cash_cache_primary_key PRIMARY KEY (id_player, id_gametype, id_limit, cnt_players, position_type, flg_has_position_f, flg_has_position_t, flg_has_position_r, date_played_year_week);


--
-- TOC entry 2832 (class 2606 OID 17400)
-- Name: cash_custom_cache_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_custom_cache
    ADD CONSTRAINT cash_custom_cache_primary_key PRIMARY KEY (id_player, id_gametype, id_limit, cnt_players, position_type, flg_has_position_f, flg_has_position_t, flg_has_position_r, date_played_year_week);


--
-- TOC entry 2738 (class 2606 OID 16711)
-- Name: cash_hand_histories_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_hand_histories
    ADD CONSTRAINT cash_hand_histories_primary_key PRIMARY KEY (id_hand);

ALTER TABLE public.cash_hand_histories CLUSTER ON cash_hand_histories_primary_key;


--
-- TOC entry 2734 (class 2606 OID 16701)
-- Name: cash_hand_player_combinations_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_hand_player_combinations
    ADD CONSTRAINT cash_hand_player_combinations_primary_key PRIMARY KEY (id_player, id_hand);

ALTER TABLE public.cash_hand_player_combinations CLUSTER ON cash_hand_player_combinations_primary_key;


--
-- TOC entry 2725 (class 2606 OID 16620)
-- Name: cash_hand_player_statistics_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_hand_player_statistics
    ADD CONSTRAINT cash_hand_player_statistics_primary_key PRIMARY KEY (id_player, id_hand);


--
-- TOC entry 2718 (class 2606 OID 16415)
-- Name: cash_hand_summary_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_hand_summary
    ADD CONSTRAINT cash_hand_summary_primary_key PRIMARY KEY (id_hand, id_limit);

ALTER TABLE public.cash_hand_summary CLUSTER ON cash_hand_summary_primary_key;


--
-- TOC entry 2740 (class 2606 OID 16719)
-- Name: cash_limit_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_limit
    ADD CONSTRAINT cash_limit_primary_key PRIMARY KEY (id_limit);

ALTER TABLE public.cash_limit CLUSTER ON cash_limit_primary_key;


--
-- TOC entry 2742 (class 2606 OID 16727)
-- Name: cash_table_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_table
    ADD CONSTRAINT cash_table_primary_key PRIMARY KEY (id_table);

ALTER TABLE public.cash_table CLUSTER ON cash_table_primary_key;


--
-- TOC entry 2744 (class 2606 OID 16734)
-- Name: cash_table_session_summary_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_table_session_summary
    ADD CONSTRAINT cash_table_session_summary_primary_key PRIMARY KEY (id_session);

ALTER TABLE public.cash_table_session_summary CLUSTER ON cash_table_session_summary_primary_key;


--
-- TOC entry 2820 (class 2606 OID 17302)
-- Name: live_cash_player_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.live_cash_player
    ADD CONSTRAINT live_cash_player_primary_key PRIMARY KEY (id_player, id_live_table);


--
-- TOC entry 2816 (class 2606 OID 17284)
-- Name: live_cash_table_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.live_cash_table
    ADD CONSTRAINT live_cash_table_primary_key PRIMARY KEY (id_live_table);


--
-- TOC entry 2824 (class 2606 OID 17376)
-- Name: live_tourney_player_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.live_tourney_player
    ADD CONSTRAINT live_tourney_player_primary_key PRIMARY KEY (id_player, id_live_table);


--
-- TOC entry 2822 (class 2606 OID 17358)
-- Name: live_tourney_table_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.live_tourney_table
    ADD CONSTRAINT live_tourney_table_primary_key PRIMARY KEY (id_live_table);


--
-- TOC entry 2799 (class 2606 OID 17173)
-- Name: lookup_actions_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_actions
    ADD CONSTRAINT lookup_actions_primary_key PRIMARY KEY (id_action);


--
-- TOC entry 2787 (class 2606 OID 17115)
-- Name: lookup_hand_groups_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_hand_groups
    ADD CONSTRAINT lookup_hand_groups_primary_key PRIMARY KEY (id_group);


--
-- TOC entry 2789 (class 2606 OID 17123)
-- Name: lookup_hand_ranks_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_hand_ranks
    ADD CONSTRAINT lookup_hand_ranks_primary_key PRIMARY KEY (id_hand_rank);


--
-- TOC entry 2791 (class 2606 OID 17138)
-- Name: lookup_hole_cards_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_hole_cards
    ADD CONSTRAINT lookup_hole_cards_primary_key PRIMARY KEY (id_holecard, id_gametype);


--
-- TOC entry 2795 (class 2606 OID 17157)
-- Name: lookup_positions_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_positions
    ADD CONSTRAINT lookup_positions_primary_key PRIMARY KEY (cnt_players, "position");


--
-- TOC entry 2797 (class 2606 OID 17165)
-- Name: lookup_sites_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_sites
    ADD CONSTRAINT lookup_sites_primary_key PRIMARY KEY (id_site);


--
-- TOC entry 2793 (class 2606 OID 17146)
-- Name: lookup_suits_omaha_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_suits_omaha
    ADD CONSTRAINT lookup_suits_omaha_primary_key PRIMARY KEY (id_suits);


--
-- TOC entry 2801 (class 2606 OID 17181)
-- Name: lookup_tags_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_tags
    ADD CONSTRAINT lookup_tags_primary_key PRIMARY KEY (id_tag);


--
-- TOC entry 2785 (class 2606 OID 17107)
-- Name: lookup_tourney_type_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.lookup_tourney_type
    ADD CONSTRAINT lookup_tourney_type_primary_key PRIMARY KEY (id_type);


--
-- TOC entry 2809 (class 2606 OID 17209)
-- Name: notes_auto_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.notes_auto
    ADD CONSTRAINT notes_auto_primary_key PRIMARY KEY (id_autonote);


--
-- TOC entry 2806 (class 2606 OID 17196)
-- Name: notes_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.notes
    ADD CONSTRAINT notes_primary_key PRIMARY KEY (id_note);


--
-- TOC entry 2721 (class 2606 OID 16417)
-- Name: ohs-unique_hand_no; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.cash_hand_summary
    ADD CONSTRAINT "ohs-unique_hand_no" UNIQUE (hand_no, id_site);


--
-- TOC entry 2812 (class 2606 OID 17221)
-- Name: player_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.player
    ADD CONSTRAINT player_primary_key PRIMARY KEY (id_player);

ALTER TABLE public.player CLUSTER ON player_primary_key;


--
-- TOC entry 2814 (class 2606 OID 17230)
-- Name: settings_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.settings
    ADD CONSTRAINT settings_primary_key PRIMARY KEY (setting_name);


--
-- TOC entry 2749 (class 2606 OID 16757)
-- Name: tohs-unique_hand_no; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_hand_summary
    ADD CONSTRAINT "tohs-unique_hand_no" UNIQUE (id_site, hand_no);


--
-- TOC entry 2769 (class 2606 OID 17047)
-- Name: tourney_blinds_id_blinds_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_blinds
    ADD CONSTRAINT tourney_blinds_id_blinds_primary_key PRIMARY KEY (id_blinds);

ALTER TABLE public.tourney_blinds CLUSTER ON tourney_blinds_id_blinds_primary_key;


--
-- TOC entry 2835 (class 2606 OID 17410)
-- Name: tourney_cache_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_cache
    ADD CONSTRAINT tourney_cache_primary_key PRIMARY KEY (id_player, id_gametype, id_blinds, cnt_players, position_type, flg_has_position_f, flg_has_position_t, flg_has_position_r, date_played_year_week);


--
-- TOC entry 2838 (class 2606 OID 17424)
-- Name: tourney_custom_cache_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_custom_cache
    ADD CONSTRAINT tourney_custom_cache_primary_key PRIMARY KEY (id_player, id_gametype, id_blinds, cnt_players, position_type, flg_has_position_f, flg_has_position_t, flg_has_position_r, date_played_year_week);


--
-- TOC entry 2781 (class 2606 OID 17091)
-- Name: tourney_hand_histories_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_hand_histories
    ADD CONSTRAINT tourney_hand_histories_primary_key PRIMARY KEY (id_hand);

ALTER TABLE public.tourney_hand_histories CLUSTER ON tourney_hand_histories_primary_key;


--
-- TOC entry 2758 (class 2606 OID 16834)
-- Name: tourney_hand_player_combinations_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_hand_player_combinations
    ADD CONSTRAINT tourney_hand_player_combinations_primary_key PRIMARY KEY (id_player, id_hand);

ALTER TABLE public.tourney_hand_player_combinations CLUSTER ON tourney_hand_player_combinations_primary_key;


--
-- TOC entry 2767 (class 2606 OID 17032)
-- Name: tourney_hand_player_statistics_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_hand_player_statistics
    ADD CONSTRAINT tourney_hand_player_statistics_primary_key PRIMARY KEY (id_player, id_hand);


--
-- TOC entry 2754 (class 2606 OID 16755)
-- Name: tourney_hand_summary_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_hand_summary
    ADD CONSTRAINT tourney_hand_summary_primary_key PRIMARY KEY (id_hand);

ALTER TABLE public.tourney_hand_summary CLUSTER ON tourney_hand_summary_primary_key;


--
-- TOC entry 2777 (class 2606 OID 17073)
-- Name: tourney_results_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_results
    ADD CONSTRAINT tourney_results_primary_key PRIMARY KEY (id_tourney, id_player);


--
-- TOC entry 2773 (class 2606 OID 17065)
-- Name: tourney_summary_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_summary
    ADD CONSTRAINT tourney_summary_primary_key PRIMARY KEY (id_tourney);

ALTER TABLE public.tourney_summary CLUSTER ON tourney_summary_primary_key;


--
-- TOC entry 2779 (class 2606 OID 17083)
-- Name: tourney_table_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_table
    ADD CONSTRAINT tourney_table_primary_key PRIMARY KEY (id_table);

ALTER TABLE public.tourney_table CLUSTER ON tourney_table_primary_key;


--
-- TOC entry 2783 (class 2606 OID 17099)
-- Name: tourney_table_type_primary_key; Type: CONSTRAINT; Schema: public; Owner: %USERNAME%; Tablespace: 
--

ALTER TABLE ONLY public.tourney_table_type
    ADD CONSTRAINT tourney_table_type_primary_key PRIMARY KEY (id_table_type);

ALTER TABLE public.tourney_table_type CLUSTER ON tourney_table_type_primary_key;


--
-- TOC entry 2827 (class 1259 OID 17387)
-- Name: cash_cache_id_player_idx; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX cash_cache_id_player_idx ON public.cash_cache USING btree (id_player);

ALTER TABLE public.cash_cache CLUSTER ON cash_cache_id_player_idx;


--
-- TOC entry 2830 (class 1259 OID 17401)
-- Name: cash_custom_cache_id_player_idx; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX cash_custom_cache_id_player_idx ON public.cash_custom_cache USING btree (id_player);

ALTER TABLE public.cash_custom_cache CLUSTER ON cash_custom_cache_id_player_idx;


--
-- TOC entry 2726 (class 1259 OID 16621)
-- Name: chps:idx1-id_hand; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "chps:idx1-id_hand" ON public.cash_hand_player_statistics USING btree (id_hand, id_player);


--
-- TOC entry 2727 (class 1259 OID 16622)
-- Name: chps:idx2-id_player; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "chps:idx2-id_player" ON public.cash_hand_player_statistics USING btree (id_player, id_limit);

ALTER TABLE public.cash_hand_player_statistics CLUSTER ON "chps:idx2-id_player";


--
-- TOC entry 2728 (class 1259 OID 16623)
-- Name: chps:idx3-id_gametype; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "chps:idx3-id_gametype" ON public.cash_hand_player_statistics USING btree (id_gametype, id_limit);


--
-- TOC entry 2729 (class 1259 OID 16624)
-- Name: chps:idx4-id_limit; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "chps:idx4-id_limit" ON public.cash_hand_player_statistics USING btree (id_limit);


--
-- TOC entry 2730 (class 1259 OID 16625)
-- Name: chps:idx5-id_session; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "chps:idx5-id_session" ON public.cash_hand_player_statistics USING btree (id_session);


--
-- TOC entry 2731 (class 1259 OID 16626)
-- Name: chps:idx6-position; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "chps:idx6-position" ON public.cash_hand_player_statistics USING btree ("position");


--
-- TOC entry 2732 (class 1259 OID 16627)
-- Name: chps:idx7-date_played; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "chps:idx7-date_played" ON public.cash_hand_player_statistics USING btree (date_played);


--
-- TOC entry 2719 (class 1259 OID 16420)
-- Name: chs:idx3-id_winner; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "chs:idx3-id_winner" ON public.cash_hand_summary USING btree (id_winner);


--
-- TOC entry 2810 (class 1259 OID 17222)
-- Name: idx1:player_name_search; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "idx1:player_name_search" ON public.player USING btree (player_name_search);


--
-- TOC entry 2817 (class 1259 OID 17303)
-- Name: lcp:idx1-live_table; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "lcp:idx1-live_table" ON public.live_cash_player USING btree (id_live_table);


--
-- TOC entry 2818 (class 1259 OID 17304)
-- Name: lcp:idx2-player_real; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "lcp:idx2-player_real" ON public.live_cash_player USING btree (id_player_real);


--
-- TOC entry 2825 (class 1259 OID 17377)
-- Name: ltp:idx1-live_table; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "ltp:idx1-live_table" ON public.live_tourney_player USING btree (id_live_table);


--
-- TOC entry 2826 (class 1259 OID 17378)
-- Name: ltp:idx2-player_real; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "ltp:idx2-player_real" ON public.live_tourney_player USING btree (id_player_real);


--
-- TOC entry 2803 (class 1259 OID 17197)
-- Name: notes:idx1-id_x; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "notes:idx1-id_x" ON public.notes USING btree (id_x);


--
-- TOC entry 2804 (class 1259 OID 17198)
-- Name: notes:idx2-ts_vector; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "notes:idx2-ts_vector" ON public.notes USING gin (note_tsvector);


--
-- TOC entry 2807 (class 1259 OID 17210)
-- Name: notes_auto:idx1-id_player; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "notes_auto:idx1-id_player" ON public.notes_auto USING btree (id_player);


--
-- TOC entry 2735 (class 1259 OID 16702)
-- Name: ohpc:idx1-id_hand; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "ohpc:idx1-id_hand" ON public.cash_hand_player_combinations USING btree (id_hand);


--
-- TOC entry 2736 (class 1259 OID 16703)
-- Name: ohpc:idx2-id_player; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "ohpc:idx2-id_player" ON public.cash_hand_player_combinations USING btree (id_player);


--
-- TOC entry 2722 (class 1259 OID 16418)
-- Name: ohs:idx1-date_played; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "ohs:idx1-date_played" ON public.cash_hand_summary USING btree (date_played);


--
-- TOC entry 2723 (class 1259 OID 16419)
-- Name: ohs:idx2-id_limit; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "ohs:idx2-id_limit" ON public.cash_hand_summary USING btree (id_limit);


--
-- TOC entry 2745 (class 1259 OID 16735)
-- Name: otss:idx1-id_player; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "otss:idx1-id_player" ON public.cash_table_session_summary USING btree (id_player);


--
-- TOC entry 2746 (class 1259 OID 16736)
-- Name: otss:idx2-id_table; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "otss:idx2-id_table" ON public.cash_table_session_summary USING btree (id_table);


--
-- TOC entry 2747 (class 1259 OID 16737)
-- Name: otss:idx3-date_start; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "otss:idx3-date_start" ON public.cash_table_session_summary USING btree (date_start);


--
-- TOC entry 2802 (class 1259 OID 17187)
-- Name: tags:idx1-id_type; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tags:idx1-id_type" ON public.tags USING btree (id_x, enum_type);


--
-- TOC entry 2759 (class 1259 OID 17033)
-- Name: thps:idx1-id_hand; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "thps:idx1-id_hand" ON public.tourney_hand_player_statistics USING btree (id_hand, id_player);


--
-- TOC entry 2760 (class 1259 OID 17034)
-- Name: thps:idx2-id_player; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "thps:idx2-id_player" ON public.tourney_hand_player_statistics USING btree (id_player);

ALTER TABLE public.tourney_hand_player_statistics CLUSTER ON "thps:idx2-id_player";


--
-- TOC entry 2761 (class 1259 OID 17035)
-- Name: thps:idx3-id_gametype; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "thps:idx3-id_gametype" ON public.tourney_hand_player_statistics USING btree (id_gametype);


--
-- TOC entry 2762 (class 1259 OID 17036)
-- Name: thps:idx4-id_tourney; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "thps:idx4-id_tourney" ON public.tourney_hand_player_statistics USING btree (id_tourney);


--
-- TOC entry 2763 (class 1259 OID 17037)
-- Name: thps:idx5-position; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "thps:idx5-position" ON public.tourney_hand_player_statistics USING btree ("position");


--
-- TOC entry 2764 (class 1259 OID 17038)
-- Name: thps:idx6-date_played; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "thps:idx6-date_played" ON public.tourney_hand_player_statistics USING btree (date_played);


--
-- TOC entry 2765 (class 1259 OID 17039)
-- Name: thps:idx7-date_played_utc; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "thps:idx7-date_played_utc" ON public.tourney_hand_player_statistics USING btree (timezone('UTC'::text, date_played));


--
-- TOC entry 2755 (class 1259 OID 16835)
-- Name: tohpc:idx1-id_hand; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tohpc:idx1-id_hand" ON public.tourney_hand_player_combinations USING btree (id_hand);


--
-- TOC entry 2756 (class 1259 OID 16836)
-- Name: tohpc:idx1-id_player; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tohpc:idx1-id_player" ON public.tourney_hand_player_combinations USING btree (id_player);


--
-- TOC entry 2750 (class 1259 OID 16758)
-- Name: tohs:idx1-date_played; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tohs:idx1-date_played" ON public.tourney_hand_summary USING btree (date_played);


--
-- TOC entry 2751 (class 1259 OID 16759)
-- Name: tohs:idx2-id_blinds; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tohs:idx2-id_blinds" ON public.tourney_hand_summary USING btree (id_blinds);


--
-- TOC entry 2752 (class 1259 OID 16760)
-- Name: tohs:idx3-hand_no; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tohs:idx3-hand_no" ON public.tourney_hand_summary USING btree (hand_no);


--
-- TOC entry 2774 (class 1259 OID 17074)
-- Name: tor:idx1-id_site; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tor:idx1-id_site" ON public.tourney_results USING btree (id_site);


--
-- TOC entry 2775 (class 1259 OID 17075)
-- Name: tor:idx2-id_player; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tor:idx2-id_player" ON public.tourney_results USING btree (id_player);

ALTER TABLE public.tourney_results CLUSTER ON "tor:idx2-id_player";


--
-- TOC entry 2770 (class 1259 OID 17066)
-- Name: tos:idx1-date_start; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tos:idx1-date_start" ON public.tourney_summary USING btree (date_start);


--
-- TOC entry 2771 (class 1259 OID 17067)
-- Name: tos:idx2-id_site; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX "tos:idx2-id_site" ON public.tourney_summary USING btree (id_site);


--
-- TOC entry 2833 (class 1259 OID 17411)
-- Name: tourney_cache_id_player_idx; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX tourney_cache_id_player_idx ON public.tourney_cache USING btree (id_player);

ALTER TABLE public.tourney_cache CLUSTER ON tourney_cache_id_player_idx;


--
-- TOC entry 2836 (class 1259 OID 17425)
-- Name: tourney_custom_cache_id_player_idx; Type: INDEX; Schema: public; Owner: %USERNAME%; Tablespace: 
--

CREATE INDEX tourney_custom_cache_id_player_idx ON public.tourney_custom_cache USING btree (id_player);

ALTER TABLE public.tourney_custom_cache CLUSTER ON tourney_custom_cache_id_player_idx;


--
-- TOC entry 2953 (class 0 OID 0)
-- Dependencies: 6
-- Name: SCHEMA public; Type: ACL; Schema: -; Owner: %USERNAME%
--

REVOKE ALL ON SCHEMA public FROM PUBLIC;
REVOKE ALL ON SCHEMA public FROM %USERNAME%;
GRANT ALL ON SCHEMA public TO %USERNAME%;
GRANT ALL ON SCHEMA public TO PUBLIC;




--
-- PostgreSQL database schema dump complete
--

